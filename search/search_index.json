{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"\u6b22\u8fce\u6765\u5230\u5b89\u5168\u653b\u9632\u5b9e\u8df5 (CTF) \u77ed\u5b66\u671f","text":"<p>\u672c\u7f51\u7ad9\u6574\u5408\u4e86\u8bfe\u7a0b\u4e2d\u6240\u6709\u5b9e\u9a8c/\u4f5c\u4e1a\uff0c\u5982\u6709\u7591\u95ee\u8bf7\u53ca\u65f6\u8054\u7cfb\u52a9\u6559/team-aaa@zju.edu.cn\u3002</p>"},{"location":"#_1","title":"\u5173\u4e8e\u8bfe\u7a0b\u62a5\u540d","text":"<p>\u6839\u636e\u53bb\u5e74\u8bfe\u7a0b\u7684\u53cd\u9988\uff0c\u6211\u4eec\u8bfe\u7a0b\u7684\u5185\u5bb9\u76f8\u5bf9\u800c\u8a00\u77e5\u8bc6\u70b9\u8f83\u591a\u8f83\u96be\u3002\u4e3a\u4e86\u9009\u8bfe\u5b66\u751f\u7684\u4f53\u9a8c\uff0c\u6b64\u6b21\u9009\u8bfe\u8bbe\u7f6e\u4e00\u4e2a Lab 0\uff0c\u5e76\u5728\u6b64 Lab \u4e2d\u5448\u73b0\u4e86\u5b66\u4e60\u8be5\u8bfe\u7a0b\u5e94\u8be5\u5177\u5907\uff08\u6216\u8005\u8bf4\u5feb\u901f\u4e0a\u624b\uff09\u7684\u57fa\u7840\u77e5\u8bc6\u548c\u6280\u80fd\u3002\u8bf7\u6709\u610f\u5411\u9009\u8bfe\u7684\u540c\u5b66\u5b8c\u6210\u540e\u5c06\u5b9e\u9a8c\u6587\u6863\u63d0\u4ea4\u81f3\u90ae\u7bb1\uff08team-aaa@zju.edu.cn\uff09\u8fdb\u884c\u62a5\u540d\u3002</p> <p>\u5982\u679c\u51fa\u4e8e\u65f6\u95f4\u539f\u56e0\u65e0\u6cd5\u6309\u65f6\u5b8c\u6210\uff0c\u4e5f\u8bf7\u4e0d\u8981\u614c\u5f20\uff0c\u53ef\u4ee5\u5c06\u672a\u5b8c\u6210\u7684\u62a5\u544a\u540c\u6837\u63d0\u4ea4\uff0c\u6211\u4eec\u5e0c\u671b\u770b\u5230\u7684\u662f\u4e3b\u52a8\u5b66\u4e60\u7684\u6001\u5ea6 :D</p> <p>\u5982\u679c\u771f\u7684\u5fd9\u5230\u4e00\u70b9\u4e5f\u6ca1\u6709\u65f6\u95f4\uff0c\u4e5f\u201c\u6b22\u8fce\u201d\u5934\u94c1\u9009\u8bfe\uff08\u4e5f\u8bf7\u4e8e\u90ae\u7bb1\u4e2d\u63d0\u4ea4\u62a5\u540d\uff09\uff0c\u51ed\u501f\u7740\u4ed8\u51fa\uff0c\u4e00\u5b9a\u53ef\u4ee5\u5728\u8bfe\u7a0b\u4e2d\u5f97\u5230\u6ee1\u6ee1\u6536\u83b7\u3002</p> <p>\u6ce8\uff1aLab 0 \u672c\u8eab\u4e5f\u662f\u5c0f\u5b66\u671f\u7684\u9996\u6b21\u4f5c\u4e1a\u3002</p> <p>\u62a5\u540d\u90ae\u4ef6\u8bf7\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <ul> <li>Lab 0 \u7684\u5b9e\u9a8c\u62a5\u544a\uff0c\u5177\u4f53\u8be6\u7ec6\u89c1 Lab 0 \u9875\u9762</li> <li>\u4e2a\u4eba\u4fe1\u606f\uff08\u59d3\u540d\u3001\u5b66\u53f7\u3001\u8054\u7cfb\u65b9\u5f0f\u3001QQ\uff09</li> <li>\uff08\u53ef\u9009\uff09\u4e2a\u4eba\u7b80\u5386\uff08\u6bd4\u5982\u4f60\u5df2\u7ecf\u5b8c\u6210\u4e86\u54ea\u4e9b\u8bfe\uff0c\u4ee5\u53ca\u4efb\u4f55\u4f60\u60f3\u548c\u6211\u4eec\u4f20\u9012\u7684\u4fe1\u606f</li> </ul>"},{"location":"#_2","title":"\u5173\u4e8e\u8bfe\u7a0b\u8865\u9009","text":"<p>\u5728\u5df2\u7ecf\u622a\u6b62\u65f6\u95f4\uff086\u670811\u65e5\uff09\u540e\u4ecd\u60f3\u53c2\u4e0e\u8865\u9009\u8bfe\u7a0b\u7684\u540c\u5b66\uff0c\u8bf7\u4e8e\u8003\u8bd5\u5468\u524d\u7684\uff086\u670819\u65e5\u4e2d\u534812\u70b9\uff09\u901a\u8fc7\u90ae\u4ef6\u63d0\u4ea4\u8bfe\u7a0b\u62a5\u540d\uff1b\u7ec6\u8282\u540c\u4e0a\u6240\u8ff0\u3002\u8865\u9009\u671f\u95f4\u7684\u540d\u989d\u66f4\u52a0\u6709\u9650\uff0c\u6545\u6211\u4eec\u5c06\u540c\u6837\u6839\u636e\u63d0\u4ea4\u7684\u62a5\u544a/\u7b80\u5386\u8fdb\u884c\u7b5b\u9009\uff0c\u8bf7\u8865\u9009\u7684\u540c\u5b66\u8003\u8651\u505a Lab 0 \u65f6\u7684\u4f53\u9a8c\u505a\u8865\u9009\u51b3\u5b9a\u3002</p>"},{"location":"#_3","title":"\u8bfe\u7a0b\u4ea4\u6d41\u7fa4","text":"<p>\u5173\u4e8e\u9009\u8bfe\u3001Lab 0 \u7b49\u4efb\u4f55\u4e0e\u672c\u6b21\u77ed\u5b66\u671f\u8bfe\u7a0b\u6709\u5173\u7684\u95ee\u9898\uff0c\u90fd\u53ef\u4ee5\u52a0 QQ \u7fa4 704639399 \u4ea4\u6d41\u3002</p>"},{"location":"feedback/misc-lab1/","title":"Misc Lab 1 \u6279\u6539\u53cd\u9988","text":"<p>\u8fd9\u91cc\u96c6\u4e2d\u53cd\u9988\u4e00\u4e0b misc lab 1 \u6279\u6539\u8fc7\u7a0b\u4e2d\u9047\u5230\u7684\u4e00\u4e9b\u5171\u6027\u95ee\u9898\u3002</p>"},{"location":"feedback/misc-lab1/#task-1","title":"Task 1","text":""},{"location":"feedback/misc-lab1/#_1","title":"\u4e71\u7801\u590d\u73b0","text":"<p>\u6211\u5728\u8bfe\u4e0a\u548c\u5b9e\u9a8c\u624b\u518c\u91cc\u9762\u90fd\u5f3a\u8c03\u8fc7 CyberChef \u5bf9\u4e8e UTF-8 \u89e3\u7801\u9519\u8bef\u7684\u5904\u7406\u4e0d\u592a\u201c\u5e38\u89c4\u201d\uff0c\u6240\u4ee5\u590d\u73b0\u4e71\u7801\u5efa\u8bae\u4f7f\u7528 vscode \u7684\u7f16\u7801\u529f\u80fd\u3002\u6709\u4e9b\u540c\u5b66\u8fd8\u662f\u53ea\u4f7f\u7528\u4e86 CyberChef \u6765\u5b8c\u6210\u5168\u90e8\u516d\u79cd\u4e71\u7801\u7684\u590d\u73b0\uff0c\u5bfc\u81f4\u5f88\u591a\u90fd\u4e0d\u662f\u9884\u671f\u60c5\u51b5\uff0c\u4e5f\u6ca1\u6709\u770b\u5230\u951f\u65a4\u62f7\u7684\u4e71\u7801\uff08\u95ee\u9898\u91cc\u90fd\u8bf4\u4e86\u201c\u5b9e\u9a8c\u4e4b\u540e\u4f60\u5e94\u8be5\u4e86\u89e3\u4e86\u5b83\u5230\u5e95\u662f\u600e\u4e48\u4ea7\u751f\u7684\u201c\uff0c\u65e2\u7136\u6ca1\u770b\u5230\u90a3\u4e3a\u4ec0\u4e48\u4e0d\u53cd\u601d\u4e00\u4e0b\u662f\u4e0d\u662f\u65b9\u6cd5\u7528\u9519\u4e86\u5462\uff09\u3002</p> <p>\u8fd8\u6709\u4e00\u90e8\u5206\u540c\u5b66\u53ea\u4f7f\u7528\u4e86 python \u6765\u5b8c\u6210\u590d\u73b0\uff0c\u4f46\u53ef\u80fd\u6ca1\u6709\u641e\u6e05\u695a\u89e3\u7801\u9519\u8bef\u7684\u5904\u7406\u65b9\u5f0f\uff0c\u9ed8\u8ba4\u60c5\u51b5\u5bf9\u4e8e\u89e3\u7801\u9519\u8bef python \u4f1a\u629b\u51fa\u5f02\u5e38\uff0c\u6240\u4ee5\u7ecf\u8fc7\u641c\u7d22\u6709\u4e9b\u540c\u5b66\u53ef\u80fd\u4f1a\u6dfb\u52a0 <code>errors=\"ignore\"</code> \u53c2\u6570\uff0c\u4f46\u5b9e\u9645\u4e0a\u8fd9\u4e2a\u4e5f\u4e0d\u592a\u201c\u5e38\u89c4\u201d\uff0c\u76f8\u5f53\u4e8e\u5c06\u9519\u8bef\u90e8\u5206\u76f4\u63a5\u5168\u90fd\u5ffd\u7565\u4e86\u3002\u8fd9\u91cc\u5efa\u8bae\u7528 <code>errors=\"replace\"</code> \u8fd9\u6837\u89e3\u7801\u9519\u8bef\u5c31\u4f1a\u88ab\u66ff\u6362\u4e3a \ufffd\uff0c\u5177\u4f53\u53ef\u4ee5\u770b\u4ee5\u4e0b\u4ee3\u7801\uff08\u4ee5\u53ca\u5b98\u65b9\u6587\u6863\u7684\u76f8\u5e94\u4f4d\u7f6e\uff09\uff1a</p> <pre><code>In [1]: s = \"\u4f7f\u7528 python \u8fdb\u884c\u7f16\u89e3\u7801\u4e71\u7801\u5b9e\u9a8c\"\nIn [2]: s.encode(\"GBK\").decode(\"UTF-8\") # errors=\"strict\"\n---------------------------------------------------------------------------\nUnicodeDecodeError                        Traceback (most recent call last)\n&lt;ipython-input-2-0ab5cf145483&gt; in &lt;module&gt;\n----&gt; 1 s.encode(\"GBK\").decode(\"UTF-8\")\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0xd3 in position 2: invalid continuation byte\nIn [3]: s.encode(\"GBK\").decode(\"UTF-8\", errors=\"replace\")\nOut[3]: '\u02b9\ufffd\ufffd python \ufffd\ufffd\ufffd\u0431\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\u02b5\ufffd\ufffd'\nIn [4]: s.encode(\"GBK\").decode(\"UTF-8\", errors=\"ignore\")\nOut[4]: '\u02b9 python \u0431\u02b5'\n</code></pre> <p>\u63a5\u4e0b\u6765\u662f\u5173\u4e8e latin-1 \u7f16\u7801\u7684\u95ee\u9898\uff0c\u597d\u591a\u540c\u5b66\u5728 vscode \u91cc\u8fdb\u884c\u5b9e\u9a8c\uff0c\u641c\u7d22\u7f16\u7801\u65f6\u641c latin \u5f97\u5230\u4e86 \"Latin/Thai ISO 8859-11\" \u8fd9\u4e2a\u7f16\u7801\uff0c\u5c31\u7528\u4e86\u5b83\uff0c\u5f97\u5230\u4e86\u7c7b\u4f3c\u4ee5\u4e0b\u7684\u7ed3\u679c\uff1a</p> <p></p> <p>\u8fd9\u4e2a\u8fd9\u4e48\u591a\u6cf0\u6587\u5e94\u8be5\u660e\u663e\u4e0d\u662f latin-1 \u7f16\u7801\u5427\uff0c\u4e3a\u4ec0\u4e48\u90a3\u4e48\u591a\u540c\u5b66\u90fd\u6ca1\u6709\u89c9\u5f97\u6709\u95ee\u9898\uff1f\u6211\u4e0a\u8bfe\u4e5f\u8bb2\u8fc7\u4e86 latin-1 \u662f\u6839\u636e\u6807\u51c6 ISO 8859-1 \u6765\u7684\uff0c\u6240\u4ee5\u6709\u7684\u65f6\u5019\u5b83\u4e5f\u53eb ISO 8859-1 \u7f16\u7801\u3002\u5728 vscode \u91cc\u641c\u4e0d\u5230 latin-1 \u90a3\u5c31\u641c ISO 8859-1 \u8bd5\u8bd5\u5457\u3002\u8fd9\u4e2a \"Latin/Thai ISO 8859-11\" \u662f\u6807\u51c6\u7684 -11 \u53f7\u554a\uff0c\u540d\u5b57\u91cc\u4e5f\u4f53\u73b0\u4e86\uff0c\u8fd9\u662f ASCII \u9488\u5bf9\u6cf0\u6587\u7684\u6269\u5c55\uff0c\u4e0d\u662f latin-1\u3002</p>"},{"location":"feedback/misc-lab1/#bonus","title":"Bonus","text":"<p>\u5173\u4e8e\u56de\u7b54 CyberChef \u5982\u4f55\u5904\u7406 UTF-8 \u89e3\u7801\u9519\u8bef\u7684\u95ee\u9898\u3002\u5927\u90e8\u5206\u540c\u5b66\u90fd\u901a\u8fc7\u4e00\u4e9b\u4f8b\u5b50\u6d4b\u8bd5/\u5206\u6790\u51fa\u6765\u4e86\u5b83\u662f\u4f1a\u6839\u636e\u9996\u5b57\u8282\u7684\u5f00\u5934\u6765\u7ea0\u6b63\u540e\u7eed\u5b57\u8282\u7684\u5f00\u5934\u3002\u8fd9\u79cd\u5206\u6790\u662f\u6ca1\u6709\u4ec0\u4e48\u5927\u95ee\u9898\u7684\uff0c\u4f46\u662f\u5426\u7f3a\u5c11\u4e86\u90a3\u4e48\u4e00\u70b9\u201c\u4f9d\u636e\u201d\uff1f\u8fd9\u4e9b\u6211\u90fd\u53ea\u7ed9\u4e86 8 \u5206\u7684 bonus\uff0c\u53ea\u6709\u4e00\u4f4d\u540c\u5b66\u53bb\u7ffb\u770b\u4e86 CyberChef \u4ee5\u53ca\u8c03\u7528\u7684\u5176\u4ed6\u5e93\u7684\u6e90\u7801\uff0c\u627e\u5230\u4e86\u8fd9\u79cd\u89e3\u7801\u65b9\u5f0f\u7684\u4ee3\u7801\uff0c\u6211\u7ed9\u4e86 10 \u5206\u3002\u8fd9\u79cd\u901a\u8fc7\u4ee3\u7801\u6765\u5206\u6790\u7684\u65b9\u5f0f\u624d\u662f\u6700\u628a\u63e1\u7684\u3002</p> <p>CyberChef \u6e90\u7801\u662f\u5f00\u6e90\u7684\uff0c\u5728 gchq/CyberChef\u3002\u901a\u8fc7\u7ffb\u770b\u4ee3\u7801/\u641c\u7d22\uff0c\u53ef\u4ee5\u77e5\u9053\u5b57\u7b26\u7f16\u7801\u76f8\u5173\u7684 table \u7b49\u5b58\u5728 src/core/lib/ChrEnc.mjs \u4e2d\uff0c\u7ee7\u7eed\u641c\u7d22 ChrEnc \u53ef\u4ee5\u77e5\u9053 EncodeText/DecodeText \u4ee5\u53ca statusBar/Input/Output \u90e8\u5206\u4ee3\u7801\u90fd\u5f15\u7528\u4e86\u8fd9\u91cc\u3002\u518d\u770b\u4e00\u4e0b src/core/operations/DecodeText.mjs \u4e2d\u4ee3\u7801\uff0c\u4e3b\u9898\u64cd\u4f5c\u90fd\u5728 run \u65b9\u6cd5\u4e2d\uff0c\u5176\u8fd4\u56de\u7684\u7ed3\u679c\u8c03\u7528\u7684\u662f <code>cptable.utils.decode(format, new Uint8Array(input))</code>\u3002\u901a\u8fc7\u9a8c\u8bc1\u6211\u4eec\u4e5f\u53ef\u4ee5\u786e\u5b9a\u89e3\u7801\u7528\u7684\u5c31\u662f\u8fd9\u4e2a cptable\uff1a</p> <p></p> <pre><code>\u276f node\nWelcome to Node.js v18.9.0.\nType \".help\" for more information.\n&gt; byteArray = new Uint8Array([0xba, 0xd7, 0xcf, 0xe8, 0xcd, 0xf2, 0xc0, 0xef])\nUint8Array(8) [\n186, 215, 207,\n232, 205, 242,\n192, 239\n]\n&gt; var cptable = require('codepage');\nundefined\n&gt; cptable.utils.decode(65001, byteArray)\n'\u0697\u03e8\u0372/'\n</code></pre> <p>\u800c\u8fd9\u4e2a\u5305 codepage \u4e5f\u662f\u5f00\u6e90\u7684\uff0c\u6e90\u7801\u5728 SheetJS/js-codepage\u3002\u518d\u901a\u8fc7\u8bfb\u6e90\u7801/\u641c\u7d22 UTF-8 \u6216 65001 \u4ee5\u53ca decode\uff0c\u53ef\u4ee5\u627e\u5230\u89e3\u7801\u76f8\u5173\u4ee3\u7801\u5728 cputils.js \u6587\u4ef6\u4e2d\uff0c\u7b2c 425 \u884c\u5f00\u59cb\u5c31\u662f\u9488\u5bf9 UTF-8 \u7684\u89e3\u7801\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>case \"utf8\":\nif(len &gt;= 3 &amp;&amp; data[0] == 0xEF) if(data[1] == 0xBB &amp;&amp; data[2] == 0xBF) i = 3;\nfor(; i &lt; len; i+=j) {\nj = 1;\nif(data[i] &lt; 128) w = data[i];\nelse if(data[i] &lt; 224) { w=(data[i]&amp;31)*64+(data[i+1]&amp;63); j=2; }\nelse if(data[i] &lt; 240) { w=((data[i]&amp;15)&lt;&lt;12)+(data[i+1]&amp;63)*64+(data[i+2]&amp;63); j=3; }\nelse { w=(data[i]&amp;7)*262144+((data[i+1]&amp;63)&lt;&lt;12)+(data[i+2]&amp;63)*64+(data[i+3]&amp;63); j=4; }\nif(w &lt; 65536) { out[k++] = String.fromCharCode(w); }\nelse {\nw -= 65536; ww = 0xD800 + ((w&gt;&gt;10)&amp;1023); w = 0xDC00 + (w&amp;1023);\nout[k++] = String.fromCharCode(ww); out[k++] = String.fromCharCode(w);\n}\n}\nbreak;\n</code></pre> <p>\u8fd9\u6837\u5c31\u975e\u5e38\u6e05\u6670\u4e86\uff0c\u5f00\u5934\u7684 if \u662f\u5224\u65ad\u5e76\u5ffd\u7565 BOM \u7684\uff0c\u63a5\u4e0b\u6765\u7684 for \u5faa\u73af\u5c31\u662f\u89e3\u7801\u7684\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u770b\u5230\u5b83\u5224\u65ad\u9996\u5b57\u8282\u7684\u5927\u5c0f\uff0c\u7136\u540e\u8bfb\u53d6\u540e\u7eed\u5b57\u8282\u7684\u65f6\u5019\u4f1a\u5b8c\u5168\u5ffd\u7565\u6389\u5f00\u5934\u7684\u90e8\u5206\u3002\u8fd9\u6837\u5f97\u5230\u7684\u7b54\u6848\u662f\u6700\u5b8c\u6574\u6700\u53ef\u9760\u7684\u3002</p>"},{"location":"feedback/misc-lab1/#challenge-1","title":"Challenge 1","text":"<p>\u8fd9\u9053\u9898\u76ee\u80fd\u505a\u51fa\u6765\u7684\u57fa\u672c\u4e0a\u95ee\u9898\u90fd\u4e0d\u5927\uff0c\u53ea\u662f\u6709\u4e9b\u540c\u5b66\u4ecd\u7136\u7528\u4e86\u5f88\u591a\u4eba\u529b\uff0c\u8fd8\u6709\u4f18\u5316\u7a7a\u95f4\u3002\u5177\u4f53\u505a\u6cd5\u8fd9\u91cc\u5c31\u4e0d\u653e\u51fa\u6765\u4e86\u3002</p> <p>\u4ee5\u53ca\u770b\u5230\u5f88\u591a\u540c\u5b66\u5728 python \u4e2d\u6c42\u4e58\u6cd5\u9006\u5143\u8fd8\u5728\u81ea\u5df1\u5199\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\uff0c\u8fd9\u633a\u6ca1\u5fc5\u8981\u7684\u3002\u6709\u5f88\u591a\u5305\u63d0\u4f9b\u4e86\u6c42\u4e58\u6cd5\u9006\u5143\u7684\u8f6e\u5b50\uff0c\u66f4\u719f\u6089 python \u4e00\u70b9\u7684\u540c\u5b66\u53ef\u80fd\u4e5f\u4f1a\u4e86\u89e3 python \u5185\u7f6e\u7684 pow \u51fd\u6570\u5c31\u53ef\u4ee5\u7528\u6765\u6c42\u4e58\u6cd5\u9006\u5143\uff0c<code>pow(a, -1, n)</code> \u7684\u7ed3\u679c\u5c31\u662f a \u5728\u6a21 n \u610f\u4e49\u4e0b\u7684\u4e58\u6cd5\u9006\u5143\u3002</p>"},{"location":"feedback/misc-lab1/#challenge-2","title":"Challenge 2","text":""},{"location":"feedback/misc-lab1/#task-1_1","title":"Task 1","text":"<p>\u8fd9\u9898\u51fa\u51fa\u6765\u7684\u76ee\u7684\u5c31\u662f\u4e3a\u4e86\u544a\u8bc9\u5927\u5bb6\u5728\u5b66\u4e86\u5f88\u591a\u6280\u5de7\u4e4b\u540e\u4e5f\u4e0d\u8981\u5fd8\u8bb0\u6700\u57fa\u672c\u7684\u4e1c\u897f\u3002\u5b66\u4e60\u4e86\u5982\u4f55\u901a\u8fc7\u7167\u7247\u5185\u5bb9\u627e\u4f4d\u7f6e\u3001\u4f30\u8ba1\u9ad8\u5ea6\u3001\u4f30\u8ba1\u65f6\u95f4\uff0c\u4e5f\u4e0d\u8981\u5fd8\u8bb0\u5148\u53bb\u7528 exiftool \u53bb\u770b\u4e00\u4e0b\u56fe\u7247\u7684 EXIF \u4fe1\u606f\u3002\u8fd9\u9898\u7684\u6d77\u62d4\u9ad8\u5ea6\u548c\u62cd\u6444\u65f6\u95f4\u90fd\u4fdd\u7559\u5728 EXIF \u91cc\u9762\u4e86\uff0c\u76f4\u63a5\u8bfb\u5c31\u884c\u3002\u4f46\u662f GPS \u7684\u9ad8\u5ea6\u786e\u5b9e\u53ef\u80fd\u4e0d\u90a3\u4e48\u51c6\uff0c\u4f46\u4e5f\u5c31\u5148\u4ee5\u8fd9\u4e2a\u4e3a\u4e3b\u5427\u3002</p>"},{"location":"feedback/misc-lab1/#task-2","title":"Task 2","text":"<p>\u8fd9\u9053\u9898\u76ee\u901a\u8fc7\u80cc\u666f\u4e2d\u7684\u4e00\u4e9b\u5e26\u6709\u7279\u5f81\u7684\u666f\u7269\u8bc6\u56fe\u5c31\u53ef\u4ee5\u5927\u81f4\u627e\u5230\u4f4d\u7f6e\uff0c\u901a\u8fc7\u5730\u56fe\u4e0a\u7684\u4e00\u4e9b\u63a8\u65ad\u5c31\u80fd\u57fa\u672c\u4e0a\u627e\u5230\u7ecf\u7eac\u5ea6\uff0c\u5bb9\u5dee 0.006\uff0c\u89c9\u5f97\u81ea\u5df1\u4f4d\u7f6e\u5927\u81f4\u6b63\u786e\u4f46\u662f\u9a8c\u8bc1\u4e0d\u901a\u8fc7\u7684\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e9b\u7b80\u5355\u7684\u679a\u4e3e\u6765\u627e\u5230\u8303\u56f4\u5185\u7684\u7ecf\u7eac\u5ea6\u3002</p> <p>\u8fd9\u91cc\u7279\u522b\u8bf4\u4e00\u53e5\uff0c\u6709\u4e00\u4f4d\u540c\u5b66\u5728\u505a\u9898\u7684\u8fc7\u7a0b\u4e2d\u5c1d\u8bd5\u4ece\u51fa\u9898\u4eba\u89d2\u5ea6\u5165\u624b\uff0c\u628a yyy \u76d2\u4e86\u4e2a\u904d\uff0c\u6252\u51fa\u4e86\u4e00\u5806\u9690\u79c1\u4fe1\u606f\uff0c\u627e\u5230\u5176\u5bb6\u4e61\uff0c\u5f97\u5230\u4e86\u53a6\u95e8\u7684\u4f4d\u7f6e\uff08\u5728\u8fc7\u7a0b\u4e2d\u751a\u81f3\u7528\u4e86\u793e\u5de5\u5e93\uff0c\u9700\u8981\u4e86\u89e3\u4e00\u4e0b\uff0c\u67e5\u8be2\u793e\u5de5\u5e93\u4e5f\u662f\u8fdd\u6cd5\u884c\u4e3a\uff09\u3002\u6211\u4e0a\u8bfe\u53cd\u590d\u5f3a\u8c03\u4e86\u505a CTF \u9898\u76ee\u4e0d\u8981\u8dc3\u51fa\u9898\u76ee\u53bb\u76d2\u51fa\u9898\u4eba\u672c\u4eba\u4fe1\u606f\uff0c\u4e0d\u8981\u5c06\u8bb2\u5230\u7684\u6280\u672f\u7528\u5728\u73b0\u5b9e\u4e16\u754c\u4e2d\uff0c\u51fa\u73b0\u5f00\u76d2\u67d0\u4e2a\u8d26\u53f7\u7684\u9700\u6c42\u4e5f\u80af\u5b9a\u90fd\u662f\u51fa\u9898\u4eba\u634f\u9020\u51fa\u6765\u7684\u4e00\u4e2a\u865a\u62df\u4eba\u7269\u7684\u8d26\u53f7\uff0c\u4e00\u5207\u4e0d\u4f1a\u548c\u51fa\u9898\u4eba\u672c\u4eba\u4ea7\u751f\u8054\u7cfb\u3002\u6211\u5bf9\u5176\u8fdb\u884c\u4e86\u989d\u5916\u7684\u6263\u5206\uff0c\u5e0c\u671b\u5927\u5bb6\u5f15\u4ee5\u4e3a\u6212\u3002</p>"},{"location":"feedback/misc-lab23/","title":"Misc Lab 2/3 \u6279\u6539\u53cd\u9988","text":"<p>\u8fd9\u91cc\u96c6\u4e2d\u53cd\u9988\u4e00\u4e0b misc lab 2/3 \u6279\u6539\u8fc7\u7a0b\u4e2d\u9047\u5230\u7684\u4e00\u4e9b\u5171\u6027\u95ee\u9898\uff0c\u4ee5\u53ca\u4e00\u4e9b\u6210\u9898\u7684\u6765\u6e90\u548c\u9898\u89e3\u3002</p>"},{"location":"feedback/misc-lab23/#lab-2","title":"Lab 2","text":""},{"location":"feedback/misc-lab23/#challenge-123","title":"Challenge 1/2/3","text":"<p>\u4e09\u9053\u57fa\u7840\u7684\u56fe\u7247\u9690\u5199\uff0c\u5927\u5bb6\u5b8c\u6210\u7684\u4e5f\u90fd\u5f88\u597d\uff0c\u76f8\u4fe1 Background \u90e8\u5206\u7684\u56fe\u7247\u9690\u5199\u7b80\u5355\u4e00\u628a\u68ad\u5c31\u53ef\u4ee5\u8f7b\u677e\u89e3\u51b3\u8fd9\u4e09\u9053\u9898\u3002</p> <p>\u524d\u4e24\u9898\u90fd\u662f\u6821\u5df4\u4e0a\u7684\u9898\uff0c\u6240\u4ee5\u8fd9\u91cc\u5c31\u4e0d\u653e\u51fa\u76f8\u5173\u89e3\u6cd5\u4e4b\u7c7b\u7684\u4e86\u3002</p> <p>\u7b2c\u4e09\u9898\u7684 LSB \u6309\u7167 BGR \u4e09\u4e2a\u901a\u9053\u7684\u987a\u5e8f\u6765\u63d0\u53d6\u6700\u4f4e\u4f4d\u5373\u53ef\uff0c\u5f97\u5230\u7684\u662f\u4e00\u5f20 png \u56fe\u7247\u7684\u4e8c\u8fdb\u5236\u3002\u8fd9\u4e2a\u987a\u5e8f\u4ec0\u4e48\u7684\u53ef\u4ee5\u901a\u8fc7 stegsolve/CyberChef \u5c1d\u8bd5\u6765\u5f97\u5230\uff0c\u6216\u8005 zsteg \u81ea\u52a8\u679a\u4e3e\u4e5f\u53ef\u4ee5\u3002\u540c\u65f6\u6ce8\u610f\u8fd9\u91cc\u7684\u9690\u5199\u5185\u5bb9\u662f\u4e00\u5f20\u56fe\u7247\uff0c\u800c\u4e0d\u662f\u76f4\u63a5\u7684 flag\uff0c\u6240\u4ee5\u5728\u8fd9\u79cd\u8fc7\u7a0b\u4e2d\u8981\u6ce8\u610f\u4efb\u4f55\u53ef\u7591\u7684\u6587\u4ef6\u7c7b\u578b\uff0c\u800c\u4e0d\u8981\u4ec5\u4ec5\u5173\u6ce8 flag \u683c\u5f0f\u6216\u8005\u7eaf\u6587\u672c\u3002</p>"},{"location":"feedback/misc-lab23/#challenge-4-palette-stego","title":"Challenge 4: Palette Stego","text":"<p>\u51fa\u8fd9\u9053\u9898\u7684\u601d\u8def\u662f 2022 TQLCTF \u7684\u4e00\u9053\u9690\u5199\u9898\u76ee Cat&amp;Soup \u91cc\u9762\u4e00\u90e8\u5206\u5229\u7528\u4e86 EZStego \u8fd9\u4e2a\u8c03\u8272\u76d8\u9690\u5199\u7b97\u6cd5\uff0c\u6240\u4ee5\u5c31\u6539\u4e86\u8fd9\u4e48\u4e00\u9053\u9898\u76ee\u3002\u5f53\u65f6\u7684 writeup\uff1a</p> <ul> <li>\u5b98\u65b9 writeup\uff0c\u8fd9\u9053\u9898\u76ee\u5728 pdf \u7b2c 25 \u9875</li> <li>\u4e00\u4e2a\u590d\u73b0 writeup by @c10udlnk</li> </ul> <p>\u76f4\u63a5\u641c\u4e00\u641c EZStego \u7684\u76f8\u5173\u539f\u7406\uff0c\u7136\u540e\u7167\u7740\u539f\u7406\u5199\u4ee3\u7801\u5c31\u53ef\u4ee5\u4e86\uff0c\u5177\u4f53\u4ee3\u7801\u53ef\u4ee5\u53bb\u770b\u7b2c\u4e8c\u4e2a writeup\uff0c\u91cc\u9762\u4e5f\u7ed9\u4e86\u4e24\u7bc7 EZStego \u76f8\u5173\u7684\u6587\u7ae0\u94fe\u63a5\uff1a</p> <ul> <li>\"Waiter! There's a Message in My Soup!\"</li> <li>\u300aEzStego\u7684\u5d4c\u5165\u3001\u63d0\u53d6\u4e0e\u68c0\u6d4b\u7684C++\u5b9e\u73b0\u300b</li> </ul> <p>\u8fd9\u9053\u9898\u6211 flag \u662f\u76f4\u63a5\u4e00\u4e2a\u5b57\u7b26=\u4e00\u4e2a\u5b57\u8282=\u516b\u4e2a\u6bd4\u7279\u6765\u7684\uff0c\u6240\u4ee5\u5b83\u751a\u81f3\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7 zsteg -a \u6765\u89e3\u51fa\u6765\uff0c\u8fd9\u6837\u505a\u7684\u6211\u6ca1\u6709\u4efb\u4f55\u6263\u5206\uff0c\u6bd5\u7adf\u4e5f\u62ff\u5230 flag \u4e86\uff1a</p> <pre><code>\u276f zsteg -a chal.png | grep AAA\nb1,g,lsb,xy         .. text: \"...AAA{gOoD_joB_P4lEtTE_M0D3_c@N_al$0_57E9o!}......AAA{gOoD_joB_P4lEtTE_M0D3_c@N_al$0_57E9o!}......AAA{gOoD_joB_P4lEtTE_M0D3_c@N_al$0_57E9o!}......AAA{gOoD_joB_P4lEtTE_M0D3_c@N_al$0_57E9o!}......AAA{gOoD_joB_P4lEtTE_M0D3_c@N_al$0_57E9o!}......AAA{gOoD_joB_\"\nb1,g,msb,XY         .. text: \"$la_N@c_3D0M_ETtEl4P_Boj_DoOg{AAA......}!o9E75_0$la_N@c_3D0M_ETtEl4P_Boj_DoOg{AAA......}!o9E75_0$la_N@c_3D0M_ETtEl4P_Boj_DoOg{AAA......}!o9E75_0$la_N@c_3D0M_ETtEl4P_Boj_DoOg{AAA......}!o9E75_0$la_N@c_3D0M_ETtEl4P_Boj_DoOg{AAA......}!o9E75_0$la_N@c_3D0M_ETt\"\nb1,g,msb,Xy         .. text: \"A......}!o9E75_0$la_N@c_3D0M_ETtEl4P_Boj_DoOg{AAA......}!o9E75_0$la_N@c_3D0M_ETtEl4P_Boj_DoOg{AAA...g{AAA......}!o9E75_0$la_N@c_3D0M_ETtEl4P_Boj_DoOg{AAA......}!o9E75_0$la_N@c_3D0M_ETtEl4P_Boj_DoOg{AA_DoOg{AAA......}!o9E75_0$la_N@c_3D0M_ETtEl4P_Boj_DoOg{AA\"\nb1,g,lsb,xY         .. text: \"_al$0_57E9o!}......AAA{gOoD_joB_P4lEtTE_M0D3_c@N_al$0_57E9o!}......AAA{gOoD_joB_P4lEtTE_M0D3_c@N_al$_c@N_al$0_57E9o!}......AAA{gOoD_joB_P4lEtTE_M0D3_c@N_al$0_57E9o!}......AAA{gOoD_joB_P4lEtTE_M0D3_c@NM0D3_c@N_al$0_57E9o!}......AAA{gOoD_joB_P4lEtTE_M0D3_c@N\"\n</code></pre> <p>\u6211\u627f\u8ba4\u9601\u4e0b\u7684 zsteg \u786e\u5b9e\u5389\u5bb3\uff0c\u4f46\u5018\u82e5\u6211\u548c Cat&amp;Soup \u4e00\u6837\u4e00\u4e2a\u5b57\u7b26\u53ea\u6709 7 bit\uff0c\u9601\u4e0b\u53c8\u8be5\u5982\u4f55\u5e94\u5bf9\u5462\uff1f\uff08x</p>"},{"location":"feedback/misc-lab23/#challenge-5-spectrogram","title":"Challenge 5: Spectrogram","text":"<p>\u8fd9\u9898\u662f\u4ece Hackergame 2021 \u7684 p\ud83d\ude2dq \u6539\u7f16\u7684\uff08\u5176\u5b9e\u5c31\u662f\u6362\u4e86\u4e2a\u6e90\u97f3\u9891\uff09\uff0c\u505a\u6cd5\u76f4\u63a5\u6839\u636e\u4ee3\u7801\u9006\u8fc7\u6765\u5c31\u53ef\u4ee5\u4e86\u3002\u539f\u9898\u7684 writeup\uff1a</p> <ul> <li>\u5b98\u65b9 writeup</li> <li>\u6211\u5f53\u65f6\u7684 writeup</li> </ul> <p>\u8fd9\u91cc\u6211\u7528\u7684\u6e90\u97f3\u9891\u662f\u8fa8\u8bc6\u5ea6\u6781\u9ad8\u7684 Never Gonna Give You Up \u7684\u5f00\u5934\uff0c\u542c\u8fc7\u7684\u5e94\u8be5\u90fd\u80fd\u4e00\u4e0b\u5b50\u8ba4\u51fa\u6765\uff08</p>"},{"location":"feedback/misc-lab23/#challenge-6-huffman-stego","title":"Challenge 6: Huffman Stego","text":"<p>\u8fd9\u9898\u7684\u539f\u9898\u662f MRCTF 2022 \u7684 jpeg and the tree\u3002\u6211\u7684\u66f4\u6539\u4e5f\u5c31\u662f\u6362\u4e86\u4e2a flag \u800c\u5df2\u3002\u539f\u9898\u7684 writeup\uff1a</p> <ul> <li>\u5b98\u65b9 writeup<ul> <li>writeup \u91cc\u9762\u4e5f\u63d0\u4f9b\u4e86\u5f88\u591a\u94fe\u63a5\uff0c\u4ee5\u53ca\u5b8c\u6574\u7684\u89e3\u6cd5</li> </ul> </li> </ul> <p>\u539f\u9898\u6bd4\u8d5b\u65f6\u7684 hint \u662f\u7075\u611f\u6765\u81ea Google CTF 2021\uff0c\u662f zip \u6587\u4ef6\u4e2d\u7684\u5197\u4f59\u54c8\u592b\u66fc\u7f16\u7801\u7684\u95ee\u9898\uff0c\u8981\u6bd4\u8fd9\u4e2a\u7b80\u5355\u4e00\u70b9\uff0c\u4e5f\u53ef\u4ee5\u770b\u4e00\u4e0b\uff0cwriteup\uff1aGoogle CTF: David and the Tree\u3002</p> <p>\u65f6\u95f4\u539f\u56e0\u6ca1\u6709\u505a\u8fd9\u9898\u7684\u8fd8\u662f\u5efa\u8bae\u6709\u7a7a\u6765\u590d\u73b0\u4e00\u4e0b\uff0c\u4e2a\u4eba\u8ba4\u4e3a\u662f\u5bf9 JPEG \u6587\u4ef6\u683c\u5f0f\u7684\u5f88\u597d\u7684\u590d\u4e60\u3002\u4ee5\u53ca\u6709\u5174\u8da3\u7684\u4e5f\u53ef\u4ee5\u8003\u8651/\u5b9e\u73b0\u4e00\u4e0b\u628a\u89e3\u7b54\u8fc7\u7a0b\u53cd\u8fc7\u6765\uff0c\u5373\u8fd9\u9053\u9898\u662f\u600e\u4e48\u51fa\u7684\u3002</p>"},{"location":"feedback/misc-lab23/#lab-3","title":"Lab 3","text":""},{"location":"feedback/misc-lab23/#challenge-1-sql-inject-analysis","title":"Challenge 1: SQL Inject Analysis","text":"<p>\u8fd9\u9898\u662f BUUCTF \u4e0a\u7684\u4e00\u9053\u6210\u9898 sqltest\u3002\u76f4\u63a5\u5206\u6790\u8bf7\u6c42\u5185\u5bb9\uff0c\u89e3\u6790 SQL \u76f2\u6ce8\u5373\u53ef\u3002\u8fd9\u9898\u7684 writeup \u4e5f\u5f88\u591a\uff0c\u76f4\u63a5\u641c \"BUUCTF sqltest\" \u5c31\u80fd\u641c\u5230\u5f88\u591a writeup\u3002</p>"},{"location":"feedback/misc-lab23/#challenge-2-dnscap","title":"Challenge 2: dnscap","text":"<p>\u8fd9\u9898\u662f BSides San Francisco CTF 2017 \u7684\u539f\u9898 dnscap.pcap\u3002\u540c\u6837\u4e5f\u80fd\u641c\u5230\u5f88\u591a\u73b0\u6709\u7684 writeup\uff0c\u751a\u81f3 CTF Wiki \u4e0a DNS \u534f\u8bae\u90e8\u5206\u7684\u4f8b\u9898\u89e3\u6790\u5c31\u662f\u8fd9\u9053\uff1a</p> <ul> <li>CTF Wiki &gt; Misc &gt; \u6d41\u91cf\u5305\u5206\u6790 &gt; \u534f\u8bae\u5206\u6790 &gt; DNS#\u4f8b\u9898</li> </ul> <p>\u6709\u4e9b\u540c\u5b66\u8fd8\u6b62\u6b65\u4e8e\u5bf9\u7740 DNS \u8bf7\u6c42\u7684\u5185\u5bb9\u4ece\u5341\u516d\u8fdb\u5236\u8f6c\u4e3a ASCII \u5b57\u7b26\uff0c\u7136\u540e\u5220\u51cf\u91cd\u590d\u7684\u90e8\u5206\u8bd5\u56fe\u62ff\u5230 png\u3002\u6211\u90fd\u5199\u4e86\u8981\u53bb\u770b\u4e00\u4e0b dnscat \u534f\u8bae\u7684\uff0c\u6839\u636e\u90a3\u4e2a\u820d\u5f03\u591a\u4f59\u6570\u636e\u518d\u63d0\u53d6\u5c31\u80fd\u76f4\u63a5\u62ff\u5230\u5b8c\u6574 png \u4e86\u3002\u800c\u4e14\u6709\u540c\u5b66\u751a\u81f3\u5199\u4e86 pcap \u5305\u89e3\u6790\u7684\u5b8c\u6574\u4ee3\u7801\u6765\u63d0\u53d6\u5185\u5bb9\uff0c\u611f\u89c9\u6709\u4e9b\u592a\u6ca1\u5fc5\u8981\u4e86\uff0cwireshark \u7684 tshark \u5df2\u7ecf\u5f88\u65b9\u4fbf\u4e86\uff0c\u800c\u4e14\u6211\u4e0a\u8bfe\u4e5f\u6f14\u793a\u8fc7\u7528\u6cd5\uff0c\u4e3a\u4ec0\u4e48\u4e0d\u7528\u5462\u3002</p>"},{"location":"feedback/misc-lab23/#challenge-3-crack_zju_wlan","title":"Challenge 3: crack_zju_wlan","text":"<p>\u6821\u5df4\u4e0a\u7684\u9898\u76ee\uff0c\u505a\u6cd5\u4e0d\u591a\u89e3\u91ca\u3002</p> <p>\u4e3b\u8981\u95ee\u9898\u662f\u89e3\u538b\u5f97\u5230\u4e86 .img \u6587\u4ef6\u4e4b\u540e\u6709\u4e9b\u540c\u5b66\u4e0d\u77e5\u9053\u600e\u4e48\u5904\u7406\u3002\u76f4\u63a5\u624b\u52a8\u4ece\u91cc\u9762\u6458 pcap \u6587\u4ef6\u80af\u5b9a\u662f\u4e0d\u592a\u597d\u7684\uff0cbinwalk/foremost \u4ec0\u4e48\u7684\u5176\u5b9e\u4e5f\u53ef\u4ee5\u3002\u8fd9\u4e2a img \u7684\u610f\u601d\u662f\u955c\u50cf\u6587\u4ef6\uff08\u751a\u81f3\u6709\u540c\u5b66\u8fd8\u4ee5\u4e3a\u662f\u56fe\u7247\u53ef\u8fd8\u884c\uff09\uff0c\u6240\u4ee5\u6b63\u7ecf\u505a\u6cd5\u662f\u76f4\u63a5\u6302\u8f7d\u5b83\u6216\u8005\u7528 7z \u4e4b\u7c7b\u7684\u8f6f\u4ef6\u6765\u89e3\u538b\u3002\u89e3\u538b\u4e4b\u540e\u89c2\u5bdf\u89e3\u538b\u540e\u7684\u5168\u90e8\u5185\u5bb9\uff0c\u5957\u7528\u5de5\u5177\u6c42\u89e3\u5373\u53ef\u3002</p>"},{"location":"feedback/misc-lab23/#challenge-4-volatility","title":"Challenge 4: volatility \u5b89\u88c5\u4e0e\u4f7f\u7528","text":"<p>\u5176\u5b9e volatility \u5b89\u88c5\u8bf4\u7b80\u5355\u4e5f\u4e0d\u7b97\u7b80\u5355\uff0c\u8bf4\u590d\u6742\u4e5f\u4e0d\u662f\u90a3\u4e48\u590d\u6742\u3002\u8981\u505a\u7684\u5176\u5b9e\u5c31\u662f\u5148\u641e\u51fa\u4e00\u4e2a\u5e72\u5e72\u51c0\u51c0\u7684 python 2.x \u7684\u73af\u5883\uff08\u6240\u4ee5\u63a8\u8350\u4f7f\u7528 conda\uff09\uff0c\u7136\u540e\u6267\u884c setup.py \u5b89\u88c5\uff0c\u518d\u8865\u5145\u4e00\u4e0b\u90e8\u5206\u63d2\u4ef6\u9700\u8981\u7684 pycrypto \u548c distrom3 \u4e24\u4e2a\u5305\u5c31\u53ef\u4ee5\u4e86\u3002</p> <p>\u590d\u73b0\u4e5f\u4e0d\u5fc5\u591a\u8bf4\uff0c\u6211\u4e0a\u8bfe\u90fd\u6f14\u793a\u8fc7\u4e86\u3002</p> <p>\u5269\u4e0b\u7684 Challenge 5 \u5c31\u7559\u7ed9\u5927\u5bb6\u6709\u5174\u8da3\u7684\u8bdd\u81ea\u884c\u7814\u7a76\u5427\u3002</p>"},{"location":"intro/crypto-lab1/","title":"Crypto Lab 1\uff1a\u9006\u5143\u3001RSA\u548c\u79bb\u6563\u5bf9\u6570","text":""},{"location":"intro/crypto-lab1/#task-1","title":"Task 1","text":"<p>\u57fa\u7840\u4f5c\u4e1a\uff1a\u5b8c\u6210\u5bf9gcd\u4ee5\u53cainverse\u7684\u6c42\u89e3\u7b97\u6cd5\uff0c\u7f16\u7a0b\u8bed\u8a00\u4e0d\u9650\uff0c\u4f46\u53ea\u80fd\u4f7f\u7528\u6807\u51c6\u5e93\u3002</p>"},{"location":"intro/crypto-lab1/#task-2","title":"Task 2","text":"<p>\u4e09\u9009\u4e00\uff1a\u4e09\u9009\u4e00\u5373\u53ef\uff0c\u591a\u505a\u662fbonus\u3002</p> <ul> <li>\u8d28\u56e0\u6570\u4e0d\u591f\u5927\u800c\u5bb9\u6613\u88ab\u5206\u89e3\uff0c\u5219\u5728 \\(Z_{pq}\\) \u4e0a\u6c42\u9006\u5f88\u7b80\u5355\uff1aCCPC 2019 Final - K. Mr. Panda and Kakin\uff1b</li> <li>\u7fa4\u7684\u9636\u4e0d\u542b\u5927\u8d28\u56e0\u5b50\u65f6\uff0c\u79bb\u6563\u5bf9\u6570\u6613\u88ab\u6c42\u5f97\uff1a2019 HDU Multi-University Training Contest 5 - 9. discrete logarithm problem\uff1b</li> <li>\u4e5f\u662f\u7c7b\u4f3c\u7684\u5149\u6ed1\u79bb\u6563\u5bf9\u6570\uff1aBabyDLP - ZJUCTF2022</li> </ul> <p>\u5b66\u5728\u6d59\u5927\u63d0\u4ea4\u683c\u5f0f\uff1a</p> <ol> <li>PDF\u683c\u5f0f\u7684\u5b9e\u9a8c\u62a5\u544a\uff0c\u547d\u540d\u4e3a \u5b66\u53f7-\u59d3\u540d-crypto\u57fa\u7840.pdf</li> <li>\u5176\u4ed6\u76f8\u5173\u4ee3\u7801\u7b49\u6253\u5305\u7684\u9644\u4ef6\uff0c\u547d\u540d\u4e3a \u5b66\u53f7-\u59d3\u540d-crypto\u57fa\u7840-attachment.zip</li> </ol>"},{"location":"intro/lab0/","title":"Lab 0\uff1a\u57fa\u7840\u77e5\u8bc6\u53ca\u6280\u80fd","text":"<p>\u672c\u8bfe\u7a0b\u7684 Lab 0 \u7531\u4e24\u90e8\u5206\u7ec4\u6210:</p> <ul> <li>Prerequisite \u90e8\u5206\u4ee5\u53ca</li> <li>Misc, Reverse, Pwn, Web, Crypto \u90e8\u5206\u4e94\u9009\u4e00</li> </ul> <p>\u9f13\u52b1\u591a\u9009\uff0c\u63a2\u7d22\u81ea\u5df1\u611f\u5174\u8da3\u7684\u65b9\u5411\uff01</p> <p>\u5b8c\u6210\u7684\u62a5\u544a\u8bf7\u547d\u540d\u4e3a <code>lab0_\u59d3\u540d_\u5b66\u53f7.pdf</code> \u4e0e6\u670811\u65e5\u4e2d\u534812\u70b9\u524d\uff0c\u4ee5\u90ae\u4ef6\u9644\u4ef6\u7684\u5f62\u5f0f\u63d0\u4ea4\u5230 team-aaa@zju.edu.cn\uff1b\u5e76\u4e8e\u90ae\u4ef6\u4e2d\u63d0\u4f9b\u4e2a\u4eba\u7684\u8054\u7cfb\u65b9\u5f0f\uff5e</p> <p>lab\u8fc7\u7a0b\u4e2d\u9047\u5230\u7684\u95ee\u9898\u6216\u8005\u4efb\u4f55\u4e0e\u8bfe\u7a0b\u76f8\u5173\u7684\u95ee\u9898\u6b22\u8fce\u52a0\u5165\u8bfe\u7a0b\u4ea4\u6d41\u7fa4\u8fdb\u884c\u8ba8\u8bba\uff0cQQ \u7fa4\u53f7 704639399\u3002</p>"},{"location":"intro/lab0/#prerequisite","title":"Prerequisite","text":""},{"location":"intro/lab0/#challange-1","title":"Challange 1","text":"<p>Linux \u73af\u5883\u7684\u642d\u5efa\u4e0e\u7b80\u5355\u4f7f\u7528</p> <p>\u53c2\u8003\u96be\u5ea6\uff1a\u2605</p> <p>\u540e\u7eed\u8bfe\u7a0b\u7684\u8bb8\u591a\u5185\u5bb9\u90fd\u5c06\u5728 Linux \u64cd\u4f5c\u7cfb\u7edf\u7684\u5e73\u53f0\u4e0a\u5b8c\u6210\uff0c\u4e3a\u4e86\u65b9\u4fbf\uff0c\u672c\u6b21\u8bfe\u7a0b\u63d0\u4f9b\u4e86 ubuntu \u865a\u62df\u673a\u4f9b\u4e0b\u8f7d</p> <p>\u4e0b\u8f7d\u94fe\u63a5\uff08\u5176\u4e2d\u7528\u6237\u540d\u4e3a ctfer\uff0c\u5bc6\u7801\u4e3a aaa\uff09</p> <p>\u865a\u62df\u673a\u4e2d\u9884\u88c5\u4e86\u8bfe\u7a0b\u4e2d\u5c06\u8981\u7528\u5230\u7684\u5404\u7c7b\u5de5\u5177\u53ca\u73af\u5883\u3002</p> <p>\u5f53\u7136\uff0c\u5982\u679c\u4f60\u5df2\u7ecf\u62e5\u6709\u4e86\u719f\u6089\u7684 Linux \u73af\u5883\uff0c\u8bf7\u653e\u5fc3\u5927\u80c6\u4f7f\u7528\u3002</p> <p>\u5177\u5907 Linux \u540e\uff0c\u8bf7\u89c2\u770b Shell \u57fa\u7840\u53ca CLI \u5de5\u5177\u63a8\u8350 - 2023 \u6625\u590f\u8ba1\u7b97\u673a\u5b66\u9662\u670b\u8f88\u8f85\u5b66 \u8bfe\u7a0b\u89c6\u9891\uff0c\u5e76\u5728\u5b9e\u9a8c\u62a5\u544a\u4e2d\u7ed9\u51fa\u4efb\u610f4\u4e2a shell \u547d\u4ee4\u7684\u7528\u6cd5\u4ecb\u7ecd\u4ee5\u53ca\u5728 Linux \u73af\u5883\u4e0b\u7684\u5b9e\u64cd\u622a\u56fe\u3002</p> <p>hint: </p> <ul> <li>Linux \u73af\u5883\u7684\u51c6\u5907\u53ef\u4ee5\u53c2\u8003\u53bb\u5e74\u7684\u8bfe\u7a0b\u5185\u5bb9</li> </ul>"},{"location":"intro/lab0/#challenge-2","title":"Challenge 2","text":"<p>\u57fa\u7840\u7684 python \u7f16\u7a0b</p> <p>\u53c2\u8003\u96be\u5ea6\uff1a\u2605</p> <p>\u540e\u7eed\u7684\u8bfe\u7a0b\u4e2d\u4e0d\u4e4f\u901a\u8fc7\u7f16\u7a0b\u6765\uff1a</p> <ol> <li>\u8282\u7701\u4eba\u529b\u6210\u672c</li> <li>\u89e3\u51b3\u7279\u5b9a\u95ee\u9898</li> </ol> <p>\u638c\u63e1\u811a\u672c\u8bed\u8a00 python \u4f1a\u8ba9\u8fd9\u4e9b\u4e8b\u534a\u529f\u500d\u3002\u8bf7\u5b8c\u6210\u5982\u4e0b\u4efb\u52a1\uff0c\u5e76\u5728\u5b9e\u9a8c\u62a5\u544a\u4e2d\u7ed9\u51fa\u4f60\u7684\u4ee3\u7801\uff1a</p> <p>\u5f53\u7136\uff0c\u5373\u4f7f\u4f60\u6ca1\u6709\u5b66\u4e60\u8fc7 python \u4e5f\u65e0\u9700\u614c\u5f20\uff1b\u4f60\u53ef\u4ee5\u901a\u8fc7\u5982\u83dc\u9e1f\u6559\u7a0b\u548c\u5404\u7c7b\u6155\u8bfe\u8fdb\u884c\u7b80\u5355\u7684\u5b66\u4e60\u3002\u4f60\u65e0\u9700\u6210\u4e3a\u4e00\u4e2a python master\uff0c\u57fa\u672c\u7684\u4ee3\u7801\u9605\u8bfb\u80fd\u529b\u4ee5\u53ca\u7f16\u7a0b\u80fd\u529b\u8db3\u4ee5\u4f7f\u4f60\u901a\u8fc7\u6b64\u8bfe\u3002</p> <ol> <li> <p>\u8bf7\u9605\u8bfb\u548c\u6267\u884c\u5982\u4e0b python \u7a0b\u5e8f\uff0c\u5728\u5b9e\u9a8c\u62a5\u544a\u4e2d\u5e76\u89e3\u91ca\u5176\u529f\u80fd: <pre><code>#!/usr/bin/python3\ndata = input(\"give me your string: \")\nprint(\"length of string:\", len(data))\ndata_old = data\ndata_new = \"\"\nfor d in data:\nif d in 'abcdefghijklmnopqrstuvwxyz':\ndata_new += chr(ord(d) - 32)\nelif d in 'ABCDEFGHIJKLMNOPQRSTUVWXYZ':\ndata_new += chr(ord(d) + 32)\nelse:\ndata_new += d\nprint(\"now your string:\", data_new)\n</code></pre></p> </li> <li> <p>\u8bf7\u901a\u8fc7 python \u7f16\u7a0b\u89e3\u51b3\u6821\u5df4\u4e0a calculator \u8fd9\u9053\u7f16\u7a0b\u9898\uff08\u9700\u8981\u5185\u7f51\u8bbf\u95ee\uff09\uff0c\u5728\u5b9e\u9a8c\u62a5\u544a\u4e2d\u7ed9\u51fa\u5b8c\u6574\u4ee3\u7801\u3001\u6210\u529f\u89e3\u51b3\u7684\u622a\u56fe\u4ee5\u53ca\u6b63\u786e\u7684 flag</p> </li> </ol> <p>hint: </p> <ul> <li>\u5982\u679c\u4e0d\u77e5\u9053\u4ece\u54ea\u5f00\u59cb\u53ef\u4ee5\u67e5\u770b\u6211\u4eec\u63d0\u4f9b\u7684\u90e8\u5206\u4ee3\u7801\uff0c\u5df2\u7ecf\u5b8c\u6210\u4e86\u9898\u76ee\u7684\u8fde\u63a5\u4ee5\u53ca\u6570\u636e\u7684\u63a5\u6536<ul> <li>\u6216\u8005\u63a8\u8350\u81ea\u5b66\u4f7f\u7528 pwntools \u8fd9\u4e2a CTF \u4e2d\u975e\u5e38\u5e38\u7528\u7684 python \u5305\u8fdb\u884c\u4ea4\u4e92</li> </ul> </li> <li><code>eval</code> \u51fd\u6570\u53ef\u4ee5\u7528\u4e8e\u8ba1\u7b97</li> </ul>"},{"location":"intro/lab0/#challenge-3","title":"Challenge 3\uff08\u9009\u505a\uff09","text":"<p>\u4e8c\u8fdb\u5236\u76f8\u5173\u7684\u8bfe\u9898\u65b9\u5411\uff08Pwn \u4ee5\u53ca Reverse\uff09\u90fd\u9700\u8981 x86 \u6c47\u7f16\u7684\u77e5\u8bc6\uff0c\u5982\u679c\u5bf9\u8be5\u4e24\u65b9\u5411\u6709\u5174\u8da3\u7684\u8bdd\uff0c\u53ef\u9009\u5b8c\u6210\u8fd9\u4e2a asm tour \u6c47\u7f16\u9898\u76ee\uff0c\u5728\u5b9e\u9a8c\u62a5\u544a\u4e2d\u7ed9\u51fa\u4f60\u7684\u89e3\u9898\u8fc7\u7a0b\u3002</p> <p>\u5982\u679c\u5b8c\u5168\u6ca1\u6709\u63a5\u89e6\u8fc7\u6c47\u7f16\u8bed\u8a00\uff0c\u4e5f\u65e0\u9700\u62c5\u5fc3\uff0c\u53ef\u4ee5\u5b66\u4e60 hint \u63d0\u5230\u7684\u8d44\u6599\u3002\u5bf9\u6307\u4ee4\u3001\u5bc4\u5b58\u5668\u3001\u8c03\u7528\u89c4\u5b9a\u7b49\u77e5\u8bc6\u505a\u4e2a\u57fa\u672c\u4e86\u89e3\u3002</p> <p>hint:</p> <ul> <li>\u5c0f\u767d\u8001\u5e08\u7684\u6c47\u7f16\u8bfe\u7a0b\u8d44\u6599</li> <li>x86\u7684\u6c47\u7f16\u7b14\u8bb0</li> </ul>"},{"location":"intro/lab0/#web","title":"Web","text":"<p>\u53c2\u8003\u96be\u5ea6\uff1a\u2605\u2605</p> <p>\u8bf7\u8bbf\u95ee\u7f51\u5740 http://pumpk1n.com/lab0.php \u8fd9\u4e2a\u795e\u5947\u7684\u9875\u9762\u85cf\u7740\u4e00\u4e2a flag\uff0c\u8bf7\u5c1d\u8bd5\u627e\u5230\u5b83\uff0c\u5e76\u5728\u5b9e\u9a8c\u62a5\u544a\u4e2d\u8bb0\u5f55\u4f60\u7684\u8fc7\u7a0b\u3002</p> <p>hint:</p> <ul> <li>\u6d4f\u89c8\u5668\u4e2d\u7684\u5f00\u53d1\u8005\u5de5\u5177</li> </ul>"},{"location":"intro/lab0/#pwn","title":"Pwn","text":"<p>\u53c2\u8003\u96be\u5ea6\uff1a\u2605\u2605</p> <ol> <li>\u8bf7\u9605\u8bfb\u9644\u4ef6\u4e2d\u7684 C \u4ee3\u7801 bug_program.c\uff0c\u5c1d\u8bd5\u627e\u5230\u4ee3\u7801\u4e2d\u6240\u6709\u7684BUG\uff0c\u5e76\u5728\u5b9e\u9a8c\u62a5\u544a\u4e2d\u7ed9\u51fa\u63cf\u8ff0</li> <li>\u9644\u4ef6\u4e2d\u7684 bug_program.elf \u662f Linux \u5e73\u53f0\u4e0a\u7f16\u8bd1\u7684\u53ef\u6267\u884c ELF \u7a0b\u5e8f\uff0c\u8bf7\u5728 Linux \u73af\u5883\u4e0b\u6267\u884c\u8be5\u7a0b\u5e8f\uff0c\u5e76\u5728\u4e0e\u5176\u4ea4\u4e92\u7684\u8fc7\u7a0b\u4e2d\u89e6\u53d1\u627e\u5230\u7684\u6f0f\u6d1e\uff0c\u8fd9\u4e9b\u6f0f\u6d1e\u53ef\u4ee5\u4f7f\u5f97\u7a0b\u5e8f\u5d29\u6e83\u4e48\uff1f</li> <li>\u8bf7\u4fee\u590d bug_program.c \u4e2d\u53d1\u73b0\u7684\u6f0f\u6d1e\uff0c\u5c06\u65b0\u7684\u4ee3\u7801\u547d\u540d\u4e3a no_program.c \u5e76\u63d0\u4ea4</li> </ol>"},{"location":"intro/lab0/#reverse","title":"Reverse","text":"<p>\u53c2\u8003\u96be\u5ea6\uff1a\u2605\u2605\u2605</p> <p>\u53ef\u6076\uff0c\u4e3a\u4ec0\u4e48\u8fd9\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u65e0\u6cd5\u8fd0\u884c\uff0c\u5176\u4e2d\u7a76\u7adf\u9690\u85cf\u7740\u4ec0\u4e48\u79d8\u5bc6\uff01\uff08\u8be5\u79d8\u5bc6\u4e3a\u4e00\u4e32\u6709\u610f\u4e49\u7684\u5b57\u7b26\u4e32\uff0c\u683c\u5f0f\u4e3a <code>AAA{...}</code>\uff09\uff1a</p> <p>\u9898\u76ee\u4e0b\u8f7d\u94fe\u63a5</p> <p>\u4f60\u9700\u8981\u5728\u5b9e\u9a8c\u62a5\u544a\u4e2d\u56de\u7b54\u4ee5\u4e0b\u51e0\u4e2a\u95ee\u9898\uff1a</p> <ol> <li>\u53ef\u6267\u884c\u6587\u4ef6\u7684\u5165\u53e3\u70b9\u5730\u5740\uff08Entry Point Address\uff09\u662f\u591a\u5c11\uff1f</li> <li>\u53ef\u6267\u884c\u6587\u4ef6\u65e0\u6cd5\u8fd0\u884c\u7684\u539f\u56e0\u662f\u4ec0\u4e48\uff1f\u901a\u8fc7\u4ec0\u4e48\u65b9\u6cd5\u53ef\u4ee5\u8ba9\u5b83\u6b63\u5e38\u8fd0\u884c\uff1f</li> <li>\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\u9690\u85cf\u7684\u79d8\u5bc6\uff08\u5373\u683c\u5f0f\u4e3a <code>AAA{...}</code> \u7684\u5b57\u7b26\u4e32\uff09\u662f\uff1f\u4f60\u662f\u5982\u4f55\u83b7\u5f97\u5b83\u7684\uff1f</li> </ol> <p>hint:</p> <ul> <li>\u9700\u8981\u7b80\u5355\u4e86\u89e3 ELF \u53ef\u6267\u884c\u6587\u4ef6\u7684\u683c\u5f0f\u3001\u52a0\u8f7d\u3001\u94fe\u63a5\u6267\u884c</li> <li>\u5982\u679c\u78b0\u5230\u4e86 <code>GLIBC_2.34 not found</code> \u7684\u62a5\u9519\uff0c\u8bf7\u4e0b\u8f7d\u6b64\u7248\u672c\u7684\u9898\u76ee\u9644\u4ef6\uff0c\u94fe\u63a5</li> </ul>"},{"location":"intro/lab0/#misc","title":"Misc","text":""},{"location":"intro/lab0/#challenge-1","title":"Challenge 1","text":"<p>\u53c2\u8003\u96be\u5ea6\uff1a\u2605</p> <p>\u8fd9\u91cc\u6709\u4e00\u4e32\u88ab\u7f16\u7801\u8fc7\u7684\u795e\u79d8\u7684\u5b57\u7b26\u4e32\uff0c\u8bf7\u627e\u51fa\u6709\u610f\u4e49\u7684\u539f\u5b57\u7b26\u4e32\uff08\u683c\u5f0f\u4e3a <code>AAA{...}</code>\uff09\uff1a</p> <pre><code>8Q%uH7oV9C7o!2f7oD*@8Oc$J2Gu:s:JO2T78HTV8PrVj9/]^B:0'e_6SgJh7n,=8;)V$M:Gkm:92eJR8Oc-;;`$6b:Gk[5=]\\L#7mT%14Ztqk\n</code></pre> <p>\u8bf7\u5728\u5b9e\u9a8c\u62a5\u544a\u4e2d\u7ed9\u51fa\u4f60\u5177\u4f53\u7684\u89e3\u5bc6\u8fc7\u7a0b\u3002</p> <p>hint:</p> <ul> <li>\u4f60\u53ef\u80fd\u4f1a\u9700\u8981 CyberChef\uff08\u800c\u4e14\u8fd9\u91cc\u6709\u4e00\u4e2a\u529f\u80fd\u53ef\u4ee5\u79d2\u6740\u8fd9\u4e2a\u9898\u76ee\uff09</li> <li>\u4f60\u53ef\u80fd\u9700\u8981\u4e86\u89e3\u4e00\u4e9b\u5173\u4e8e Base \u7cfb\u5217\u7f16\u7801\u7684\u7279\u5f81</li> </ul>"},{"location":"intro/lab0/#challenge-2_1","title":"Challenge 2","text":"<p>\u53c2\u8003\u96be\u5ea6\uff1a\u2605\u2605\u2605</p> <p>\u4e0b\u9762\u8fd9\u5f20\u56fe\u662f AAA \u7684 logo\u3002\u771f\u7684\u2026\u2026\u53ea\u662f\u4e00\u4e2a logo \u5417\uff1f\u5176\u5b9e\u8fd9\u5f20\u56fe\u7247\u4e2d\u9690\u85cf\u4e86\u4e00\u4e2a flag\uff08\u683c\u5f0f <code>AAA{...}</code>\uff09\uff0c\u8bf7\u4f60\u627e\u51fa\u6765\u3002</p> <p></p> <p>\u8bf7\u5728\u5b9e\u9a8c\u62a5\u544a\u4e2d\u7ed9\u51fa\u4f60\u7684\u89e3\u9898\u8fc7\u7a0b\uff0c\u5305\u62ec\u4f60\u6700\u7ec8\u5f97\u5230\u7684 flag \u5185\u5bb9\u3002</p> <p>hint\uff1a</p> <ul> <li>flag \u88ab\u5206\u4e3a\u4e86\u4e24\u4e2a\u90e8\u5206</li> <li>\u5982\u679c\u4f60\u627e\u4e0d\u5230\u7b2c\u4e00\u90e8\u5206\uff0c\u4ed4\u7ec6\u89c2\u5bdf\u56fe\u7247\uff0c\u8fd9\u4f7f\u7528\u4e86\u4e00\u79cd\u6700\u57fa\u7840\u7684\u56fe\u7247\u9690\u5199\u6280\u672f LSB \u9690\u5199\uff0c\u8bf7\u81ea\u884c\u641c\u7d22\u5b66\u4e60\u5982\u4f55\u7834\u89e3</li> <li>\u5982\u679c\u4f60\u627e\u4e0d\u5230\u7b2c\u4e8c\u90e8\u5206\uff0c\u8bf7\u4ed4\u7ec6\u67e5\u770b\u6587\u4ef6\u5185\u5bb9</li> </ul>"},{"location":"intro/lab0/#crypto","title":"Crypto","text":""},{"location":"intro/lab0/#_1","title":"\u9898\u76ee\u76f8\u5173\u80cc\u666f\u77e5\u8bc6","text":"<p>AES\u662f\u4e00\u79cd\u5bf9\u79f0\u52a0\u5bc6\u673a\u5236\uff0c\u6bd4RSA\u8fd9\u6837\u7684\u975e\u5bf9\u79f0\u52a0\u5bc6\u5feb\u8bb8\u591a\u3002\u7531\u4e8e\u672c\u9898\u53ea\u6d89\u53ca <code>AddRoundKey</code> \u548c <code>Substitution Bytes</code> \u5185\u5bb9\uff0c\u6240\u4ee5\u53ea\u5bf9\u5b9e\u9a8c\u76f8\u5173\u90e8\u5206\u8fdb\u884c\u7b80\u8981\u8bf4\u660e\uff0c\u800c AES \u7684\u5b8c\u6574\u7ec6\u8282\u53ef\u4ee5\u5728\u8fd9\u91cc\u9605\u8bfb\u5b66\u4e60\u3002</p>"},{"location":"intro/lab0/#bytes2matrix","title":"bytes2matrix","text":"<p>\u7531\u4e8e AES \u7684\u52a0\u5bc6\u8fc7\u7a0b\u4e2d\u7684\u72b6\u6001\u7528\u4e00\u4e2a 4x4 \u7684\u5b57\u8282\u77e9\u9635\uff0c\u6240\u4ee5\u5bf9\u4e8e\u5b57\u7b26\u4e32\u5f62\u5f0f\u7684\u660e\u6587\uff0c\u9996\u5148\u9700\u8981\u628a\u5176\u8868\u793a\u4e3a\u4e00\u4e2a 4x4 \u7684\u5b57\u8282\u77e9\u9635\uff08\u5bf9\uff0c\u5c31\u662f\u7ebf\u6027\u4ee3\u6570\u91cc\u90a3\u4e2a\u77e9\u9635\uff09\uff0c\u5bf9\u5e94\u9898\u76ee\u4ee3\u7801\u4e2d\u7684 <code>bytes2matrix</code>\uff0c\u7136\u540e\u8fdb\u884c\u540e\u7eed\u52a0\u5bc6\u6d41\u7a0b\u3002</p> <p>\u8be5\u90e8\u5206\u7684\u4ee3\u7801\u5df2\u7ecf\u7ed9\u51fa\uff0c\u4e0d\u9700\u8981\u4f60\u8865\u5168\uff0c\u4e0a\u8ff0\u6587\u5b57\u53ea\u662f\u8f85\u52a9\u7406\u89e3\u3002</p>"},{"location":"intro/lab0/#addroundkey","title":"AddRoundKey","text":"<p>AddRoundKey \u6b65\u9aa4\u5f88\u7b80\u5355\uff1a\u5b83\u5c06\u5f53\u524d\u72b6\u6001(4x4 \u7684\u5b57\u8282\u77e9\u9635)\u4e0e\u5f53\u524d\u8f6e\u5bc6\u94a5(4x4 \u7684\u5b57\u8282\u77e9\u9635)\u8fdb\u884c\u5f02\u6216\u8fd0\u7b97\u3002</p> <p>\u5f02\u6216\u9700\u8981\u7528\u5230\u7684\u8f6e\u5bc6\u94a5\u5df2\u7ecf\u7ed9\u51fa\uff0c\u5bf9\u5e94\u9898\u76ee\u4ee3\u7801\u4e2d\u7684 <code>round_key</code>\uff0c\u4f60\u53ea\u9700\u8981 <code>add_round_key</code> \u4e2d\u7684\u8865\u5168\u5f02\u6216\u7b97\u6cd5\u5373\u53ef\u3002\uff08\u4e0d\u8d85\u8fc7\u4e09\u884c\u2757\ufe0f\uff09</p>"},{"location":"intro/lab0/#subbytes","title":"SubBytes","text":"<p>\u5c06\u72b6\u6001\u77e9\u9635\u7684\u6bcf\u4e2a\u5b57\u8282\u66ff\u6362\u4e3a\u9884\u8bbe 16x16 \u67e5\u627e\u8868\u4e2d\u7684\u4e0d\u540c\u5b57\u8282\u3002\u67e5\u627e\u8868\u79f0\u4e3a\u201cSubstitution box\u201d\u6216\u7b80\u79f0\u201cS-box\u201d\uff0c\u6216\u8bb8\u4f60\u53ef\u80fd\u4f1a\u5bf9\u4e3a\u4ec0\u4e48\u52a0\u5bc6\u8fc7\u7a0b\u4e2d\u9700\u8981 substitution \u611f\u5230\u7591\u60d1\uff0c\u6ca1\u5173\u7cfb\u76ee\u524d\u4e0d\u9700\u8981\u7406\u89e3\u76f8\u5173\u5185\u5bb9\u3002\u5982\u679c\u4e00\u53e5\u8bdd\u6982\u62ec\u539f\u56e0\uff0c\u662f\u4e3a\u4e86\u4f7f\u5f97AES\u7684\u8f93\u5165\u8f93\u51fa\u4e4b\u95f4\u5177\u6709\u9ad8\u7684\u201c\u975e\u7ebf\u6027\u6027\u201d\u3002</p> <p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0csubstitution \u7684\u7b97\u6cd5\u5728\u52a0\u5bc6\u548c\u89e3\u5bc6\u8fc7\u7a0b\u4e2d\u5e76\u6ca1\u6709\u4e0d\u540c\uff0c\u53ea\u662f\u4f7f\u7528\u7684 S-box \u53d8\u6210\u4e86\u539f S-box \u7684\u9006\u800c\u5df2\u3002\u4e3a\u4e86\u4f7f\u5f97\u9898\u76ee\u770b\u8d77\u6765\u77ed\u4e00\u4e9b\uff0c\u6211\u5220\u9664\u4e86\u52a0\u5bc6\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u7684 S-box\uff0c\u53ea\u7ed9\u51fa\u4e86\u52a0\u5bc6\u7684 S-box \u7684\u9006\uff0c\u5bf9\u5e94\u9898\u76ee\u4ee3\u7801\u4e2d\u7684 <code>inv_s_box</code>\u3002\u4f60\u53ea\u9700\u8981\u8865\u5168 <code>sub_bytes</code> \u51fd\u6570\u5373\u53ef\u3002\uff08\u540c\u6837\u4e0d\u8d85\u8fc7\u4e09\u884c\u2757\ufe0f\uff09</p>"},{"location":"intro/lab0/#challenge","title":"Challenge","text":"<p>\u53c2\u8003\u96be\u5ea6\uff1a\u2605\u2605</p> <p>\u9898\u76ee\u4e0b\u8f7d\u94fe\u63a5</p> <p>\u4e0a\u9898\u662f\u5bf9AES\u7684\u7b80\u5355\u62bd\u8c61\uff0c\u5176\u4e2d\u9700\u8981\u4f60\u8865\u5168\u7684 <code>add_round_key</code> \u548c <code>sub_bytes</code> \u4ee3\u7801\u7b26\u5408AES\u7684 <code>AddRoundKey</code> \u548c <code>SubBytes</code> \u7684\u6807\u51c6\u5b9e\u73b0\uff0c\u8bf7\u4f60\u9605\u8bfb\u4e0a\u8ff0\u80cc\u666f\u6216\u67e5\u9605\u76f8\u5173\u6587\u6863\uff0c\u5b9e\u73b0\u8fd9\u4e24\u4e2a\u51fd\u6570\u3002\u5982\u679c\u5b9e\u73b0\u6b63\u786e\u4f1a\u8f93\u51fa\u683c\u5f0f\u4e3a <code>AAA{...}</code> \u7684 flag\u3002</p> <p>\u8bf7\u5728\u5b9e\u9a8c\u62a5\u544a\u4e2d\u7ed9\u51fa\u4f60\u7684\u89e3\u9898\u8fc7\u7a0b\uff0c\u5305\u62ec\u4f60\u6700\u7ec8\u5f97\u5230\u7684 flag \u5185\u5bb9\u3002</p> <p>hint:</p> <ul> <li>\u4e00\u5171\u5c31\u4e0d\u8d85\u8fc7 10 \u884c\u4ee3\u7801\uff0c\u5927\u6982\u4e0d\u9700\u8981 hint\uff1b\u5982\u679c\u771f\u7684\u9700\u8981\uff0c\u8bf7\u641c\u7d22\u4e00\u4e0b AES \u76f8\u5173\u6587\u6863\u548c\u4ee3\u7801\u5b9e\u73b0\u3002</li> </ul>"},{"location":"intro/misc-lab1/","title":"Misc Lab 1\uff1a\u7f16\u89e3\u7801\u53ca OSINT","text":"<p>\u672c\u8282 Lab \u7531\u4ee5\u4e0b\u4e24\u90e8\u5206\u7ec4\u6210\uff1a</p> <ul> <li>Task 1: \u4e71\u7801\u60c5\u5f62\u63a2\u7a76\uff0860 \u5206\uff09</li> <li>\u4e24\u9053\u9898\u76ee\u4e8c\u9009\u4e00\u5b8c\u6210\uff0840 \u5206\uff0c\u591a\u505a\u4e3a bonus\uff09<ul> <li>Challenge 1: \u7c7b\u7ef4\u5409\u5c3c\u4e9a\u5bc6\u7801\u7834\u89e3</li> <li>Challenge 2: OSINT \u56fe\u7247\u4fe1\u606f\u641c\u96c6\u5b9e\u6218</li> </ul> </li> </ul> <p>\u5177\u4f53\u5b9e\u9a8c\u62a5\u544a\u9700\u8981\u5199\u7684\u5185\u5bb9\u4f1a\u5728\u4e0b\u9762\u5177\u4f53\u9898\u76ee\u91cc\u9762\u63cf\u8ff0\u3002\u5bf9\u4e8e\u9898\u76ee\u6709\u4efb\u4f55\u95ee\u9898\u90fd\u53ef\u4ee5\u5728\u7fa4\u91cc/\u79c1\u6233 TonyCrane \u63d0\u95ee\u3002</p> <p>\u672c\u6b21 lab \u7684 ddl \u5728\u53d1\u5e03\u4e24\u5468\u4ee5\u540e\u5373 7 \u6708 21 \u65e5\u665a 23:59\uff0c\u8bf7\u6ce8\u610f\u5b89\u6392\u65f6\u95f4\u3002</p>"},{"location":"intro/misc-lab1/#task-1","title":"Task 1","text":""},{"location":"intro/misc-lab1/#background","title":"Background","text":"<p>\u6211\u4eec\u8bfe\u4e0a\u4ecb\u7ecd\u4e86\u5b57\u7b26\u7f16\u7801\u7684\u610f\u4e49\uff0c\u5e76\u4e14\u8f83\u4e3a\u8be6\u7ec6\u7684\u8bb2\u89e3\u4e86 ASCII\u3001Latin-1\u3001Unicode \u4ee5\u53ca\u7cfb\u5217\u7f16\u7801\u7684\u539f\u7406\u3002\u5728\u8fd9\u4e2a\u4efb\u52a1\u4e2d\uff0c\u4f60\u5c06\u9700\u8981\u81ea\u884c\u67e5\u9605\u8d44\u6599\u4e86\u89e3 GB 2312\u3001GBK\u3001GB 18030 \u7b49\u56fd\u6807\u7801\u7684\u7f16\u7801\u65b9\u5f0f\u3002\u4e4b\u540e\u8fdb\u4e00\u6b65\u63a2\u7d22\u4e86\u89e3\u5404\u79cd\u60c5\u51b5\u4e71\u7801\u4ea7\u751f\u7684\u539f\u56e0\uff0c\u601d\u8003\u6062\u590d\u4e71\u7801\u7684\u53ef\u80fd\u6027\u3002</p>"},{"location":"intro/misc-lab1/#gb","title":"GB \u7cfb\u5217\u7f16\u7801","text":"<p>\u8fd9\u90e8\u5206\u7559\u7ed9\u5927\u5bb6\u81ea\u884c\u67e5\u9605\u8d44\u6599\u4e86\u89e3\u3002\u4f60\u9700\u8981\u77e5\u9053\u7684\u662f GB 2312\u3001GBK\u3001GB 18030 \u89c4\u5b9a\u4e86\u4e09\u4e2a\u4e0d\u540c\u5927\u5c0f\u7684\u5b57\u7b26\u96c6\uff0c\u4ee5\u53ca\u9488\u5bf9\u6bcf\u4e2a\u5b57\u7b26\u7684\u7f16\u7801\u3002\u4e14 GB 18030 \u517c\u5bb9 GBK \u517c\u5bb9 GB 2312 \u517c\u5bb9 ASCII\u3002\u66f4\u591a\u7ec6\u8282\u53ef\u4ee5\u81ea\u884c\u67e5\u9605\u6807\u51c6\u6587\u4ef6\u3001\u4ecb\u7ecd\u535a\u5ba2\u7b49\u3002</p>"},{"location":"intro/misc-lab1/#_1","title":"\u4e71\u7801\u539f\u56e0","text":"<p>\u8bfe\u4e0a\u6211\u4eec\u8bb2\u8fc7\u4e86\uff0c\u901a\u8fc7\u4e00\u79cd\u5b57\u7b26\u7f16\u7801\u6765\u89e3\u8bfb\u53e6\u4e00\u79cd\u5b57\u7b26\u7f16\u7801\u7684\u5b57\u8282\u6d41\uff0c\u5c31\u4f1a\u5bfc\u81f4\u89e3\u8bfb\u51fa\u6765\u7684\u5b57\u7b26\u5e76\u975e\u9884\u671f\uff0c\u4ece\u800c\u4ea7\u751f\u6240\u8c13\u201c\u4e71\u7801\u201d\u3002\u8fd9\u91cc\u6211\u4eec\u5c06\u63a2\u7a76\u4e00\u4e0b\u5177\u4f53\u7684\u539f\u56e0\u3002</p> <p>\u5e38\u89c1\u60c5\u51b5\u4e0b\u6709\u4ee5\u4e0b\u51e0\u79cd\u60c5\u5f62\uff1a</p> <ol> <li>\u7528 GBK \u89e3\u7801 UTF-8 \u7f16\u7801\u7684\u6587\u672c</li> <li>\u7528 UTF-8 \u89e3\u7801 GBK \u7f16\u7801\u7684\u6587\u672c</li> <li>\u7528 latin-1 \u89e3\u7801 UTF-8 \u7f16\u7801\u7684\u6587\u672c</li> <li>\u7528 latin-1 \u89e3\u7801 GBK \u7f16\u7801\u7684\u6587\u672c</li> <li>\u5148\u7528 GBK \u89e3\u7801 UTF-8 \u7f16\u7801\u7684\u6587\u672c\uff0c\u518d\u7528 UTF-8 \u89e3\u7801\u524d\u9762\u7684\u7ed3\u679c</li> <li>\u5148\u7528 UTF-8 \u89e3\u7801 GBK \u7f16\u7801\u7684\u6587\u672c\uff0c\u518d\u7528 GBK \u89e3\u7801\u524d\u9762\u7684\u7ed3\u679c</li> </ol> <p>\u6ce8\u610f\u8981\u60f3\u9020\u6210\u4e71\u7801\uff0c\u4e00\u5b9a\u8bf4\u660e\u5b57\u7b26\u7f16\u7801\u4e4b\u95f4\u5b58\u5728\u4e0d\u517c\u5bb9\u90e8\u5206\uff0c\u56e0\u6b64\u8fd9\u51e0\u79cd\u7f16\u7801\u4e92\u76f8\u517c\u5bb9\u7684 ASCII \u7f16\u7801\u4e00\u5b9a\u4e0d\u4f1a\u51fa\u73b0\u4e71\u7801\uff0c\u800c\u4e2d\u6587\u6587\u672c\u5219\u4f1a\u51fa\u73b0\u4e71\u7801\u3002</p> <p>\u4e0b\u9762\u6211\u4f1a\u4ecb\u7ecd\u51e0\u79cd\u7814\u7a76\u4e71\u7801\u7684\u65b9\u5f0f\uff0c\u4f9b\u5927\u5bb6\u53c2\u8003\u3002</p>"},{"location":"intro/misc-lab1/#vscode","title":"vscode","text":"<p>\u521b\u5efa\u4e00\u4e2a\u6587\u672c\u6587\u4ef6\uff0c\u4f7f\u7528 vscode \u6253\u5f00\uff0c\u5728\u53f3\u4e0b\u89d2\u4f60\u4f1a\u770b\u5230\u6587\u4ef6\u7684\u7f16\u7801\u65b9\u5f0f\uff08\u4e00\u822c\u60c5\u51b5\u4e0b\u9ed8\u8ba4\u4e3a UTF-8\uff09\uff0c\u8bf4\u660e\u6b64\u65f6\u6587\u4ef6\u5b58\u50a8\u7684\u4e8c\u8fdb\u5236\u4e3a UTF-8 \u7f16\u7801\u7684\u5b57\u8282\u6d41\u3002\u8fd9\u65f6\u4f60\u53ef\u4ee5\u70b9\u51fb\u8fd9\u4e2a\u4f4d\u7f6e\uff0c\u9009\u62e9\u201c\u901a\u8fc7\u7f16\u7801\u91cd\u65b0\u6253\u5f00\uff08Reopen with Encoding\uff09\u201d\uff0c\u9009\u62e9 GBK \u7f16\u7801\uff0c\u8fd9\u6837\u4f60\u6240\u770b\u89c1\u7684\u5c31\u662f\u5c06\u539f\u6709\u6587\u4ef6\u5b57\u8282\u6d41\u901a\u8fc7 GBK \u7f16\u7801\u89e3\u6790\u51fa\u6765\u7684\u5b57\u7b26\uff08\u5373\u524d\u9762\u8bf4\u5230\u7684\u7b2c 1 \u79cd\u60c5\u51b5\uff09\uff0c\u4e0d\u51fa\u610f\u5916\u5b83\u5e94\u8be5\u662f\u4e71\u7801\u3002</p> <p></p> <p>\u6216\u8bb8\u4f60\u4e5f\u4f1a\u53d1\u73b0\u8fd8\u6709\u4e00\u4e2a\u9009\u9879\u4e3a\u201c\u901a\u8fc7\u7f16\u7801\u4fdd\u5b58\uff08Save with Encoding\uff09\u201d\uff0c\u5b83\u7684\u4f5c\u7528\u5c31\u662f\u5c06\u4f60\u73b0\u5728\u770b\u5230\u7684\u5b57\u7b26\u901a\u8fc7\u5236\u5b9a\u7684\u7f16\u7801\u65b9\u5f0f\u91cd\u65b0\u7f16\u7801\u4e3a\u5b57\u8282\u6d41\uff0c\u7136\u540e\u4fdd\u5b58\u56de\u6587\u4ef6\u4e2d\u3002\u6bd4\u5982\u7ee7\u7eed\u4e0a\u4e00\u6b65\uff0c\u6211\u4eec\u770b\u5230\u4e86\u4e71\u7801\uff0c\u7136\u540e\u9009\u62e9\u901a\u8fc7\u7f16\u7801\u4fdd\u5b58\uff0c\u9009\u62e9 GBK\uff0c\u770b\u8d77\u6765\u6ca1\u6709\u4efb\u4f55\u4e8b\u60c5\u53d1\u751f\u3002\u63a5\u4e0b\u6765\u518d\u9009\u62e9\u901a\u8fc7\u7f16\u7801\u91cd\u65b0\u6253\u5f00\uff0c\u9009\u62e9 UTF-8\uff0c\u4f60\u6216\u8bb8\u4f1a\u89c9\u5f97\u6b64\u65f6\u6062\u590d\u4e86\u6b63\u5e38\uff0c\u4f46\u6709\u4e00\u4e9b\u4f4d\u7f6e\u7684\u5b57\u7b26\u53d8\u6210\u4e86\u5947\u602a\u7684\u7b26\u53f7\uff0c\u8fd9\u79cd\u60c5\u51b5\u5c31\u662f\u524d\u9762\u8bf4\u5230\u7684\u7b2c 5 \u4e2d\u60c5\u51b5\u3002</p> <p>\u540c\u7406\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u540c\u6837\u7684\u65b9\u5f0f\u7814\u7a76\u5176\u4ed6\u56db\u79cd\u4e71\u7801\u3002</p>"},{"location":"intro/misc-lab1/#_2","title":"\u89c2\u5bdf\u5341\u516d\u8fdb\u5236","text":"<p>\u524d\u9762\u6211\u4eec\u53ea\u770b\u5230\u4e86\u89e3\u7801\u7684\u7ed3\u679c\uff0c\u800c\u6ca1\u6709\u770b\u5230\u6587\u4ef6\u5b58\u50a8\u5b57\u8282\u6d41\u7684\u5185\u5bb9\u3002\u5c06\u5b57\u8282\u6d41\u548c\u89e3\u7801\u5f97\u5230\u7684\u5b57\u7b26\u5173\u8054\u8d77\u6765\u53ef\u4ee5\u66f4\u597d\u7684\u7406\u89e3\u4e71\u7801\u4ea7\u751f\u7684\u539f\u56e0\u3002\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5728 vscode \u7684\u57fa\u7840\u4e0a\u518d\u4f7f\u7528\u5341\u516d\u8fdb\u5236\u7f16\u8f91\u5668\u6765\u67e5\u770b\u6587\u4ef6\u6d41\u7684\u5185\u5bb9\uff0c\u8fdb\u884c\u6bd4\u5bf9\u3002</p>"},{"location":"intro/misc-lab1/#cyberchef","title":"CyberChef","text":"<p>\u6211\u4eec\u8bfe\u4e0a\u63d0\u5230\u4e86\uff0cCyberChef \u7684 Input \u548c Output \u7a97\u683c\u5f88\u6e05\u6670\u5730\u589e\u52a0\u4e86\u5b57\u7b26\u7f16\u7801\u7684\u9009\u9879\uff0c\u56e0\u6b64\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u8fdb\u884c\u7f16\u7801\u7684\u8f6c\u6362\u3002</p> <p></p> <p>\u4f46\u662f CyberChef \u4e5f\u5b58\u5728\u4e00\u4e2a\u95ee\u9898\uff0c\u8fd9\u4e2a\u95ee\u9898\u548c\u5904\u7406 UTF-8 \u9519\u8bef\u7f16\u7801\u6709\u5173\uff0c\u5173\u4e8e UTF-8 \u9519\u8bef\u7f16\u7801\u7684\u66f4\u591a\u4fe1\u606f\u540e\u9762\u9a6c\u4e0a\u5c31\u4f1a\u8bf4\u5230\u3002\u8fd9\u662f\u4e00\u4e2a bonus\uff0c\u5982\u679c\u4f60\u80fd\u591f\u7406\u89e3\u4e3a\u4ec0\u4e48 CyberChef \u548c vscode \u9488\u5bf9\u7b2c\u4e8c\u79cd\u60c5\u51b5\u7684\u4e71\u7801\u7ed3\u679c\u4e0d\u4e00\u6837\uff0c\u4f60\u5c06\u5f97\u5230 bonus\u3002</p>"},{"location":"intro/misc-lab1/#python","title":"python","text":"<p>\u5229\u7528 python \u4e5f\u53ef\u4ee5\u8fdb\u884c\u7f16\u7801\u7684\u8f6c\u6362\uff0c\u8fd9\u91cc\u662f\u4e00\u4e9b\u4f8b\u5b50\uff1a</p> <pre><code>In [1]: \"\u6d4b\u8bd5\".encode(\"UTF-8\").decode(\"GBK\") # \u7b2c\u4e00\u79cd\u60c5\u51b5\u7684\u4e71\u7801\nOut[1]: '\u5a34\u5b2d\u762f'\nIn [2]: \"\u6d4b\u8bd5\".encode(\"UTF-8\")  # \u7528 UTF-8 \u7f16\u7801\u7f16\u7801 \u201c\u6d4b\u8bd5\u201d\nOut[2]: b'\\xe6\\xb5\\x8b\\xe8\\xaf\\x95'\nIn [3]: \"\u5a34\u5b2d\u762f\".encode(\"GBK\")  # \u7528 GBK \u7f16\u7801\u7f16\u7801 \u201c\u5a34\u5b2d\u762f\u201d\nOut[3]: b'\\xe6\\xb5\\x8b\\xe8\\xaf\\x95'\nIn [4]: bin(0xe6), bin(0xb5), bin(0x8b) # \u5c06\u5341\u516d\u8fdb\u5236\u8f6c\u6362\u4e3a\u4e8c\u8fdb\u5236\nOut[4]: ('0b11100110', '0b10110101', '0b10001011')\nIn [5]: hex(0b0110_110101_001011)   # \u624b\u52a8\u89e3\u7801 UTF-8 \u5f97\u5230 Unicode \u7801\u4f4d\nOut[5]: '0x6d4b'\nIn [6]: \"\\u6d4b\"    # \u5c06 Unicode \u7801\u4f4d\u8f6c\u6362\u4e3a\u5b57\u7b26\nOut[6]: '\u6d4b'\n</code></pre>"},{"location":"intro/misc-lab1/#utf-8","title":"UTF-8 \u89e3\u7801\u9519\u8bef","text":"<p>\u6211\u4eec\u8bfe\u4e0a\u8bb2\u5230\u4e86 Latin-1 \u7f16\u7801\u53ef\u4ee5\u89e3\u7801\u4efb\u610f\u5b57\u8282\u6d41\uff0c\u4f46 UTF-8 \u4e0d\u80fd\uff0c\u5b83\u7684\u7f16\u7801\u60c5\u51b5\u53ea\u6709\u4ee5\u4e0b\u56db\u79cd\uff1a</p> <ul> <li>0xxxxxxx</li> <li>110xxxxx 10xxxxxx</li> <li>1110xxxx 10xxxxxx 10xxxxxx</li> <li>11110xxx 10xxxxxx 10xxxxxx 10xxxxxx</li> </ul> <p>\u6240\u4ee5\u5982\u679c\u4e00\u4e2a\u5b57\u7b26\u5f00\u5934\u5c31\u51fa\u73b0\u4e86 10xxxxxx \u8fd9\u6837\u7684\u5b57\u8282\uff0cUTF-8 \u5c31\u4e0d\u77e5\u9053\u8be5\u600e\u4e48\u89e3\u7801\u4e86\u3002\u5176\u4ed6\u60c5\u51b5\u4e5f\u4f1a\u5f15\u8d77 UTF-8 \u89e3\u7801\u9519\u8bef\u3002</p> <p>Python \u5904\u7406\u8fd9\u79cd\u9519\u8bef\u7684\u9ed8\u8ba4\u65b9\u6cd5\u662f\u76f4\u63a5\u629b\u51fa UnicodeDecodeError\uff0c\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u662f\u4e0d\u65b9\u4fbf\u7684\uff0c\u6240\u4ee5\u4e00\u822c\u60c5\u51b5\u7684\u5904\u7406\u65b9\u5f0f\u662f\u9488\u5bf9\u9519\u8bef\u7684\u5b57\u8282\u6d41\u8fdb\u884c\u66ff\u6362\uff0c\u6bd4\u5982\u5c06\u9519\u8bef\u7684\u5b57\u8282\u6d41\u66ff\u6362\u4e3a U+FFFD\uff08\u5373 \ufffd\uff09\uff0c\u8fd9\u4e5f\u662f\u4e00\u4e9b\u53e4\u602a\u4e71\u7801\u7684\u6765\u6e90\u4e4b\u4e00\u3002</p> <p>\u524d\u9762\u63d0\u5230\u4e86 CyberChef \u5e76\u6ca1\u6709\u91c7\u7528\u8fd9\u79cd\u5904\u7406\u65b9\u5f0f\uff0c\u5b83\u5c06\u9519\u8bef\u7684\u5b57\u8282\u4e5f\u89e3\u7801\u4e3a\u4e86\u5176\u4ed6\u5947\u602a\u7684\u5b57\u7b26\uff0c\u8bf7\u4f60\u7814\u7a76\u5176\u4e2d\u7684\u539f\u7406\uff0c\u8fd9\u662f\u4e00\u4e2a bonus\u3002</p>"},{"location":"intro/misc-lab1/#task","title":"Task","text":"<p>\u90a3\u4e48\u603b\u7ed3\u4e00\u4e0b\u4f60\u9700\u8981\u505a\u7684\u4e8b\u60c5\uff1a</p> <ol> <li>\u901a\u8fc7\u4f60\u559c\u6b22\u7684\u65b9\u5f0f\u590d\u73b0\u524d\u9762\u63d0\u5230\u7684\u516d\u79cd\u4e71\u7801\u60c5\u51b5\uff08\u6bcf\u79cd 5 \u5206\uff0c\u5171 30 \u5206\uff09</li> <li>\u56de\u7b54\u4ee5\u4e0b\u95ee\u9898\uff1a<ul> <li>\u5728\u81ea\u884c\u7814\u7a76\u4e86 GB \u7cfb\u5217\u7f16\u7801\u540e\uff0c\u8bf7\u9610\u8ff0 GB \u7cfb\u5217\u662f\u5982\u4f55\u5b9e\u73b0\u4e09\u4e2a\u7248\u672c\u517c\u5bb9\u7684\uff0810 \u5206\uff09</li> <li>\u9488\u5bf9\u516d\u79cd\u4e71\u7801\u60c5\u51b5\uff0c\u54ea\u4e9b\u662f\u4f60\u89c9\u5f97\u53ef\u4ee5\u6062\u590d\u7684\uff0c\u54ea\u4e9b\u662f\u4e0d\u53ef\u4ee5\u6062\u590d\u7684\uff0810 \u5206\uff09<ul> <li>\u8fd9\u91cc\u6211\u4eec\u9ed8\u8ba4\u89e3\u7801\u4e4b\u540e\u540c\u65f6\u7528\u8fd9\u79cd\u7f16\u7801\u65b9\u5f0f\u91cd\u65b0\u7f16\u7801\uff0c\u5e76\u4fdd\u5b58\u5b57\u8282\u6d41\u5230\u6587\u4ef6</li> </ul> </li> <li>\u4e00\u4e2a\u8001\u751f\u5e38\u8c08\u7684\u4e71\u7801\u201c\u951f\u65a4\u62f7\u201d\uff0c\u5b9e\u9a8c\u4e4b\u540e\u4f60\u5e94\u8be5\u4e86\u89e3\u4e86\u5b83\u5230\u5e95\u662f\u600e\u4e48\u4ea7\u751f\u7684\uff0c\u8bf7\u89e3\u91ca\u4e3a\u4ec0\u4e48\u4f1a\u4ea7\u751f\u8fd9\u4e2a\u4e71\u7801\uff0c\u4ee5\u53ca\u4e3a\u4ec0\u4e48\u662f\u8fd9\u4e09\u4e2a\u7279\u5b9a\u7684\u6c49\u5b57\uff0810 \u5206\uff09</li> </ul> </li> <li>bonus\uff1a\u901a\u8fc7\u63a2\u7a76\uff0c\u89e3\u91ca\u6e05\u695a CyberChef \u662f\u600e\u4e48\u5904\u7406 UTF-8 \u89e3\u7801\u9519\u8bef\u7684\uff0810 \u5206\uff09</li> </ol>"},{"location":"intro/misc-lab1/#challenge-1","title":"Challenge 1","text":""},{"location":"intro/misc-lab1/#background_1","title":"Background","text":"<p>\u6211\u4eec\u8bfe\u4e0a\u4ecb\u7ecd\u4e86\u7ef4\u5409\u5c3c\u4e9a\uff08Vigenere\uff09\u5bc6\u7801\uff0c\u8bb0\u660e\u6587\u4e3a \\(\\mathbf{P}\\)\u3001\u5bc6\u6587\u4e3a \\(\\mathbf{C}\\)\u3001\u5bc6\u94a5\u4e3a \\(\\mathbf{k}\\)\uff0c\u5176\u52a0\u89e3\u5bc6\u65b9\u5f0f\u4e3a\uff1a</p> <ul> <li>\u52a0\u5bc6\uff1a\\(\\mathbf{C}_i = (\\mathbf{P}_i + \\mathbf{k}_i) \\bmod 26\\)</li> <li>\u89e3\u5bc6\uff1a\\(\\mathbf{P}_i = (\\mathbf{C}_i - \\mathbf{k}_i) \\bmod 26\\)</li> </ul> <p>\u8fd9\u91cc\u6211\u4eec\u5c06\u5176\u8fdb\u884c\u6269\u5c55\uff0c\u5c06\u5b57\u7b26\u96c6\u4ece 26 \u4e2a\u5b57\u6bcd\u6269\u5c55\u5230 97 \u4e2a\u5b57\u7b26\uff0c\u5e76\u5c06\u52a0\u6cd5\u5bc6\u7801\u6539\u4e3a\u4e58\u6cd5\u5bc6\u7801\uff0c\u5373\uff1a</p> <ul> <li>\u52a0\u5bc6\uff1a\\(\\mathbf{C}_i = (\\mathbf{P}_i \\times \\mathbf{k}_i) \\bmod 97\\)</li> <li>\u89e3\u5bc6\uff1a\\(\\mathbf{P}_i = (\\mathbf{C}_i \\times \\mathbf{k}_i^{-1}) \\bmod 97\\)<ul> <li>\u6ce8\u610f\u8fd9\u91cc \\(\\mathbf{k}_i^{-1}\\) \u662f \\(\\mathbf{k}_i\\) \u5728\u6a21 \\(97\\) \u610f\u4e49\u4e0b\u7684\u9006\u5143\uff0c\u800c\u975e\u76f4\u63a5\u6c42\u5012\u6570</li> </ul> </li> </ul> <p>\u7ef4\u5409\u5c3c\u4e9a\u5bc6\u7801\u7684\u7834\u89e3\u65b9\u6cd5\u6211\u4eec\u5728\u8bfe\u4e0a\u4e5f\u6709\u4ecb\u7ecd\u8fc7\uff0c\u57fa\u672c\u5206\u4e3a\u51e0\u6b65\uff1a</p> <ol> <li>\u7206\u7834\u731c\u6d4b\u5bc6\u94a5\u957f\u5ea6<ul> <li>\u8bfe\u4e0a\u7684\u505a\u6cd5\u662f\u5bfb\u627e\u591a\u6b21\u91cd\u590d\u7684\u5bc6\u6587\uff0c\u8fd9\u91cc\u6709\u4e9b\u590d\u6742\uff0c\u53ef\u4ee5\u9009\u62e9\u53e6\u4e00\u79cd\u65b9\u5f0f</li> <li>\u9488\u5bf9\u6bcf\u79cd\u53ef\u80fd\u7684\u5bc6\u94a5\u957f\u5ea6 \\(k\\)\uff0c\u8ba1\u7b97\u5bc6\u6587\u4e2d\u7b2c \\(i\\) \u4f4d\u548c\u7b2c \\(i+k\\) \u4f4d\u7684\u5b57\u7b26\u91cd\u5408\u4e86\u51e0\u6b21<ul> <li>\u9009\u53d6\u6574\u4f53\u91cd\u5408\u6b21\u6570\u6700\u591a\u7684 \\(k\\) \u5373\u4e3a\u6700\u53ef\u80fd\u7684\u5bc6\u94a5\u957f\u5ea6</li> </ul> </li> </ul> </li> <li>\u9010\u4f4d\u7206\u7834\u5bc6\u94a5<ul> <li>\u786e\u5b9a\u4e86\u5bc6\u94a5\u957f\u5ea6\u4e3a \\(k\\) \u540e\uff0c\u5bc6\u6587\u4e2d \\(i, i+k, i+2k, \\cdots\\) \u4f4d\u7684\u5b57\u7b26\u90fd\u662f\u7528\u540c\u4e00\u4e2a\u5b57\u6bcd\u52a0\u5bc6\u7684\uff0c\u6784\u6210\u4e00\u7ec4\u4e58\u6cd5\u52a0\u5bc6</li> <li>\u4e58\u6cd5\u52a0\u5bc6\u4e0d\u4f1a\u6539\u53d8\u5b57\u7b26\u7684\u7edf\u8ba1\u5206\u5e03\uff0c\u53ef\u4ee5\u901a\u8fc7 26 \u4e2a\u5b57\u6bcd\u7684\u9891\u7387\u5206\u5e03\u6765\u731c\u6d4b\u8be5\u4f4d\u5bc6\u94a5\uff08a \u548c A \u7b97\u4f5c\u540c\u4e00\u4e2a\u5b57\u6bcd\uff0c\u975e\u5b57\u6bcd\u7684\u90fd\u5ffd\u7565\uff09</li> </ul> </li> <li>\u89e3\u5bc6<ul> <li>\u6709\u4e86\u731c\u6d4b\u7684\u5bc6\u94a5\u540e\uff0c\u5c31\u53ef\u4ee5\u5bf9\u5bc6\u6587\u8fdb\u884c\u89e3\u5bc6\u4e86</li> </ul> </li> </ol> <p>\u800c\u6211\u4eec\u6269\u5c55\u540e\u7684\u7ef4\u5409\u5c3c\u4e9a\u5bc6\u7801\u7684\u7834\u89e3\u65b9\u6cd5\u4e5f\u7c7b\u4f3c\uff0c\u901a\u8fc7\u4f60\u559c\u6b22\u7684\u8bed\u8a00\u5b9e\u73b0\u5373\u53ef\u3002\uff08\u63a8\u8350 python\uff0c\u4ee5\u53ca\u6709\u4e86\u81ea\u52a8\u5316\u65b9\u5f0f\u5c31\u4e0d\u8981\u809d\u624b\u63a8\u5566\uff09</p>"},{"location":"intro/misc-lab1/#task_1","title":"Task","text":"<p>\u6211\u4eec\u9009\u53d6\u4e86\u4e00\u4efd TOEFL \u9605\u8bfb\u6587\u7ae0\uff0c\u968f\u673a\u751f\u6210\u4e86 15-30 \u4e2a\u5b57\u7b26\u957f\u5ea6\u7684\u5bc6\u94a5\uff0c\u5e76\u5bf9\u5176\u8fdb\u884c\u4e86\u52a0\u5bc6\uff0c\u73b0\u5c06\u5bc6\u6587\u63d0\u4f9b\u7ed9\u4f60\uff0c\u4e3a\u4e86\u660e\u786e\u52a0\u5bc6\u65b9\u6cd5\u4ee5\u53ca\u7b80\u5355\u719f\u6089 python \u4f7f\u7528\uff0c\u6211\u4eec\u8fd8\u63d0\u4f9b\u4e86\u52a0\u5bc6\u4ee3\u7801\uff0c\u8bf7\u4f60\u5b9e\u73b0\u5bf9\u4e8e\u5bc6\u6587\u7684\u7834\u89e3\uff08flag \u5939\u5728\u4e86\u660e\u6587\u4e2d\u95f4\uff09\u3002</p> <p>\u9644\u4ef6\uff1aencrypt.py\u3001cipher.txt\u3002</p> <p>\u8fd9\u9053\u9898\u76ee\u4e5f\u662f\u6821\u5df4\u4e2d\u7684\u4e00\u9053\u9898\u76ee\uff0c\u9644\u4ef6\u4e5f\u662f\u5b8c\u5168\u4e00\u81f4\u7684\uff08\u9664\u4e86\u4e00\u4e9b\u4ee3\u7801\u683c\u5f0f\u66f4\u6539\uff09\uff0c\u539f\u9898\u94fe\u63a5\u4e3a https://zjusec.com/challenges/31\u3002</p> <p>\u8bf7\u5b9e\u73b0\u5bf9\u7ed9\u5b9a\u5bc6\u6587\u7684\u7834\u89e3\uff0c\u62ff\u5230\u5176\u4e2d\u7684 flag\uff0c\u63d0\u4ea4\u5230\u6821\u5df4\u9898\u76ee\u4e2d\u8fdb\u884c\u9a8c\u8bc1\u3002\u5b9e\u9a8c\u62a5\u544a\u4e2d\u9700\u8981\u5305\u542b\u4f60\u7684\u89e3\u9898\u601d\u8def\u3001\u5b8c\u6574\u89e3\u9898\u4ee3\u7801\u4ee5\u53ca flag\u3002</p> <p>\u5982\u679c\u65e0\u6cd5\u5b8c\u6574\u5b8c\u6210\u89e3\u5bc6\uff0c\u4e5f\u8bf7\u5c06\u4f60\u7684\u5c1d\u8bd5\u5199\u5728\u62a5\u544a\u4e2d\uff0c\u6211\u4eec\u4f1a\u6839\u636e\u5b8c\u6210\u60c5\u51b5\u7ed9\u90e8\u5206\u5206\u3002</p>"},{"location":"intro/misc-lab1/#challenge-2","title":"Challenge 2","text":"<p>\u9009\u505a\u6b64\u9898\u76ee\u9700\u8981\u540c\u65f6\u5b8c\u6210\u4ee5\u4e0b\u4e24\u4e2a\u4efb\u52a1\u3002</p>"},{"location":"intro/misc-lab1/#task-1-tonycranes-easy-osint","title":"Task 1: TonyCrane's easy OSINT","text":"<p>\u8fd9\u662f TonyCrane \u5728\u65e5\u672c\u62cd\u7684\u4e00\u5f20\u7167\u7247\uff08\u8bf7\u4e0b\u8f7d\u56fe\u7247\u540e\u505a\u9898\uff09\uff1a</p> <p></p> <p>\u8bf7\u4f60\u56de\u7b54\u4ee5\u4e0b\u4e24\u4e2a\u95ee\u9898\uff1a</p> <ol> <li>\u62cd\u6444\u8fd9\u5f20\u56fe\u7247\u65f6\u6240\u5728\u4f4d\u7f6e\u7684\u9ad8\u5ea6\u4e3a\u591a\u5c11\uff1f\uff08\u4ee5\u6d77\u5e73\u9762\u4e3a\u57fa\u51c6\uff0c\u5c3d\u53ef\u80fd\u7cbe\u786e\uff09</li> <li>\u62cd\u6444\u8fd9\u5f20\u56fe\u7247\u7684\u65f6\u95f4\u662f\u4ec0\u4e48\u65f6\u5019\uff1f\uff08\u5c3d\u53ef\u80fd\u7cbe\u786e\uff09</li> </ol> <p>\u5c06\u4f60\u7684\u7b54\u6848\u4ee5\u53ca\u89e3\u9898\u601d\u8def\u5199\u5728\u5b9e\u9a8c\u62a5\u544a\u4e2d\u3002\u540c\u6837\uff0c\u6ca1\u6709\u5b8c\u5168\u505a\u51fa\u6765\u4e5f\u53ef\u4ee5\u5199\u51fa\u4f60\u7684\u601d\u8003\uff0c\u6211\u4eec\u4e5f\u4f1a\u8003\u8651\u7ed9\u51fa\u90e8\u5206\u5206\u3002</p>"},{"location":"intro/misc-lab1/#task-2-yyys-real-osint","title":"Task 2: yyy's real OSINT","text":"<p>\u8fd9\u662f yyy \u7528\u624b\u673a\u62cd\u7684\u4e00\u5f20\u7167\u7247\uff08\u8bf7\u4e0b\u8f7d\u56fe\u7247\u540e\u505a\u9898\uff09\uff1a</p> <p></p> <p>\u8bf7\u56de\u7b54\u4ee5\u4e0b\u4e24\u4e2a\u95ee\u9898\uff1a</p> <ul> <li>\u62cd\u6444\u4f4d\u7f6e\u7684\u7ecf\u7eac\u5ea6</li> <li>\u62cd\u6444\u7684\u6708\u4efd\uff0c\u4ee5\u53ca\u662f\u5728\u5f53\u65e5\u51e0\u70b9\u949f\u62cd\u7684</li> </ul> <p>\u8bf7\u901a\u8fc7 http://nc.tonycrane.cc:65111/ \u8fdb\u884c\u56de\u7b54\u5e76\u9a8c\u8bc1\uff08\u8bf7\u4e0d\u8981\u8fdb\u884c\u4efb\u4f55\u5f62\u5f0f\u7684\u7206\u7834\u7b54\u6848\uff09\uff0c\u663e\u793a flag \u5373\u4e3a\u56de\u7b54\u6b63\u786e\u3002\u5c06\u4f60\u7684\u7ed3\u679c\u3001\u56de\u7b54\u622a\u5c4f\u4ee5\u53ca\u89e3\u9898\u601d\u8def\u5199\u5728\u5b9e\u9a8c\u62a5\u544a\u4e2d\u3002\u540c\u6837\uff0c\u6ca1\u6709\u5b8c\u5168\u505a\u51fa\u6765\u4e5f\u53ef\u4ee5\u5199\u51fa\u4f60\u7684\u601d\u8003\uff0c\u6211\u4eec\u4e5f\u4f1a\u8003\u8651\u7ed9\u51fa\u90e8\u5206\u5206\u3002</p>"},{"location":"intro/pwn-lab1/","title":"Pwn Lab 1: Code Injection","text":"<p>\u672c\u8282 Lab \u7531\u4ee5\u4e0b\u4e24\u90e8\u5206\u7ec4\u6210\uff1a</p> <ul> <li>\u57fa\u7840\u90e8\u5206<ul> <li>\u8bfe\u4e0a\u9898\u76ee\u7684\u590d\u73b0 (80\u5206)</li> <li>\u6821\u5df4\u4e0a\u7684 shellcode \u8d5b\u9898 (20\u5206)</li> </ul> </li> <li>bonus\u90e8\u5206 (extra 20\u5206)</li> </ul>"},{"location":"intro/pwn-lab1/#task-1-30-points","title":"Task 1 (30 points)","text":"<p>\u8bfe\u4e0a\u4f5c\u4e3a\u5f15\u5b50\u7684 <code>hello</code> \u8d5b\u9898\uff0c\u8bf7\u901a\u8fc7\u5176\u719f\u6089 pwntools \u7684\u4f7f\u7528\uff0c\u5e76\u5b8c\u6210\u653b\u51fb\u8fdc\u7a0b\uff0c\u53d6\u5f97 flag1 (15 points) \u4e0e flag2 (points)</p> <ul> <li>\u9898\u76ee\u9644\u4ef6</li> <li>\u9898\u76ee\u90e8\u7f72\u5728 IP: <code>116.62.247.145</code>, Port: <code>10100</code></li> </ul> <p>\u8bf7\u5728\u62a5\u544a\u4e2d\u9644\u4e0a\u6f0f\u6d1e\u5206\u6790\u4ee5\u53ca\u505a\u6cd5\uff0c\u7ed9\u51fa\u6210\u529f\u62ff\u5230 flag \u7684\u622a\u56fe\uff0c\u5e76\u5c06\u653b\u51fb\u4ee3\u7801\u4ee5\u9644\u4ef6\u5f62\u5f0f\u4e0a\u4f20</p>"},{"location":"intro/pwn-lab1/#task-2-25-points","title":"Task 2 (25 points)","text":"<p>\u8bfe\u4e0a\u8bb2\u89e3\u7684 <code>injection1</code> \u8d5b\u9898\uff0c\u8bf7\u9006\u5411\u5206\u6790\u7a0b\u5e8f\uff0c\u5e76\u5b9e\u73b0\u5bf9\u5176\u4e2dCode Injection\u6f0f\u6d1e\u7684\u653b\u51fb\uff0c\u53d6\u5f97\u4f4d\u4e8e\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\u7684 flag (25 points)</p> <ul> <li>\u9898\u76ee\u9644\u4ef6</li> <li>\u9898\u76ee\u90e8\u7f72\u5728 IP: <code>116.62.247.145</code>, Port: <code>10101</code></li> </ul> <p>\u8bf7\u5728\u62a5\u544a\u4e2d\u9644\u4e0a\u6f0f\u6d1e\u5206\u6790\u4ee5\u53ca\u505a\u6cd5\uff0c\u7ed9\u51fa\u6210\u529f\u62ff\u5230 flag \u7684\u622a\u56fe\uff0c\u5e76\u5c06\u653b\u51fb\u4ee3\u7801\u4ee5\u9644\u4ef6\u5f62\u5f0f\u4e0a\u4f20</p> <p>\u6ce8\uff1a\u8def\u5f84\u7a7f\u8d8a\u4e0d\u7ed9\u5206\u54e6 :-)</p>"},{"location":"intro/pwn-lab1/#task-3-25-points","title":"Task 3 (25 points)","text":"<p>\u8bfe\u4e0a\u8bb2\u89e3\u7684 <code>injection2</code> \u8d5b\u9898\uff0c\u8bf7\u5b9e\u73b0</p> <ol> <li>\u6309\u9898\u76ee\u8981\u6c42\u5b9e\u73b0 5 \u79cd\u529f\u80fd\u7684 <code>delegate</code> \u4ee3\u7801\uff0c\u5b8c\u6210\u540e\u53d6\u5f97 FLAG (10 points)</li> <li>\u5b66\u4e60 shellcode (5 points) \u5e76\u901a\u8fc7 shellcode \u653b\u51fb\u62ff\u5230\u8fdc\u7a0b\u7684 shell\uff0c\u5e76\u5f97\u5230\u53e6\u5916\u7684 flag \u5185\u5bb9 (10 points)</li> </ol> <ul> <li>\u9898\u76ee\u9644\u4ef6</li> <li>\u9898\u76ee\u90e8\u7f72\u5728 IP: <code>116.62.247.145</code>, Port: <code>10102</code></li> </ul> <p>\u8bf7\u5728\u62a5\u544a\u4e2d\u9644\u4e0a\u6f0f\u6d1e\u5206\u6790\u4ee5\u53ca\u505a\u6cd5\uff0c\u7ed9\u51fa\u5bf9\u4e8e\u4f60\u4f7f\u7528\u7684 shellcode \u4ee3\u7801\u7684\u5206\u6790\uff08\u8fd9\u4e2a\u4ee3\u7801\u5230\u5e95\u5e72\u4e86\u5565\uff09\uff0c\u7ed9\u51fa\u6210\u529f\u62ff\u5230 flag \u7684\u622a\u56fe\uff0c\u5e76\u5c06\u653b\u51fb\u4ee3\u7801\u4ee5\u9644\u4ef6\u5f62\u5f0f\u4e0a\u4f20</p>"},{"location":"intro/pwn-lab1/#task-4-20-points","title":"Task 4 (20 points)","text":"<p>\u4f4d\u4e8e\u6821\u5df4\u7684\u201c\u8d85\u8001\u201d shellcode \u8d5b\u9898\uff0c\u5728\u5b8c\u6210\u4ee5\u4e0a\u7684\u57fa\u7840\u540e\uff0c\u505a\u5b83\u4e00\u5b9a\u662f\u780d\u74dc\u5207\u83dc</p> <ul> <li>\u9898\u76ee\u4fe1\u606f</li> </ul> <p>\u6ce8\uff1a\u8fd9\u4e2a\u9898\u662f 32 \u4f4d\u67b6\u6784\u7684 shellcode \u54e6\uff0c\u4e0d\u8981\u5f04\u9519\u4e86</p> <p>\u8bf7\u5728\u62a5\u544a\u4e2d\u9644\u4e0a\u6f0f\u6d1e\u5206\u6790\u4ee5\u53ca\u505a\u6cd5\uff0c\u7ed9\u51fa\u6210\u529f\u62ff\u5230 flag \u7684\u622a\u56fe\uff0c\u5e76\u5c06\u653b\u51fb\u4ee3\u7801\u4ee5\u9644\u4ef6\u5f62\u5f0f\u4e0a\u4f20</p>"},{"location":"intro/pwn-lab1/#bonus-extra-20-points","title":"Bonus (extra 20 points)","text":"<p>\u5728 Task 3 \u7684\u57fa\u7840\u4e0a\uff0c<code>injection3</code> \u8d5b\u9898\u5bf9\u4e8e\u8f93\u5165\u7684\u4ee3\u7801\u505a\u4e86\u4e00\u4e9b\u9650\u5236\uff0c\u4f60\u8fd8\u80fd\u6210\u529f\u653b\u51fb\u4e48\uff1f\u8bf7\u5b8c\u6210</p> <ol> <li>\u5206\u6790 <code>injection3</code> \u548c <code>injection2</code> \u7684\u4e0d\u540c\uff0c\u5b9e\u73b0\u4e86\u600e\u6837\u7684\u68c0\u67e5\uff1f(5 points)</li> <li>\u7ed5\u8fc7\u8be5\u68c0\u67e5\uff0c\u5b8c\u6210\u8fdc\u7a0b\u5f39 shell\uff0c\u5e76\u53d6\u5f97 flag (15 points)</li> </ol> <ul> <li>\u9898\u76ee\u9644\u4ef6</li> <li>\u9898\u76ee\u90e8\u7f72\u5728 IP: <code>116.62.247.145</code>, Port: <code>10103</code></li> </ul> <p>\u8bf7\u5728\u62a5\u544a\u4e2d\u7ed9\u51fa\u4f60\u7684\u5206\u6790\u7ed3\u679c\uff0c\u5e76\u9644\u4e0a\u6f0f\u6d1e\u5206\u6790\u4ee5\u53ca\u505a\u6cd5\uff0c\u7ed9\u51fa\u6210\u529f\u62ff\u5230 flag \u7684\u622a\u56fe\uff0c\u5e76\u5c06\u653b\u51fb\u4ee3\u7801\u4ee5\u9644\u4ef6\u5f62\u5f0f\u4e0a\u4f20</p>"},{"location":"intro/rev-lab1/","title":"Rev Lab 1: Baby Reverse","text":"<p>\u672c\u8282 Lab \u7531\u4ee5\u4e0b\u4e24\u90e8\u5206\u7ec4\u6210\uff1a</p> <ul> <li>Task 1: \u8bfe\u5802\u4f8b\u9898++\uff0870\u5206\uff09<ul> <li>\u8bfe\u4e0a\u7ec3\u4e60\u9898\u590d\u73b0 (40\u5206)</li> <li>\u4fee\u6539\u540e\u7684\u7ec3\u4e60\u9898 (30\u5206)</li> </ul> </li> <li>Task 2: \u4f2a\u968f\u673a\uff1f\uff0830\u5206\uff09</li> </ul>"},{"location":"intro/rev-lab1/#task-1","title":"Task 1","text":""},{"location":"intro/rev-lab1/#part-1-40-points","title":"Part 1 (40 points)","text":"<p>\u9898\u76ee\u4e0b\u8f7d\u94fe\u63a5</p> <p>\u8bfe\u4e0a\u4f5c\u4e3a\u7ec3\u4e60\u7684 <code>practice</code> \u8d5b\u9898\uff0c\u8bf7\u56de\u987e\u8bfe\u4e0a\u8bb2\u89e3\u7684\u5185\u5bb9\uff0c\u5b8c\u6210\u9898\u76ee\u5e76\u56de\u7b54\u8bfe\u4e0a\u63d0\u51fa\u7684 5 \u4e2a\u95ee\u9898\uff1a</p> <ol> <li>\u5728\u9898\u76ee\u4e2d\u6709\u4e00\u4e2a\u51fd\u6570\u662f\u52a0\u5bc6\u76f8\u5173\u7684\u51fd\u6570\uff0c\u8bf7\u627e\u51fa\u8fd9\u4e2a\u51fd\u6570\u7684\u5730\u5740\uff08Hex \u683c\u5f0f\u4f5c\u7b54\uff0c5 points\uff09</li> <li>\u5f53\u4f60\u627e\u5230\u4e86\u8fd9\u4e2a\u52a0\u5bc6\u51fd\u6570\uff0c\u8bf7\u627e\u51fa\u7a0b\u5e8f\u5728\u52a0\u5bc6\u8fc7\u7a0b\u4e2d\u6240\u4f7f\u7528\u5230\u7684\u5bc6\u94a5 \uff085 points\uff09</li> <li>\u5728\u8fd9\u4e2a\u9898\u76ee\u4e2d\uff0c\u7a0b\u5e8f\u7b80\u5355\u5c01\u88c5\u4e86\u77ed\u5b57\u7b26\u4e32\u7c7b\u578b\uff0c\u8bf7\u5728 IDA \u4e2d\u6062\u590d\u5b83\u7684\u7ed3\u6784\u4f53 \uff08\u622a\u56fe\u6216\u7528 C \u8bed\u8a00\u8868\u793a\u8be5\u7ed3\u6784\uff0c 15 points\uff09</li> <li>\u7ed9\u51fa\u4f60\u89e3\u7b54\u7684 flag \u5185\u5bb9\u53ca Writeup \uff0815 points\uff09</li> </ol>"},{"location":"intro/rev-lab1/#part-2-30-points","title":"Part 2 (30 points)","text":"<p>\u9898\u76ee\u4e0b\u8f7d\u94fe\u63a5</p> <p>\u5728 <code>practice</code> \u8d5b\u9898\u7684\u57fa\u7840\u4e0a\uff0c\u8be5\u9898\u76ee\u7a0d\u6709\u4fee\u6539\uff0c\u8bf7\u4f60\u7a0d\u52a0\u63a2\u7d22\u5b8c\u6210\u9898\u76ee\u5e76\u56de\u7b54\u4ee5\u4e0b\u95ee\u9898\uff1a</p> <ol> <li>\u7a0b\u5e8f\u4e2d\u52a0\u5bc6\u51fd\u6570\u7528\u5230\u7684\u7684\u5bc6\u94a5\u662f\u4ec0\u4e48\uff0c\u4f60\u662f\u5982\u4f55\u627e\u5230\u5b83\u7684\uff0810 points\uff09</li> <li>\u7ed9\u51fa\u4f60\u89e3\u7b54\u7684 flag \u5185\u5bb9\u53ca Writeup\uff0820 points\uff09</li> </ol>"},{"location":"intro/rev-lab1/#task-2","title":"Task 2","text":"<p>\u9898\u76ee\u4e0b\u8f7d\u94fe\u63a5</p> <p>\u770b\u4f3c\u968f\u673a\u5374\u5e76\u4e0d\u968f\u673a\uff0c\u770b\u4f3c\u6a21\u7cca\u5374\u53c8\u6e05\u6670\uff0c\u8bf7\u4f60\u8010\u5fc3\u5206\u6790\u5e76\u63d0\u4ea4\uff1a</p> <ol> <li>flag \u5185\u5bb9\u53ca Writeup (30 points)</li> </ol>"},{"location":"intro/rev-lab1/#hint","title":"Hint","text":"<ul> <li>\u5bf9\u4e8e\u76f8\u540c\u7684\u8f93\u5165\uff0c\u8f93\u51fa\u4e5f\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u4f46\u8fd9\u5e76\u4e0d\u5f71\u54cd\u6211\u4eec\u5bf9 flag \u7684\u6c42\u89e3\uff08flag \u5185\u5bb9\u4e3a\u6709\u610f\u4e49\u7684\u5b57\u7b26\u4e32\uff09</li> </ul>"},{"location":"intro/tools/","title":"\u76f8\u5173\u5de5\u5177\u7684\u4ecb\u7ecd\u548c\u4f7f\u7528","text":"<p>\u6211\u4eec\u5728\u53d1\u5e03\u7684\u865a\u62df\u673a</p> <p>\u4e0b\u8f7d\u94fe\u63a5\uff08\u5176\u4e2d\u7528\u6237\u540d\u4e3a ctfer\uff0c\u5bc6\u7801\u4e3a aaa\uff09</p> <p>\u4e2d\u9884\u88c5\u4e86\u4e00\u4e9b\u8bfe\u7a0b\u4e2d\u53ef\u80fd\u4f1a\u4f7f\u7528\u5230\u7684\u5de5\u5177\uff0c\u8fd9\u91cc\u5c06\u5bf9\u5176\u8fdb\u884c\u5c55\u5f00\u4ecb\u7ecd\u3002\u540c\u5b66\u4eec\u4e5f\u53ef\u4ee5\u6839\u636e\u81ea\u8eab\u9700\u8981\uff0c\u5728\u719f\u6089\u7684\u5e73\u53f0\u4e2d\u4f7f\u7528\u8fd9\u4e9b\u5de5\u5177\u3002</p>"},{"location":"intro/tools/#ida","title":"IDA","text":"<ul> <li>\u5b98\u7f51\uff1ahttps://hex-rays.com/ida-pro/</li> <li>\u4ecb\u7ecd\uff1a\u65e0\u53ef\u4e89\u8bae\u7684\uff0c\u6700\u5f3a\u7684\u9006\u5411\u5de5\u5177\uff5e\u4e8c\u8fdb\u5236\u7a0b\u5e8f F5 \u4e00\u952e\u53d8\u56de\u6e90\u4ee3\u7801</li> <li>\u4f7f\u7528\uff1a\u5728\u9884\u88c5\u7684\u865a\u62df\u673a\u684c\u9762\u53cc\u51fb IDA Freeware 7.6 \u5373\u53ef\uff0c\u542f\u52a8\u6548\u679c\u5982\u4e0b\u56fe\uff0c\u968f\u540e\u5373\u53ef\u901a\u8fc7 <code>New</code> \u9009\u62e9\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u8fdb\u884c\u53cd\u7f16\u8bd1</li> </ul> <p>\u5907\u6ce8\uff1a\u9884\u88c5\u7684 IDA \u662f\u9700\u8981\u8054\u7f51\u4f7f\u7528\u7684\u514d\u8d39\u8bd5\u7528\u7248\uff0c\u5982\u679c\u5b89\u88c5\u5176\u4ed6\u6e20\u9053\u4e0b\u8f7d\u5230\u7684\u7834\u89e3\u7248\uff0c\u8bf7\u6ce8\u610f\u907f\u514d\u4e2d\u6587\u8def\u5f84\u95ee\u9898\u3002</p>"},{"location":"intro/tools/#ssl-server-not-avaliable","title":"\u89e3\u51b3 SSL \u7248\u672c\u8fc7\u9ad8\u5bfc\u81f4\u7684 server not avaliable","text":"<p>\u7531\u4e8e\u9ad8\u7248\u672c ubuntu \u4f7f\u7528\u7684\u662f SSL3+ \u7684\u7248\u672c\uff0c\u5728 IDA \u4e0e\u8fdc\u7aef server \u4f7f\u7528\u65f6\u53ef\u80fd\u4f1a\u51fa\u95ee\u9898\uff0c\u5982\u679c\u4f60\u9047\u5230\u4e86 <code>cloud server not avaliable</code> \u7684\u95ee\u9898\uff0c\u5176\u5173\u952e\u539f\u56e0\u662f SSL3+ \u62ff\u6389\u4e86 <code>SSL_get_peer_certificate</code> \u8fd9\u4e2a\u65b9\u6cd5\uff0c\u89c1\u94fe\u63a5\uff08\u53c8\u662f\u4e0d\u5411\u524d\u517c\u5bb9\u7684\u8bbe\u8ba1\uff09</p> <p>\u4e3a\u4e86\u4fee\u590d\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u65e7\u7248\u672c SSL1.1 \u66ff\u6362\u76ee\u524d\u73af\u5883\u7684 SSL3+\uff0c\u8bf7\u4e0b\u8f7d\u4fee\u590d\u9644\u4ef6\uff0c\u89e3\u538b\u7f29\u540e\u5728\u76ee\u6807\u76ee\u5f55\u6267\u884c <code>fix.sh</code> \u811a\u672c\uff08\u53ef\u80fd\u9700\u8981 <code>sudo</code> \u6743\u9650\uff09\uff0c\u5b8c\u6210\u540e\u518d\u6b21\u6d4b\u8bd5 IDA \u5e94\u8be5\u5c31\u53ef\u4ee5\u6b63\u5e38\u901a\u8fc7 cloud server \u8fdb\u884c F5 \u4e86</p>"},{"location":"intro/tools/#ghidra","title":"ghidra","text":"<ul> <li>\u5b98\u7f51\uff1ahttps://ghidra-sre.org/</li> <li>\u4ecb\u7ecd\uff1a\u5f00\u6e90\u7684\u4e00\u6b3e\u9006\u5411\u5de5\u5177\uff0c\u5728\u5904\u7406\u7279\u5b9a IDA \u4e0d\u5bf9\u4ed8\u7684\u67b6\u6784\u65f6\u53ef\u4ee5\u4f7f\u7528</li> <li>\u4f7f\u7528\uff1a\u5728\u9884\u88c5\u7684\u865a\u62df\u673a\u7684\u547d\u4ee4\u884c\u4e2d\u6267\u884c <code>~/Tools/ghidra_10.3_PUBLIC/ghidraRun</code> \u811a\u672c\u5373\u53ef\u542f\u52a8\uff0c\u6548\u679c\u5982\u4e0b\u56fe\uff0c\u4f7f\u7528\u7684\u6559\u7a0b\u53ef\u4ee5\u627e\u7f51\u4e0a\u7684\u76f8\u5173\u535a\u5ba2\uff0c\u5982\u8fd9\u4e00\u7bc7</li> </ul>"},{"location":"intro/tools/#gef-plugin","title":"gef plugin","text":"<ul> <li>\u5b98\u7f51\uff1ahttps://github.com/hugsy/gef</li> <li>\u4ecb\u7ecd\uff1aLinux \u4e0b gdb \u7684\u4e00\u6b3e\u63d2\u4ef6\uff0c\u4f18\u5316\u8c03\u8bd5\u4f53\u9a8c</li> <li>\u4f7f\u7528\uff1a\u5728\u9884\u88c5\u7684\u865a\u62df\u673a\u4e0b\u6b63\u5e38\u4f7f\u7528 <code>gdb</code> \u5373\u53ef\u4ee5\u770b\u5230\u63d2\u4ef6\u6548\u679c</li> </ul> <p>\u2026\u2026</p> <p>\u9664\u6b64\u5916\u8fd8\u6709\u4e00\u4e9b\u989d\u5916\u7684\u5de5\u5177\uff0c\u8fd9\u4e9b\u5de5\u5177\u4f1a\u540e\u7eed\u8865\u5145\u4ecb\u7ecd\uff0c\u6216\u5728\u8bfe\u7a0b\u4f7f\u7528\u65f6\u4f1a\u989d\u5916\u7ed9\u51fa\u8bb2\u89e3\u3002</p>"},{"location":"intro/web-lab1/","title":"Web Lab 1","text":""},{"location":"intro/web-lab1/#task-1-70","title":"Task 1 (70%)","text":"<p>Implement a DNS rebinder:</p> <ul> <li>resolve normally for common hosts</li> <li>resolve to different ip addresses (A record) in different responses for certain hosts</li> <li>low TTL</li> </ul>"},{"location":"intro/web-lab1/#task-2-30","title":"Task 2 (30%)","text":"<p>Finish the challenge SSRF in SchoolBus (https://zjusec.com/challenges/47)</p> <p>(Using the rebinder in Task 1 is not required)</p>"},{"location":"intro/web-lab1/#what-to-submit","title":"What to submit","text":"<p>For task 1, code with comments (or additional docs) and a running demo.</p> <p>For task 2, your writeup.</p> <p>PDF is recommended.</p>"},{"location":"topic/crypto-lab2/","title":"Crypto Lab 2: AES, RSA &amp; LWE","text":"<p>\u8fd9\u6b21\u4f5c\u4e1a\u7565\u591a\uff0c\u4f46\u57fa\u672c\u4e0a\u90fd\u662f\u8bfe\u4e0a\u8bb2\u8fc7\u7684\u4f8b\u9898\u7684\u5b9e\u73b0\uff0c\u8fd9\u91cc\u7684\u4f5c\u4e1a\u5206\u6570\u5206\u914d\u540e\u7eed\u53ef\u80fd\u4f1a\u6539\u52a8\uff08\u635e\u4eba\uff09\uff0c\u57fa\u7840\u90e8\u5206\u505a\u5b8c\u5c31\u80fd\u6ee1\u5206\uff0c\u62d3\u5c55\u90e8\u5206\u53ef\u4ee5\u52a0\u5206\uff08\u6700\u591a\u672c\u6b21\u8bfe\u52a0\u6ee1\uff09\u3002</p> <p>\u5408\u7406\u89c4\u5212\u57fa\u7840\u90e8\u5206\u548c\u62d3\u5c55\u90e8\u5206\u9898\u76ee\u7684\u9009\u62e9\uff0c\u6709\u4e9b\u62d3\u5c55\u9898\u96be\u5ea6\u4e0d\u89c1\u5f97\u6bd4\u57fa\u7840\u9898\u5927\uff0c\u6bcf\u4e2a\u4eba\u5bf9\u4e0d\u540c\u677f\u5757\u7684\u638c\u63e1\u7a0b\u5ea6\u4e5f\u4e0d\u5c3d\u76f8\u540c\uff0c\u8fd9\u4e5f\u662f\u4e3a\u4e86\u6a21\u62df\u771f\u5b9eCTF\u6bd4\u8d5b\u6709\u9650\u65f6\u95f4\u5185\u8f83\u591a\u9898\u76ee\u7684\u60c5\u666f \uff08\u9009\u9898\u7684\u827a\u672f\uff09\uff0c\u5f53\u7136\u5982\u679c\u771f\u7684\u6709\u80fd\u529b\u5b8c\u6210\u8fd9\u91cc\u7684\u6240\u6709\u9898\u76ee\uff0c\u4f60\u5bf9\u5bc6\u7801\u5b66\u7684\u7406\u89e3\u4f1a\u63d0\u5347\u4e00\u4e2a\u5c42\u6b21\u3002</p> <p>\u5b9e\u9a8c\u9700\u8981\u63d0\u4ea4\u5b9e\u9a8c\u62a5\u544a\u3002\u6bcf\u9053\u505a\u51fa\u6765\u7684\u9898\u5747\u9700\u8981\u5199\u5728\u5b9e\u9a8c\u62a5\u544a\u4e2d\uff0c\u5426\u5219\u65e0\u6cd5\u7ed9\u5206\u3002\u5b9e\u9a8c\u62a5\u544a\u9700\u8981\u5199\u51fa\u6bcf\u9053\u9898\u7684\u601d\u8def\u5e76\u8d34\u4e0a\u653b\u51fb\u811a\u672c\uff08payload\uff09\u3002\u5bf9\u4e8e\u6ca1\u6cd5\u5b8c\u6574\u505a\u51fa\u7684\u9898\uff0c\u4e5f\u53ef\u4ee5\u53d9\u8ff0\u81ea\u5df1\u7684\u601d\u8def\u548c\u89e3\u9898\u8fc7\u7a0b\uff0c\u4f1a\u914c\u60c5\u7ed9\u5206\u3002</p> <p>\u4eca\u5e74\u4ecd\u65e7\u670910\u5206\u7684\u4fdd\u5e95\u5206\uff08\u53ef\u80fd\u4e5f\u4f1a\u8c03\u6574\uff09\uff0c\u53ea\u8981\u63d0\u4ea4\u4f5c\u4e1a\uff0c\u6210\u529f\u505a\u51fa\u4efb\u610f\u4e00\u9898\u5c31\u80fd\u62ff\u5230\uff0c\u4eca\u5e74\u7684\u4fdd\u5e95\u5206\u76f4\u63a5\u52a0\u5230\u6700\u540e\u5206\u6570\u4e2d\uff0c\u56e0\u6b64\u5176\u5b9e\u4f60\u53ea\u9700\u62ff\u523090\u5206\u5c31\u80fd\u6ee1\u4e86\u3002</p> <p>\u672c\u6b21crypto lab\u5bf9python\u4ee5\u53casage\u7684\u8981\u6c42\u4f1a\u6bd4\u8f83\u9ad8\uff0c\u5982\u679c\u8ba4\u4e3a\u81ea\u5df1\u5bf9python\u7684\u4e86\u89e3\u8fd8\u662f\u4e0d\u591f\u7684\u8bdd\uff0c\u8bf7\u52a1\u5fc5\u5584\u7528\u641c\u7d22\u5f15\u64ce\uff0c\u5e76\u79ef\u6781\u5411\u52a9\u6559\u4eec\u63d0\u95ee\uff08\u5bf9\u4e8e\u5bc6\u7801\u5b66\u5e93\u7684\u95ee\u9898\u5c3d\u91cf\u54a8\u8be2\u5bc6\u7801\u5b66\u65b9\u5411\u52a9\u6559\uff0c\u4e0d\u8fc7\u5176\u5b83python\u76f8\u5173\u95ee\u9898\u53ef\u4ee5\u8be2\u95ee\u6240\u6709\u52a9\u6559\uff09</p> <p>\u672c\u6b21\u6240\u6709\u9898\u76ee\u90fd\u5728ZJU::CTF\u5e73\u53f0\u4e2d\u53ef\u4ee5\u67e5\u770b\uff0c\u4e5f\u53ef\u4ee5\u5728\u4e0a\u9762\u63d0\u4ea4flag\u9a8c\u8bc1\u662f\u5426\u6b63\u786e</p> <p>* \u58f0\u660e\uff1a\u7531\u4e8e\u53bb\u5e74\u6284\u88ad\u73b0\u8c61\u8f83\u4e3a\u4e25\u91cd\uff0c\u672c\u6b21\u4f5c\u4e1a\u9664\u4e86AES\u57fa\u7840\u90e8\u5206\u7b2c\u4e00\u9898\u53ef\u4ee5\u5728\u7406\u89e3\u57fa\u7840\u4e0a\u5b8c\u5168\u4f7f\u7528\u4e0a\u8bfe\u6f14\u793a\u7684\u4ee3\u7801\u5916\uff0c\u6240\u6709\u9898\u76ee\u90fd\u4f1a\u8fdb\u884c\u67e5\u91cd\uff0c\u67e5\u5230\u5c31\u4e0d\u4ec5\u4ec5\u662f\u8fd9\u6b21Lab\u5f970\u5206\u4e86\ud83d\ude28</p>"},{"location":"topic/crypto-lab2/#aes-challenge","title":"AES Challenge","text":""},{"location":"topic/crypto-lab2/#basic-task","title":"Basic Task","text":""},{"location":"topic/crypto-lab2/#mission-1-10-points","title":"Mission 1 (10 points)","text":"<p>\u5b8c\u6210 CryptoHack \u4e2d Symmetric Ciphers - How AES works - Bringing It All Together \u8fd9\u4e00\u9898\uff0c\u9898\u76ee\u5df2\u653e\u5728\u538b\u7f29\u5305\u5185\uff0cflag \u683c\u5f0f\u4e3a crypto{xxx}\uff0c\u53ef\u4ee5\u4e0d\u5728 CryptoHack \u4e0a\u63d0\u4ea4\uff08\u4e0a\u8bfe\u90fd\u8bb2\u8fc7\u4e00\u904d\u4e86\uff0cCopy \u4e00\u904d\u90fd\u884c\uff0c\u4e3b\u8981\u662f\u7406\u89e3 AES \u7684\u6574\u4f53\u7ed3\u6784\uff09\u3002</p>"},{"location":"topic/crypto-lab2/#mission-2-20-20-points","title":"Mission 2 (20 + 20 points)","text":"<p>\u5b8c\u6210\u8bfe\u4e0a\u4f8b\u9898 ECB Oracle \u548c CBC Byte Flip\uff0c\u9898\u76ee\u90e8\u7f72\u5728ZJUCTF\u5e73\u53f0\u3002</p>"},{"location":"topic/crypto-lab2/#mission-3-30-points","title":"Mission 3 (30 points)","text":"<p>\u5b8c\u6210\u8bfe\u4e0a\u4f8b\u9898 Padding Oracle\uff0c\u90e8\u7f72\u5728 ZJUCTF \u5e73\u53f0\u4e0a\uff0c\u8fd9\u9053\u9898\u76ee\u96be\u5ea6\u4e5f\u6709\u4e00\u4e9b\uff0c\u672c\u9898\u5206\u503c\u4e3a30\u5206\u3002</p>"},{"location":"topic/crypto-lab2/#extend-task","title":"Extend Task","text":""},{"location":"topic/crypto-lab2/#mission-1-10-10-points","title":"Mission 1 (10 + 10 points)","text":"<p>\u5b8c\u6210 Hackergame 2022 \u9898\u76ee\u4e0d\u53ef\u52a0\u5bc6\u7684\u5f02\u4e16\u754c\u7684\u6539\u8fdb\u7248\u672c\uff08\u539f\u7248\u53ef\u5173\u6ce8Hackergame\u5b98\u65b9GitHub\uff0c\u6539\u8fdb\u7248\u5728\u538b\u7f29\u5305\u5185\uff09\uff0c\u4f53\u4f1a\u4e0d\u540c\u5206\u7ec4\u6a21\u5f0f\u5404\u81ea\u5b58\u5728\u7684\u5b89\u5168\u6027\u95ee\u9898\uff0c\u672c\u9898\u96be\u5ea6\u4f4e\u4e8e Beatboxer\uff0c\u4f46\u7b2c\u4e00\u5c0f\u95ee\u6709 trick\uff08misc\u56de\u987e\uff09\uff0c\u53ef\u4ee5\u5148\u9009\u62e9\u6e38\u73a9\u6b64\u9898\u30fe(\u2022\u03c9\u2022`)o\uff0c\u672c\u9898\u4e5f\u90e8\u7f72\u5728\u4e86 ZJUCTF \u5e73\u53f0\u3002</p>"},{"location":"topic/crypto-lab2/#mission-2-40-points","title":"Mission 2 (40 points)","text":"<p>\u5728CryptoHack\u4e0a\u5b8c\u6210Symmetric Ciphers - Linear Cryptanalysis - Beatboxer\u8fd9\u9053\u9898\uff0c\u4f53\u4f1a\u4e00\u4e0b\u5b8c\u5168\u7ebf\u6027sbox\u5728AES\u52a0\u5bc6\u4e2d\u4f1a\u5bfc\u81f4\u7684\u5de8\u5927\u5b89\u5168\u95ee\u9898\uff0c\u662f\u4e00\u9053\u9002\u5408\u5165\u95e8\u7ebf\u6027\u5206\u6790\u7684\u524d\u7f6e\u95ee\u9898\uff0c\u6ca1\u6709\u60f3\u8c61\u4e2d\u90a3\u4e48\u96be\u3002</p>"},{"location":"topic/crypto-lab2/#rsa-challenge","title":"RSA Challenge","text":""},{"location":"topic/crypto-lab2/#basic-task_1","title":"Basic Task","text":""},{"location":"topic/crypto-lab2/#mission-1-20-points","title":"Mission 1 (20 points)","text":"<p>\u5b8c\u6210\u6821\u5df4\u4e0a\u7684Republican Signature Agency\u8fd9\u9053\u9898\uff0c\u5b66\u4e60RSA\u9009\u62e9\u660e/\u5bc6\u6587\u653b\u51fb\uff0c\u5730\u5740\u4e3a10.214.160.13:12505\u3002</p>"},{"location":"topic/crypto-lab2/#extend-task_1","title":"Extend Task","text":""},{"location":"topic/crypto-lab2/#mission-1-35-points","title":"Mission 1 (35 points)","text":"<p>\u6765\u9053\u7b80\u5355\u7684Coppersmith\u653b\u51fb\u7ec3\u7ec3\u624b\uff0c\u9898\u76ee\u540d\u662fCrush On Proust\uff0c\u9644\u4ef6\u5728\u538b\u7f29\u5305\u5185\uff0c\u5728\u6821\u5df4\u4e0a\u4e5f\u653e\u4e86\u4e00\u4efd\uff0c\u9898\u76ee\u4e0d\u7b97\u592a\u96be\uff0c\u4f46\u5bf9\u6570\u5b66\u8981\u6c42\u8f83\u9ad8\u3002</p>"},{"location":"topic/crypto-lab2/#lwe-challenge","title":"LWE Challenge","text":""},{"location":"topic/crypto-lab2/#extend-task_2","title":"Extend Task","text":""},{"location":"topic/crypto-lab2/#mission-1-20-points_1","title":"Mission 1 (20 points)","text":"<p>\u6765\u70b9CryptoHack\uff0cCryptoHack - Post Quantum - Learning With Errors - Noise Cheap\uff0c\u672c\u9898\u96be\u5ea6\u548c\u57fa\u7840\u9898\u7c7b\u4f3c\uff08\u5982\u679c\u542c\u4e86LWE\u76f8\u5173\u7684\uff09\uff0c\u6240\u4ee5\u4e5f\u6bd4\u8f83\u63a8\u8350\u6765\u770b\u770b\u3002</p>"},{"location":"topic/crypto-lab3/","title":"Crypto Lab 3: ECC &amp; Paillier","text":"<p>\u672c\u8282 lab \u9898\u76ee\u4e3a CryptoHack \u4e0a\u7684\u9898\u76ee\uff0c\u603b\u6570\u8f83\u591a\uff0c\u4f46\u662f\u4e0d\u8981\u6c42\u5168\u90e8\u5b8c\u6210\u3002</p> <p>\u9898\u76ee\u6240\u9700\u7684\u601d\u8def\u591a\u4e3a\u4e0a\u8bfe\u8bb2\u8fc7\u7684\u5185\u5bb9\u3002</p> <p>\u9898\u76ee\u5185\u5bb9\uff1a</p> <ul> <li>CryptoHack \u4e0a\u6240\u6709\u7684\u692d\u5706\u66f2\u7ebf\u5185\u5bb9</li> <li>CryptoHack \u4e0a\u6570\u5b66\u90e8\u5206\u7684 Roll your Own</li> </ul> <p>\u6240\u505a\u9898\u76ee\u8981\u6c42\u63d0\u4f9b\u601d\u8def\u4e0e\u6e90\u7801\uff0c\u9664 BACKGROUND \u548c STARTER \u7684\u90e8\u5206\u4f1a\u8fdb\u884c\u67e5\u91cd\uff08\u8fd9\u4e0d\u610f\u5473\u8fd9\u524d\u4e24\u90e8\u5206\u53ef\u4ee5\u6284\u88ad\uff0c\u4ea6\u4f1a\u8003\u8651\u5bf9\u660e\u663e\u96f7\u540c\u8005\u505a\u5904\u7f5a\uff09QAQ</p> <p>\u53e6\u5916\u8bf7\u9075\u5b88 CryptoHack \u7684\u89c4\u5219\uff0c\u5373\u5bf9\u4e8e Starter \u5206\u533a\u4e0e\u5c0f\u4e8e\u7b49\u4e8e 10pts \u7684\u9898\u76ee\u4ee5\u5916\u7684\u4efb\u4f55\u9898\u76ee\uff0c\u8bf7\u4e0d\u8981\u5728\u516c\u7f51\u4e0a\u516c\u5f00\u5206\u4eab\u76f4\u63a5\u7684\u601d\u8def\u3001\u811a\u672c\u7b49\u5185\u5bb9\u3002</p> <p>\u6240\u5f97\u5206\u6570\u6309\u5728 CryptoHack \u6240\u8bbe\u5b9a\u7684 points \u548c\u7ed9\u51fa\uff0c\u4f1a\u6839\u636e\u5927\u5bb6\u63d0\u4ea4\u7684\u4f5c\u4e1a\u7684 points \u91c7\u7528\u5408\u9002\u7684\u65b9\u5f0f\u6362\u7b97\uff08\u5f53\u7136\uff0c\u4fdd\u8bc1\u6362\u7b97\u51fd\u6570\u505a\u5230 pts \u8d8a\u9ad8\u5219\u5f97\u5206\u8d8a\u9ad8\uff09\u51fa\u6700\u7ec8\u5f97\u5206\u3002</p> <p>\u4e3a\u4e86\u907f\u514d\u5728\u8fd9\u79cd\u8bbe\u5b9a\u4e0b\u5927\u5bb6\u76f8\u4e92\u5377\u6216\u8005\u90fd\u8dd1\u53bb\u505a Lab 2\uff0c\u505a\u51fa\u4ee5\u4e0b\u8bbe\u5b9a\uff1a</p> <ul> <li>\u8fbe\u5230 300pts \u4e00\u5b9a\u662f\u672c\u4e13\u9898 100 \u5206\uff08Basic Task\uff09</li> <li>\u8fbe\u5230 800pts \u4e00\u5b9a\u662f +100 \u5206\uff08Bonus/Extend Task\uff0c\u4e0e Lab 2 \u7684 Bonus \u5f62\u6210\u4e92\u76f8\u6ea2\u51fa\u7684\u5173\u7cfb\uff0cLab 2 \u505a\u5230 200 \u5206\u6216\u672c\u4e13\u9898\u505a\u5230 800pts \u5219 Crypto \u4e13\u9898\u6ee1\u5206\uff0c\u4f46\u7ee7\u7eed\u591a\u505a\u4e0d\u518d\u52a0\u5206\uff1b\u5982\u679c\u4ee5\u524d\u5bf9 Crypto \u4e13\u9898\u7684\u5206\u6570\u6709\u5176\u4ed6\u6a21\u7cca\u7684\u8bbe\u5b9a\uff0c\u4ee5\u6b64\u5904\u8bbe\u5b9a\u4e3a\u51c6\uff09</li> </ul> <p>\u867d\u7136\u4e0d\u52a0\u5206\u4e86\u4f46\u662f\u8fd8\u662f\u9f13\u52b1\u5b8c\u6210\u66f4\u591a\u7684\u9898\u76ee\uff0c\u6bd4\u5982 AK CryptoHack \u5565\u7684\u3002</p> <p>\u8bfe\u4e0a\u8bb2\u7684\u53c8\u5feb\u53c8\u8ff7\u7cca QAQ\uff0c\u53ef\u4ee5\u6162\u6162\u5eb7\u5eb7 CryptoHack \u4e0a\u7684\u4ecb\u7ecd\u9898\u6216\u4e0b\u9762\u7684\u8bb2\u7a3f\u6765\u5b66\u4e60\u76f8\u5173\u77e5\u8bc6\uff1a</p>"},{"location":"topic/crypto-lab3/#_1","title":"\u4ec0\u4e48\u662f\u692d\u5706\u66f2\u7ebf\uff1f","text":"<p>\u5c31\u662f\u6ee1\u8db3</p> \\[ y^2=x^3+ax^2+bx+c \\] <p>\u7684\u70b9 \\((x,y)\\) \u7ec4\u6210\u7684\u96c6\u5408\uff0c\u6ce8\u610f \\(x^3+ax^2+bx+c=0\\) \u9700\u6709 3 \u4e2a\u4e0d\u540c\u89e3\u3002\uff08\u5f53\u7136\uff0c\u692d\u5706\u66f2\u7ebf\u8fd8\u6709\u5176\u4ed6\u5f62\u5f0f\uff0c\u8fd9\u91cc\u662f Weierstrass \u5f62\u5f0f\uff0c\u76f8\u4e92\u95f4\u901a\u8fc7\u5bf9\u5750\u6807\u7684\u7ebf\u6027\u53d8\u5316\u5f97\u5230\u540c\u6001\u6620\u5c04\uff09</p> <p>\u8fd9\u91cc\u7684\u52a0\u6cd5\u5b9a\u4e49\u5728\u4e00\u4e2a\u6709\u52a0\u6cd5\u4ea4\u6362\u7fa4\u5b9a\u4e49\u548c\u4e58\u6cd5\u4ea4\u6362\u7fa4\u5b9a\u4e49\u7684\u57df\u4e0a\uff0c\u5e38\u89c1\u7684\u57df\u6709\u5168\u4f53\u6709\u7406\u6570\u96c6\u5408\u7ec4\u6210\u7684\u57df\uff0c\u901a\u8fc7\u6a21\u4e00\u4e2a\u7d20\u6570\u610f\u4e49\u4e0b\u7684\u8fd0\u7b97\u5b9a\u4e49\u51fa\u52a0\u51cf\u4e58\u9664\u7684\u7d20\u6570\u57df\uff08\u6a21\u6570\u975e\u7d20\u6570\u65f6\uff0c\u9006\u5143\u4e0d\u4e00\u5b9a\u627e\u5f97\u5230\uff0c\u5176\u4e58\u6cd5\u4e5f\u5c31\u4e0d\u518d\u662f\u4e00\u4e2a\u5c01\u95ed\u7684\u7fa4\uff09\u3002</p> <p>Sage \u4e0a\u5b9a\u4e49\u8fd9\u6837\u7684\u66f2\u7ebf\uff08\\(GF(p)\\) \u7b49\u4ef7\u4e8e\u6a21\u7d20\u6570 \\(p\\) \u610f\u4e49\u4e0b\u5b9a\u4e49\u51fa\u6765\u7684\u7d20\u6570\u57df\uff1b\\(GF(p^e)\\) \u53ef\u4ee5\u770b\u4f5c\u6bcf\u4e2a\u7cfb\u6570\u5747\u4e3a\u6a21 \\(p\\) \u610f\u4e49\u4e0b\u7684\uff0c\u4e14\u6574\u4e2a\u591a\u9879\u5f0f\u5904\u4e8e\u6a21\u4e00\u4e2a\u6700\u9ad8\u6b21\u9879\u662f \\(x^e\\) \u7684\u591a\u9879\u5f0f\u7684\u57df\uff09\uff1a</p> <pre><code>\u00a0sage: E = EllipticCurve(GF(10007), [0,2,0,4,5])\nElliptic Curve defined by y^2 = x^3 + 2*x^2 + 4*x + 5 over Finite Field of size 10007\n</code></pre>"},{"location":"topic/crypto-lab3/#_2","title":"\u600e\u6837\u8fd0\u7b97\u692d\u5706\u66f2\u7ebf\uff1f","text":""},{"location":"topic/crypto-lab3/#_3","title":"\u53d6\u8d1f","text":"<p>\u70b9 \\(A=(x,y)\\) \u5219 \\(-A=(x,-y)\\)\u3002</p>"},{"location":"topic/crypto-lab3/#_4","title":"\u52a0\u6cd5","text":"<p>\u4e24\u4e2a\u692d\u5706\u66f2\u7ebf\u4e0a\u7684\u70b9 A,B \u53ef\u4ee5\u5b9a\u4e49\u5176\u52a0\u6cd5\uff0c\u7ed3\u679c\u4e3a \\(C=A+B\\)\u3002</p> <p>\u5f53 \\(A\\neq B\\)(\u9664\\(B=-A\\)\u4ee5\u5916) \u65f6\uff1a</p> <p>\u6613\u89e3\u51fa\u4e24\u70b9\u5904\u5728\u4e00\u76f4\u7ebf \\(y=kx+b\\) \u4e0a\uff0c\u8be5\u76f4\u7ebf\u4e0e\u692d\u5706\u66f2\u7ebf\u7684\u4ea4\u70b9\uff08\u8054\u7acb\u65b9\u7a0b\u5f97\uff09\u6709 3 \u4e2a\uff0c\u5176\u4e2d\u4e24\u4e2a\u662f \\(A,B\\)\uff0c\u6613\u7528\u97e6\u8fbe\u5b9a\u7406\u7b97\u51fa\u53e6\u4e00\u4e2a\u70b9 \\(-C=(x_{-C},y_{-C})\\)\u3002\u5219 \\(C=(x_{-C},-y_{-C})\\)\u3002</p> <p>\u5f53 \\(A= B\\) \u65f6\uff1a</p> <p>\u66f2\u7ebf\u7684\u70b9 \\(A\\) \u7684\u5207\u7ebf\u7684\u659c\u7387 \\(k_A\\)\uff08\u4f60\u53ef\u4ee5\u7528\u539f\u66f2\u7ebf\u6c42\u5bfc\u5f97\u5230\uff09\u4e3a</p> \\[ k=\\frac{3{x_A}^2+2bx_A+d}{2y_A} \\] <p>\u6613\u89e3\u51fa \\(A\\) \u7684\u5207\u7ebf\uff0c\u8be5\u5207\u7ebf\u4e0e\u692d\u5706\u66f2\u7ebf\u7684\u4ea4\u70b9\uff08\u8054\u7acb\u65b9\u7a0b\u5f97\uff09\u6709 3 \u4e2a\uff0c\u5176\u4e2d\u4e24\u4e2a\u662f \\(A,A\\) \u6613\u7528\u97e6\u8fbe\u5b9a\u7406\u7b97\u51fa\u53e6\u4e00\u4e2a\u70b9 \\(-C=(x_{-C},y_{-C})\\)\u3002\u5219 \\(C=(x_{-C},-y_{-C})\\)\u3002</p> <p>\u5f53 \\(B=-A\\) \u65f6\uff1a</p> <p>\u6839\u636e\u524d\u9762\u53d6\u8d1f\u7684\u5b9a\u4e49\uff0c\u6b64\u65f6\u76f4\u7ebf \\(AB\\) \u5728\u66f2\u7ebf\u4e0a\u53ea\u627e\u5230\u4e24\u4e2a\u89e3\u3002</p> <p>\u4f46\u662f\u6ca1\u6709\u5173\u7cfb\uff0c\u6211\u4eec\u53ef\u4ee5\u629b\u5f03\u6b27\u6c0f\u51e0\u4f55\u5bf9\u4e8e\u4e24\u6761\u5e73\u884c\u7ebf\u4e0d\u76f8\u4ea4\u7684\u5047\u8bbe\uff0c\u91c7\u7eb3\u975e\u6b27\u51e0\u4f55\u7684\u89c2\u70b9\uff0c\u8ba4\u4e3a\u4ed6\u4eec\u76f8\u4ea4\u4e8e\u65e0\u7a77\u8fdc\u70b9 \\(\\infin\\)\uff08\u901a\u5e38\uff0c\u4e5f\u8bb0\u4e3a \\(O\\)\uff09\u3002\uff08\u60f3\u8c61\u4e00\u4e0b\uff0c\u4ece\u4efb\u4f55\u4e00\u4e2a\u65b9\u5411\u8fdc\u79bb\u539f\u70b9\u8d70\u65e0\u9650\u8fdc\u7684\u8ddd\u79bb\uff0c\u90fd\u5c06\u5230\u8fbe \\(\\infin\\)\uff09</p> <p>\u56e0\u6b64 \\(\\infin=A+(-A)\\)\u3002</p> <p>\u5f53 \\(A,B\\) \u4e2d\u6709\u4e00\u4e2a\u662f\u65e0\u7a77\u8fdc\u70b9\u65f6\uff1a</p> <p>\u5c06 \\(\\infin=A+(-A)\\) \u79fb\u9879\uff0c\u6709 \\(A+\\infin=A\\)\u3002</p> <p>\u53ef\u89c1\uff0c\u692d\u5706\u66f2\u7ebf\u4e0a\u7684\u52a0\u6cd5\u6784\u6210\u4e00\u4e2a\u7fa4\uff08\u539f\u6765\u7684\u66f2\u7ebf\u7684 \\(x\\) \u6709 3 \u6b21\u4fdd\u8bc1\u6709\u7b2c 3 \u4e2a\u89e3\uff0c\u800c\u975e\u6b27\u51e0\u4f55\u7684 \\(\\infin\\) \u4fdd\u8bc1\u6709\u5355\u4f4d\u5143\uff0c\\(y^2\\) \u4fdd\u8bc1\u6709\u9006\u5143\uff08\\(-A\\)\uff09\uff09\u3002</p> <p>\u6211\u4eec\u9700\u8981\u7684\u662f\u4e00\u4e2a\u5927\u7d20\u6570\u9636\u7684\u5faa\u73af\u7fa4\uff0c\u56e0\u6b64\u9009\u53d6\u4e00\u70b9\u4f5c\u4e3a\u751f\u6210\u5143\uff08\u88ab\u53eb\u505a\u57fa\u70b9 \\(G\\)\uff09\uff0c\u63a5\u4e0b\u6765\u8ba8\u8bba\u7684\u90fd\u5c06\u662f\u8fd9\u4e2a\u751f\u6210\u5b50\u7fa4\u4e0a\u7684\u5143\u7d20\u3002\uff08\u4e8b\u5b9e\u4e0a\uff0c\u692d\u5706\u66f2\u7ebf\u7fa4\u5fc5\u7136\u4e0e\u5faa\u73af\u7fa4\u6216\u8005\u4e24\u4e2a\u5faa\u73af\u7fa4\u7684\u76f4\u548c\u540c\u6784\uff0c\u4e14\u4e00\u822c\u7528\u4e8e\u5bc6\u7801\u5b66\u7684\u692d\u5706\u66f2\u7ebf\u662f\u7b2c\u4e00\u79cd\u60c5\u51b5\uff09</p>"},{"location":"topic/crypto-lab3/#_5","title":"\u4e58\u6cd5","text":"<p>\u6211\u4eec\u5c06 \\(k\\) \u4e2a\u70b9 \\(A\\) \u76f8\u52a0\u7684\u548c\u8bb0\u4f5c \\(kA\\)\uff0c\u53ef\u89c1\uff0c\u5982\u679c\u6211\u4eec\u628a\u692d\u5706\u66f2\u7ebf\u7684\u52a0\u6cd5\u53eb\u201c\u4e58\u6cd5\u201d\uff0c\u90a3\u4e48\u6240\u8c13\u7684 \\(kA\\) \u5c31\u662f \\(A^k\\)\u3002</p> <p>\u53ef\u4ee5\u7528\u53cd\u590d\u5e73\u65b9\u6cd5\uff08\u5feb\u901f\u5e42\uff09\u6765\u7b97\u4e58\u6cd5\u3002</p>"},{"location":"topic/crypto-lab3/#_6","title":"\u9664\u6cd5","text":"<p>\u5b58\u5728\u8ba1\u7b97\u692d\u5706\u66f2\u7ebf\u4e0a\u89e3\u7684\u4e2a\u6570 \\(|E|\\)  \u7684\u7b97\u6cd5\uff0c\u800c\u66f2\u7ebf\u4e0a\u7684\u70b9\u751f\u6210\u7684\u5faa\u73af\u7fa4\u7684\u9636 \\(n\\) \u5fc5\u7136\u662f\u5176\u56e0\u5b50\uff08\u8bb0\u4f59\u56e0\u5b50\u4e3a \\(h=\\frac{|E|}{n}\\)\uff09\uff0c\u56e0\u6b64\u5982\u679c\u80fd\u5c06 \\(|E|\\) \u56e0\u5f0f\u5206\u89e3\uff0c\u90a3\u4e48\u66f2\u7ebf\u7684\u9636\u81ea\u7136\u4e5f\u5c31\u77e5\u6653\u4e86\u3002(Sage\u4e0a\u76f4\u63a5\u6267\u884c <code>E.order()</code> \u5373\u53ef\u6c42\u5f97\u66f2\u7ebf\u4e0a\u70b9\u7684\u6570\u91cf)</p> <p>\u5f53\u9636\u662f\u4e00\u4e2a\u5927\u7d20\u6570 \\(n\\) \u65f6\uff0c\u7531\u4e8e \\((kn+x)G=k\\infin+xG=xG,\\forall k,x\\in \\mathbb{Z}\\)\uff0c\u6240\u4ee5\u5982\u679c\u8fd9\u4e2a\u4e58\u6570\u5728\u6a21 \\(n\\) \u610f\u4e49\u4e0b\u662f\u76f8\u540c\u503c\uff0c\u5219\u4e58\u6cd5\u7684\u7ed3\u679c\u5c31\u76f8\u540c\uff0c\u56e0\u6b64\uff0c\u53ef\u4ee5\u8ba4\u4e3a\u4e58\u6570\u5728 \\(GF(n)\\) \u4e0a\uff0c\u8fdb\u800c\u5b9a\u4e49\u9664\u6cd5 \\(\\frac{G}{x} = (x^{-1})G\\)\uff0c\u5176\u4e2d \\(x^{-1}\\) \u4e3a \\(x\\) \u5728 \\(GF(n)\\) \u4e0a\u7684\u4e58\u6cd5\u9006\u5143\u3002</p>"},{"location":"topic/crypto-lab3/#_7","title":"\u79bb\u6563\u5bf9\u6570\u95ee\u9898","text":"<p>\u5373\u5df2\u77e5 \\(A,kA\\) \u6c42 \\(k\\)\u3002</p> <p>\u5f53\u9636\u4e3a \\(n\\) \u7684\u7fa4\u662f\u4e00\u4e2a\u5faa\u73af\u7fa4\u65f6\uff0c\u5b83\u4e0e\u6a21 \\(n\\) \u610f\u4e49\u4e0b\u7684\u6574\u6570\u52a0\u6cd5\u7fa4\u540c\u6784\u3002\u800c\u6c42\u8fd9\u4e2a\u52a0\u6cd5\u7fa4\u7684\u79bb\u6563\u5bf9\u6570\u662f\u975e\u5e38\u5bb9\u6613\u7684\uff0c\u5f53 \\(ka\\equiv w\\pmod n\\) \u65f6\uff0c\u663e\u7136\u6709\u5176\u201d\u79bb\u6563\u5bf9\u6570\u201c \\(k\\equiv wa^{-1}\\pmod n\\) \u3002\u56e0\u6b64\uff0c\u692d\u5706\u66f2\u7ebf\u52a0\u6cd5\u7fa4\u4e0a\u7684\u70b9\u672c\u8d28\u4e0a\u5bf9\u5e94\u7740\u6a21\u610f\u4e49\u4e0b\u6574\u6570\u52a0\u6cd5\u7fa4\u4e0a\u7684\u4e00\u4e2a\u6570\u5b57\uff0c\u800c\u4e24\u8005\u672c\u8eab\u7684\u52a0\u6cd5\u90fd\u662f\u6613\u6c42\u7684\uff0c\u56f0\u96be\u7684\u662f\u6c42\u5f97\u8fd9\u4e2a\u5bf9\u5e94\u5173\u7cfb\uff08\u4e5f\u5c31\u662f\u540c\u6784\u6620\u5c04\uff09\u3002</p> <p>PS\uff1a\u56e0\u6b64\uff0c\u5f53\u5bf9\u692d\u5706\u66f2\u7ebf\u7684\u7406\u89e3\u6709\u56f0\u96be\u65f6\uff0c\u5b8c\u5168\u53ef\u4ee5\u7c7b\u6bd4\u6a21 n \u610f\u4e49\u4e0b\u7684\u6574\u6570\u52a0\u6cd5\u7fa4\uff08\u53ea\u662f\u4f60\u4e0d\u77e5\u9053\u6bcf\u4e2a\u70b9\u5177\u4f53\u4ee3\u8868\u7684\u54ea\u4e2a\u6570\u5b57\uff09\u3002</p>"},{"location":"topic/crypto-lab3/#hash-to-point","title":"hash-to-point","text":"<p>\u8f93\u5165\u4e00\u4e32\u5185\u5bb9\uff0c\u53ef\u4ee5\u8fd4\u56de\u4e00\u4e2a\u692d\u5706\u66f2\u7ebf\u4e0a\u7684\u70b9\u7684\u54c8\u5e0c\u51fd\u6570\u3002\uff08\u8fd9\u4e2a\u5bc6\u7801\u5b66\u539f\u8bed\u7684\u5173\u952e\u5728\u4e8e\u8fd4\u56de\u7684\u70b9\u5bf9\u4e8e\u57fa\u70b9\u6216\u8005\u5176\u4ed6\u5b83\u6240\u8fd4\u56de\u7684\u70b9\u7684\u79bb\u6563\u5bf9\u6570\u662f\u96be\u4ee5\u8ba1\u7b97\u7684\uff0c\u56e0\u6b64\u4e0d\u80fd\u7528\u4e00\u4e2a hash-to-scalar \u7684\u7b97\u6cd5\u7b97\u51fa\u4e00\u4e2a k\uff0c\u7136\u540e\u8fd4\u56de \\(kG\\)  \u4e86\u4e8b\uff09</p> <p>\u53c2\u8003\u4f8b\u9898\uff1a\u201dhash-to-point\"\u539f\u8bed\u8bef\u7528 PlaidCTF2022 - pressure</p>"},{"location":"topic/crypto-lab3/#_8","title":"\u53cc\u7ebf\u6027\u914d\u5bf9","text":"<p>\u5f53\u66f2\u7ebf\u5b9a\u4e49\u5728 \\(GF(p)\\) \u4e0a\u3001\u66f2\u7ebf\u7fa4\u7684\u9636\u4e3a n \u65f6\uff0c\u6211\u4eec\u5b9a\u4e49\u66f2\u7ebf\u7684\u5d4c\u5165\u5ea6\u6570\u4e3a\u6ee1\u8db3 \\(p^k\\equiv 1\\pmod n\\) \u7684\u6700\u5c0f\u6b63\u6574\u6570 k\u3002\uff08\u5982\u679c\u6a21 n \u610f\u4e49\u4e0b\u7684\u6574\u6570\u4e58\u6cd5\u662f\u4e2a\u7fa4\uff0c\u90a3\u4e48 k \u5c31\u662f\u7531 p \u751f\u6210\u7684\u5b50\u7fa4\u5927\u5c0f\uff09</p> <p>\u53ef\u89c1\uff0c\u8fd9\u73a9\u610f\u4e00\u822c\u662f\u5f88\u5927\u7684\uff0c\u5f53\u5176\u975e\u5e38\u5c0f\u65f6\uff0c\u5982\u4e0b\u4e00\u4e2a\u53cc\u7ebf\u6027\u914d\u5bf9\u662f\u5bb9\u6613\u8ba1\u7b97\u7684\uff1a</p> <p>e(A,B)=C \u5176\u4e2d A \u662f GF(p) \u4e0a\u5b9a\u4e49\u7684\u692d\u5706\u66f2\u7ebf\u4e0a\u7684\u70b9\uff0cB \u662f \\(GF(p^k)\\) \u4e0a\u5b9a\u4e49\u7684\u692d\u5706\u66f2\u7ebf\u4e0a\u7684\u70b9\uff0cC \u662f \\(GF(p^k)\\) \u4e0a\u7684\u503c\u3002</p> <p>\u5b83\u6ee1\u8db3\u53cc\u7ebf\u6027\uff0c\u5373 \\(e(xA,yB)=e(A,B)^{xy},e(A+B,C)=e(A,C)e(B,C),e(A,B+C)=e(A,B)e(A,C)\\)\u3002</p> <p>PS\uff1aBLS \u77ed\u7b7e\u540d\u7b97\u6cd5\uff0cSM9 \u6807\u8bc6\u5bc6\u7801\u7b97\u6cd5\u7b49\u7b97\u6cd5\u4f9d\u8d56\u5b83\uff0c\u6b64\u5916\uff0c\u5b83\u4e5f\u4f7f\u5f97\u5728\u4e00\u4e9b\u60c5\u51b5\u4e0b\u7684\u692d\u5706\u66f2\u7ebf\u6613\u53d7\u653b\u51fb\u3002</p> <p>\u5177\u4f53\u7684\u53cc\u7ebf\u6027\u6620\u5c04\u5b9e\u73b0\u53ef\u4ee5\u53c2\u8003 https://crypto.stanford.edu/pbc/notes/elliptic/weil.html\u3002</p>"},{"location":"topic/crypto-lab3/#_9","title":"\u603b\u7ed3","text":"<p>\u4e0a\u9762\u7684\u5185\u5bb9\u7684\u5177\u4f53\u7ec6\u8282\u5e76\u4e0d\u91cd\u8981\uff0c\u91cd\u8981\u7684\u662f\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a\u5faa\u73af\u7fa4\uff0c\u8fd9\u4e2a\u7fa4\u4e0a\u7684\u8fd0\u7b97\u662f\u5bb9\u6613\u7684\uff0c\u4f46\u662f\u79bb\u6563\u5bf9\u6570\u95ee\u9898\u662f\u56f0\u96be\u7684\u3002</p> <p>\u6b64\u5916\uff0c\u6211\u4eec\u8fd8\u6709\u6709\u8da3\u7684\u53cc\u7ebf\u6027\u914d\u5bf9\u53ef\u4ee5\u505a:)</p>"},{"location":"topic/crypto-lab3/#_10","title":"\u692d\u5706\u66f2\u7ebf\u4e0a\u7684\u516c\u94a5\u5bc6\u7801\u4f53\u5236\u7684\u5e94\u7528\u7b80\u4ecb","text":"<p>\u7531\u4e8e\u79bb\u6563\u5bf9\u6570\u662f\u56f0\u96be\u7684\uff0c\u6211\u4eec\u5b9a\u4e49\u79c1\u94a5 x\uff0c\u516c\u94a5 xG\u3002</p>"},{"location":"topic/crypto-lab3/#_11","title":"\u5bc6\u94a5\u4ea4\u6362","text":"<p>Diffle-Hellman\u5f88\u5bb9\u6613\u4ece GF(p) \u7684\u4e58\u6cd5\u7fa4\u4e0a\u79fb\u5230\u66f2\u7ebf\u7fa4\u4e0a\uff0c\u5373 Alice \u968f\u673a\u9009\u62e9 \\(x_A\\)\uff0c\u53d1\u9001 \\(x_AG\\)\uff0cBob \u9009\u62e9 \\(x_B\\)\uff0c\u53d1\u9001 \\(x_BG\\)\u3002</p> <p>\u800c \\(s=x_A(x_BG)=x_B(x_AG)=s'\\) \u4f5c\u4e3a\u4ea4\u6362\u5230\u7684\u79d8\u5bc6\u3002</p>"},{"location":"topic/crypto-lab3/#_12","title":"\u516c\u94a5\u52a0\u5bc6","text":"<p>\u901a\u8fc7\u5bc6\u94a5\u4ea4\u6362\uff0c\u5bb9\u6613\u5b9a\u4e49\u6b64\u8282\u3002</p> <p>\u53ef\u4ee5\u6ce8\u610f\u5230\uff0c\u53cc\u65b9\u5bc6\u94a5\u4ea4\u6362\u80fd\u591f\u5b9e\u73b0\u516c\u94a5\u52a0\u5bc6\u7b97\u6cd5\uff0c\u5373\u52a0\u5bc6\u8005\u9996\u5148\u968f\u673a\u751f\u6210\u4e00\u4e2a\u79c1\u94a5 p' \u5e76\u7b97\u51fa\u516c\u94a5 P'\uff0c\u7b97\u51fa s=KeyExchange(P,p') \u4f5c\u4e3a\u5bf9\u79f0\u5bc6\u94a5\u6765\u52a0\u5bc6 m \u5f97\u5230 c'\uff0c\u4ee4 c=(c',P')\uff1b\u79c1\u94a5\u6301\u6709\u8005\u7b97\u51fa s=KeyExchange(P',p) \u5e76\u4ee5\u6b64\u6765\u89e3\u5bc6 c' \u5f97\u5230 m\u3002\u692d\u5706\u66f2\u7ebf\u4e0a\u7684\u516c\u94a5\u52a0\u5bc6\u7b97\u6cd5\u5c31\u662f\u8fd9\u6837\u5b9e\u73b0\u7684\u3002 </p>"},{"location":"topic/crypto-lab3/#_13","title":"\u6570\u5b57\u7b7e\u540d","text":"<p>\u4ee5\u4e0b\u4ecb\u7ecd\u6700\u7b80\u5355\u7684 Schnorr \u7b7e\u540d\uff08\u76f8\u6bd4\u4f9d\u8d56\u7684\u5047\u8bbe\u66f4\u591a\u3001\u66f4\u590d\u6742\u7684 ECDSA, SM2 \u7b49\u7b97\u6cd5\u800c\u8a00\uff09\uff1a</p> <p>\u6570\u5b57\u7b7e\u540d\u7684\u672c\u8d28\u662f\uff1a</p> <p>\u7b7e\u540d\u8005\u8981\u5411\u9a8c\u8bc1\u8005\u5c55\u793a\u4e00\u9879\u81ea\u5df1\u62e5\u6709 p \uff08\u201c\u8d85\u80fd\u529b\u201d\uff09\u624d\u80fd\u505a\u5230\u7684\u4e8b\u60c5\uff0c\u540c\u65f6\uff0c\u8fd9\u4e2a\u201c\u5c55\u793a\u201d\u548c m \u5f3a\u76f8\u5173\u3002 </p> <p>\u800c\u7b7e\u540d\u8005\u62e5\u6709\u7684\u6240\u8c13\u201c\u8d85\u80fd\u529b\u201d\u81ea\u7136\u662f\u80fd\u6c42\u89e3 \\(xG\\) \u7684\u79bb\u6563\u5bf9\u6570\u4e86\uff0c\u4f46\u662f\uff0c\u6beb\u65e0\u7591\u95ee\uff0c\u8fd9\u4f1a\u5411\u9a8c\u8bc1\u8005\u66b4\u9732 \\(x\\)\uff0c\u63a5\u4e0b\u6765\u9a8c\u8bc1\u8005\u5c31\u53ef\u4ee5\u53d8\u6210\u79c1\u94a5\u6301\u6709\u8005\u4e86\u3002</p> <p>\u8fd9\u65f6\u6211\u4eec\u6ce8\u610f\u5230\uff0c\u5982\u679c\u5bf9 \\(xG\\) \u505a\u7ebf\u6027\u53d8\u6362\uff0c\u90a3\u4e48\u5b83\u7684\u79bb\u6563\u5bf9\u6570\u7b7e\u540d\u8005\u4ecd\u7136\u80fd\u77e5\u9053\u3002\u4f8b\u5982\uff1a\u7ed9\u51fa \\(c,r\\)\uff0c\u90a3\u4e48 \\(cxG+rG\\) \u7684\u79bb\u6563\u5bf9\u6570\u5c31\u662f \\(cx+r\\)\u3002\u6ce8\u610f\u5230 \\(cxG,xG+rG,cxG+rG\\) \u4e2d\u5982\u679c \\(c,r\\) \u968f\u673a\uff0c\u90a3\u4e48\u4e09\u8005\u7b49\u6982\u7387\u7684\u53d6\u5230\u692d\u5706\u66f2\u7ebf\u7fa4\u4e0a\u7684\u4efb\u610f\u4e00\u70b9\u3002\u90a3\u4e48\u5bf9\u4e8e\u4efb\u610f\u4e00\u70b9\u7684\u79bb\u6563\u5bf9\u6570\uff0c\u81ea\u7136\u6ca1\u6709\u95ee\u9898\uff1f</p> <p>\u4f46\u662f\u5982\u679c\u9a8c\u8bc1\u8005\u77e5\u9053 \\(r,c\\)\uff0c\u90a3\u4e48\u5b83\u7167\u6837\u53ef\u4ee5\u6c42\u51fa \\(x\\)\uff0c\u4e3a\u6b64\u6211\u4eec\u9700\u8981\u786e\u4fdd\u9a8c\u8bc1\u8005\u53ea\u77e5\u9053 \\(rG\\)\uff0c\u800c\u4e0d\u77e5\u9053 \\(r\\)\u3002</p> <p>\u7531\u4e8e\u7b7e\u540d\u8005\u5fc5\u987b\u77e5\u9053 \\(r\\)\uff0c\u90a3\u4e48\u8fc7\u7a0b\u53ef\u4ee5\u662f\u7b7e\u540d\u8005\u968f\u673a\u9009\u53d6 \\(r\\)\uff0c\u53d1\u9001 \\(rG\\) \u7ed9\u5bf9\u65b9\u3002</p> <p>\u90a3\u4e48 \\(c\\) \u5462\uff1f\u5982\u679c\u662f\u7b7e\u540d\u8005\u63d0\u4f9b\u7684\uff0c\u663e\u7136\u5b83\u53ef\u4ee5\u968f\u673a\u9009\u53d6 \\(k\\)\uff0c\u7136\u540e\u4ee4\u6240\u8c13\u7684 \\(rG=kG-cxG\\)\uff0c\u867d\u7136\u7b7e\u540d\u8005\u5e76\u4e0d\u77e5\u9053 \\(x,r\\) \uff0c\u4f46\u663e\u7136\u7b7e\u540d\u8005\u80fd\u56de\u7b54 \\(cxG+rG\\) \u7684\u79bb\u6563\u5bf9\u6570 \\(k\\)\u3002\u56e0\u6b64 \\(c\\) \u5fc5\u987b\u5728\u7ed9\u51fa \\(rG\\) \u540e\u7531\u9a8c\u8bc1\u8005\u751f\u6210\u3002</p> <p>\u6574\u7406\u4e00\u4e0b\uff1a</p> <ol> <li>\u7b7e\u540d\u8005\u544a\u77e5\u672c\u6b21\u7b7e\u540d\u7684\u76f8\u5173\u5bf9\u8c61\u4e3a \\(m\\)\uff1b</li> <li>\u7b7e\u540d\u8005\u968f\u673a\u751f\u6210 \\(r\\) \u53d1\u9001 \\(rG\\)\uff1b</li> <li>\u9a8c\u8bc1\u8005\u968f\u673a\u751f\u6210 \\(c\\)\uff1b</li> <li>\u7b7e\u540d\u8005\u8ba1\u7b97 \\(s=r+cx\\) \u53d1\u9001 \\(s\\)\uff1b\uff08\u6709\u4e9b\u5730\u65b9\u6700\u540e\u4e24\u6b65\u662f\u51cf\u6cd5\uff0c\u4e0d\u5f71\u54cd\u6b63\u786e\u6027\uff09</li> <li>\u9a8c\u8bc1\u8005\u9a8c\u8bc1 \\(sG=rG+cxG\\)\u3002</li> </ol> <p>\u9664\u4e86\u7b2c 5 \u6b65\u4ee5\u5916\uff0c\u524d\u9762\u7684\u6b65\u9aa4\u4e5f\u8981\u9a8c\u8bc1\u8005\u53c2\u4e0e\uff0c\u8fd9\u610f\u5473\u7740\u7b7e\u540d\u8005\u5fc5\u987b\u5728\u6bcf\u6b21\u7b7e\u540d\u65f6\u90fd\u5728\u7ebf\u80fd\u591f\u56de\u7b54\u95ee\u9898\uff1f</p> <p>\u56e0\u6b64\uff0c\u9700\u8981\u5c06\u4ea4\u4e92\u5f0f\u7684\u8bc1\u660e\u8fc7\u7a0b\u53d8\u6362\u6210\u975e\u4ea4\u4e92\u7684\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u88ab\u79f0\u4f5c Fiat-shamir \u53d8\u6362\uff1a</p> <p>\u5373\uff0c\u5c06\u9a8c\u8bc1\u8005\u968f\u673a\u751f\u6210\u7684\u5185\u5bb9\uff0c\u66ff\u6362\u4e3a\u6b64\u524d\u9a8c\u8bc1\u8005\u6536\u5230\u7684\u5185\u5bb9\u8f93\u5165\u5bc6\u7801\u5b66\u5b89\u5168\u54c8\u5e0c\u51fd\u6570\uff08\u6bd4\u5982 SHA256\uff0c\u4e0b\u6587\u7b80\u8bb0\u505a \\(H\\)\uff09\u540e\u7684\u8f93\u51fa\u3002</p> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u7b7e\u540d\u6539\u4e3a\uff1a</p> <ol> <li>\u7b7e\u540d\u8005\u968f\u673a\u751f\u6210 \\(r\\)\uff1b</li> <li>\u7b7e\u540d\u8005\u8ba1\u7b97 \\(c=H(rG,m,xG)\\)\uff1b</li> <li>\u7b7e\u540d\u8005\u8ba1\u7b97 \\(s=r+cx\\) \u53d1\u9001 \\((rG,s)\\)\uff1b\uff08\u6709\u4e9b\u5730\u65b9\u53d1\u9001\u7684\u662f \\((s,c)\\)\uff0c\u4e0d\u5f71\u54cd\u6b63\u786e\u6027\uff09</li> <li>\u9a8c\u8bc1\u8005\u9a8c\u8bc1 \\(sG=rG+H(rG,m,xG)xG\\)\u3002</li> </ol> <p>\u8fd9\u6837\u524d3\u6b65\u5c31\u662f\u6807\u51c6\u7684\u7b7e\u540d\u6b65\u9aa4\uff0c\u6700\u540e\u4e00\u6b65\u5c31\u662f\u6807\u51c6\u7684\u9a8c\u8bc1\u6b65\u9aa4\u4e86\u3002</p>"},{"location":"topic/crypto-lab3/#schnorr","title":"\u9ad8\u7ea7Schnorr\u7b7e\u540d\u7b80\u4ecb","text":""},{"location":"topic/crypto-lab3/#musig","title":"\u591a\u7b7e(MuSig)","text":"<p>\u591a\u7b7e\uff0c\u5373\u591a\u4e2a\u4eba\uff08\u4e00\u4e2a\u7ec4\uff09\u5171\u540c\u5bf9\u4e00\u4e2a\u6d88\u606f\u8868\u793a\u8ba4\u53ef\u3002</p> <p>\u6700\u6734\u7d20\u7684\u591a\u7b7e\u65b9\u6cd5\u662f\uff0c\u6bcf\u4e2a\u4eba\u5404\u81ea\u7b7e\u4e00\u4e2a\u540d\uff0c\u8fd9\u6837\u7b7e\u540d\u7684\u5927\u5c0f\u5c31\u4f1a\u53d8\u5f97\u8f83\u5927\u3002</p> <p>\u4e00\u79cd\u60f3\u6cd5\u662f\uff0c\u7b7e\u540d\u65f6\u5b9e\u9645\u4e0a\u5bf9\u805a\u5408\u516c\u94a5 \\(X=\\sum x_iG\\)\uff0c\u4f5c\u7b7e\u540d\u3002\u4f46\u662f\uff0c\u5982\u679c\u5176\u4e2d\u7b2c j \u4e2a\u4eba\u968f\u673a\u751f\u6210 k \u5e76\u58f0\u79f0\u5b83\u7684\u516c\u94a5\u662f \\(x_jG=kG-\\sum_{i\\neq j} x_iG\\)\u3002\u4ed6\u5c31\u53ef\u4ee5\u81ea\u5df1\u62ff\u7740 k \u5bf9\u66ff\u4ee3\u6574\u4e2a\u7ec4\u6765\u7b7e\u540d\uff08\u8fd9\u79f0\u4f5c\u5bc6\u94a5\u53d6\u6d88\u653b\u51fb\uff09\u3002</p> <p>\u4e00\u79cd\u89e3\u51b3\u65b9\u6cd5\u662f \\(X=\\sum H(x_1G,\\ldots,x_nG,x_iG)x_iG\\) \u91c7\u7528\u7c7b\u4f3c Fiat-shamir \u53d8\u6362\u7684\u601d\u60f3\uff0c\u60f3\u8981\u5bc6\u94a5\u53d6\u6d88\u653b\u51fb\uff0c\u5fc5\u987b\u5148\u5f97\u77e5\u7531 \\(H(\\ldots)\\) \u786e\u5b9a\u7684\u7cfb\u6570\uff0c\u800c\u60f3\u8981\u7b97\u51fa\u8fd9\u4e9b\u7cfb\u6570\uff0c\u5fc5\u987b\u5148\u5f97\u51fa \\(x_jG\\)\u3002</p> <p>\u540c\u65f6\uff0c\u591a\u7b7e\u7684\u8fc7\u7a0b\u4e2d\u8981\u6c42\u4efb\u4f55\u4eba\u4e32\u901a\u90fd\u4e0d\u80fd\u5f97\u5230\u4f59\u4e0b\u4eba\u7684\u5bc6\u94a5\uff0c\u56e0\u6b64\uff0c\u8ba1\u7b97 s \u4e0d\u80fd\u662f\u5171\u4eab\u4e00\u4e2a \\(r\\)\uff0c\u5927\u5bb6\u7ed9\u51fa\u81ea\u5df1\u7684 \\(cx_i\\)\u3002\u800c\u662f\u6bcf\u4eba\u751f\u6210 \\(r_iG\\) \u5e76\u5171\u4eab\uff0c\u7136\u540e\u5927\u5bb6\u7b97\u51fa  \\(rG=\\sum r_iG\\)\uff0c\u636e\u6b64\u6c42\u51fa c\uff0c\u7136\u540e\u6bcf\u4e2a\u4eba\u6c42\u51fa \\(s_i=r_i+cx_i\\)\uff0c\u6c42\u51fa\u7b7e\u540d\u4e2d\u7684 \\(s=\\sum s_i\\)\u3002</p> <p>\u540c\u7406\uff0c\u5927\u5bb6\u5bf9 \\(r_iG\\) \u4e5f\u6709\u53ef\u80fd\u91c7\u53d6\u5bc6\u94a5\u53d6\u6d88\u653b\u51fb\uff0c\u4e3a\u6b64\uff0c\u5927\u5bb6\u9996\u5148\u5206\u4eab \\(H(r_iG)\\)\uff0c\u5168\u6570\u6458\u8981\u6536\u5230\u540e\u518d\u5206\u4eab \\(r_iG\\) \u7684\u540c\u65f6\u9a8c\u8bc1\u6458\u8981\u662f\u5426\u6b63\u786e\u3002</p>"},{"location":"topic/crypto-lab3/#_14","title":"\u79bb\u6563\u5bf9\u6570\u76f8\u7b49\u8bc1\u660e","text":"<p>\u8003\u8651\u5bf9\u4e8e\u7fa4\u4e0a\u4e24\u4e2a\u57fa\u70b9 \\(G,H\\) \u8981\u8bc1\u660e \\(C=xG,D=xH\\) \u7684\u540c\u65f6\u4e0d\u6cc4\u9732 \\(x\\)\uff0c\u4e5f\u53ef\u7528Schnorr\u7b7e\u540d\u8fdb\u884c\u3002</p> <p>\u5176\u6b65\u9aa4\u5982\u4e0b\uff1a</p> <ol> <li>\u7b7e\u540d\u8005\u968f\u673a\u751f\u6210 \\(r\\)\uff1b</li> <li>\u7b7e\u540d\u8005\u8ba1\u7b97 \\(c=H(rG,rH,G,H,C,D)\\)\uff1b</li> <li>\u7b7e\u540d\u8005\u8ba1\u7b97 \\(s=r+cx\\) \u53d1\u9001 \\((rG,rH,s)\\)\uff1b</li> <li>\u9a8c\u8bc1\u8005\u9a8c\u8bc1 \\(c=H(rG,rH,G,H,C,D),sG=rG+cC,sH=rH+cD\\)\u3002</li> </ol> <p>\u8fd9\u91cc\uff0c\u7b7e\u540d\u8005\u540c\u6837\u88ab\u8981\u6c42\u89e3\u7b54\u7ebf\u6027\u53d8\u6362\u540e\u7684\u79bb\u6563\u5bf9\u6570\u95ee\u9898\uff0c\u4e14\u8981\u6c42\u53d8\u6362\u540e\u79bb\u6563\u5bf9\u6570\u76f8\u7b49\u3002</p> <p>\u8fd9\u91cc \\(s,c\\) \u5747\u5171\u7528\uff0c\u56e0\u6b64\u552f\u4e00\u7684\u4f5c\u5f0a\u673a\u4f1a\u6765\u5230\u4e86\u4f2a\u9020 \\(r'H(r'\\neq r)\\) \u5e76\u58f0\u79f0 \\(r'H\\) \u662f \\(rH\\) \u4e0a\uff1b\u4f46\u662f\u4f2a\u9020\u6b63\u786e\u7684 \\(r'H\\) \u9700\u8981\u4e8b\u5148\u5f97\u77e5 \\(c\\)\uff0cFiat-shamir \u53d8\u6362\u4fdd\u8bc1\u4e86\u8fd9\u662f\u96be\u4ee5\u505a\u5230\u7684\u3002</p> <p>\u79bb\u6563\u5bf9\u6570\u76f8\u7b49\u8bc1\u660e\u53ef\u7528\u4e8e\u4e3a\u73af\u7b7e\u540d\u63d0\u4f9b\u53ef\u94fe\u63a5\u6027\uff0c\u5b9e\u73b0\u53ef\u9a8c\u8bc1\u968f\u673a\u51fd\u6570\uff08VRF\uff09\u7b49\u3002</p>"},{"location":"topic/crypto-lab3/#_15","title":"\u73af\u7b7e\u540d","text":"<p>\u8fd9\u91cc\u4ecb\u7ecd\u4e00\u79cd\u88ab\u53eb\u505a\u81ea\u53d1\u533f\u540d\u7ec4\uff08SAG\uff09\u7b7e\u540d\u7684\u73af\u7b7e\u540d\uff0c\u53ef\u89c1\uff0c\u73af\u7b7e\u540d\u662f\u4f60\u81ea\u884c\u9009\u62e9\u548c\u4efb\u610f n-1 \u4e2a\u5176\u4ed6\u516c\u94a5\u7ec4\u6210\u4e00\u4e2a\u7ec4\uff0c\u8fdb\u884c\u7b7e\u540d\uff0c\u800c\u9a8c\u8bc1\u8005\u53ea\u80fd\u786e\u8ba4\u4f60\u662f\u7ec4\u4e2d\u7684\u4e00\u5458\u800c\u4e0d\u77e5\u9053\u4f60\u5177\u4f53\u662f\u7528\u54ea\u4e2a\u516c\u94a5\u5bf9\u5e94\u7684\u79c1\u94a5\u7b7e\u540d\u3002</p> <p>\u8fd9\u901a\u5e38\u7528\u4e8e\u7528\u6237\u9700\u8981\u8bc1\u660e\u81ea\u5df1\u6ee1\u8db3\u67d0\u4e2a\u6027\u8d28\u65f6\uff0c\u627e\u5230\u5176\u4ed6\u82e5\u5e72\u4e2a\u540c\u6837\u6ee1\u8db3\u6027\u8d28\u7684\u8eab\u4efd\u7684\u516c\u94a5\u8fdb\u884c\u73af\u7b7e\u540d\uff0c\u4ece\u800c\u4f7f\u5f97\u7528\u6237\u8bc1\u660e\u81ea\u5df1\u62e5\u6709\u67d0\u4e2a\u6027\u8d28\u7684\u540c\u65f6\u4e0d\u6cc4\u9732\u81ea\u5df1\u7684\u5177\u4f53\u8eab\u4efd\u3002</p> <p>\u53d1\u9001\u7684\u662f \\((s,c)\\) \u7248\u672c\u7684 Schnorr \u7b7e\u540d\u7684\u9a8c\u8bc1\u53ef\u8868\u8ff0\u4e3a\u8ba1\u7b97 \\(c'=H(sG-cxG,m,xG)\\) \u9a8c\u8bc1 \\(c'=c\\)\u3002</p> <p>\u8fd9\u91cc\u6709\u4e00\u4e2a\u5148\u5f97\u77e5\u7684 \\(c\\) \u548c\u57fa\u4e8e\u6b64\u7b97\u51fa\u6765\u7684 \\(c'\\) \u4ed6\u4eec\u201c\u795e\u5947\u201d\u5730\u76f8\u7b49\u4e86\uff0c\u53c8\u6216\u8005\u8bf4\uff0c\\(c\\) \u662f\u4e2a\u5927\u5c0f\u4e3a \\(1\\) \u7684\u201c\u73af\u201d\u3002</p> <p>\u6211\u4eec\u8bb0\u7b2c \\(i\\) \u4e2a\u7ec4\u5458\uff08\u73af\u6210\u5458\uff09\u7684\u516c\u94a5\u4e3a \\(x_iG\\)\u3002</p> <p>\u8ba9\u6211\u4eec\u6269\u5145\u8fd9\u4e2a\u73af\uff0c\u4f7f\u5f97\u9a8c\u8bc1\u8fc7\u7a0b\u53d8\u4e3a \\(\\forall i,c_{i+1}=H(s_{i}G-c_ix_iG,m,x_iG);c_{n+1}=c_1\\)\u3002</p> <p>\u90a3\u4e48\u5982\u4f55\u8fdb\u884c\u7b7e\u540d\u5462\uff1f</p> <p>\u9996\u5148\u6211\u4eec\u8981\u9009\u62e9\u81ea\u5df1\u6df7\u5165\u7684\u662f\u7b2c \\(\\pi\\) \u4e2a\u7ec4\u5458\uff08\u4e0d\u7136\u4e5f\u5c31\u6ca1\u6709\u533f\u540d\u6027\u4e86\uff09\u3002</p> <p>\u7136\u540e\u968f\u673a\u751f\u6210 r\uff0c\u8ba1\u7b97 \\(c_{\\pi+1}=H(rG,m,x_{\\pi}G)\\)\u3002</p> <p>\u7136\u540e\u4f9d\u6b21\u8ba1\u7b97 \\(c_{\\pi+1},\\ldots,c_{n+1}=c_{1},\\ldots,c_{\\pi}\\) \u4e3a \\(c_{i+1}=H(s_{i}G-c_ix_iG,m,x_iG)\\)\uff0c\u5176\u4e2d \\(s_i\\) \u4e3a\u4efb\u9009\u968f\u673a\u6570\u3002</p> <p>\u4ee4 \\(s_{\\pi}=r+cx_{\\pi}\\)\uff0c\u7136\u540e\u53d1\u9001\u7b7e\u540d \\(c_1,s_1,\\ldots,s_n\\)\u3002</p> <p>\u7531\u6b64\uff0c\u5728\u9a8c\u8bc1\u8005\u770b\u6765\uff0c\\(c_1,s_i\\) \u5747\u4e3a\u968f\u673a\u503c\uff0c\u6ca1\u6cd5\u5206\u8fa8\u4f60\u662f\u8c01\uff08\u6216\u8005\u8bf4\uff0c\u5f97\u51fa\u7b7e\u540d\u65f6\u7684\u53d8\u91cf \\(\\pi\\)\uff09\u4e86\u3002</p> <p>\u4e8b\u5b9e\u4e0a\uff0c\u8fd9\u6837\u7684\u73af\u7b7e\u540d\u5177\u6709\u5b8c\u5168\u533f\u540d\u6027\uff0c\u4e5f\u5c31\u662f\u5373\u4f7f\u79bb\u6563\u5bf9\u6570\u96be\u9898\u88ab\u653b\u7834\u4e86\uff0c\u9a8c\u8bc1\u8005\u9020\u51fa\u91cf\u5b50\u8ba1\u7b97\u673a\u4e86\uff0c\u4e43\u81f3\u975e\u786e\u5b9a\u56fe\u7075\u673a\u4e86\uff0c\u9a8c\u8bc1\u8005\u4ecd\u7136\u4e0d\u77e5\u9053\u662f\u8c01\u7b7e\u7684\u540d\u3002</p>"},{"location":"topic/crypto-lab3/#_16","title":"\u4efb\u610f\u7fa4\u4e0a\u79bb\u6563\u5bf9\u6570\u6c42\u89e3\u7b80\u4ecb","text":"<p>\u672c\u8282\u4e0d\u9650\u4e8e\u692d\u5706\u66f2\u7ebf\u7fa4\uff0c\u800c\u53ef\u4ee5\u6269\u5c55\u5230\u4efb\u610f\u7fa4\u3002 </p> <p>\u672c\u8282\u548c\u4e0b\u8282\u9ed8\u8ba4\u7684\u95ee\u9898\u662f\u5df2\u77e5 \\(A,kA\\) \u6c42 \\(k\\)\u3002</p> <p>\u5148\u6765\u590d\u4e60\u4e24\u4e2a\u57fa\u7840\u8bfe\u7684\u7b97\u6cd5\uff1a</p>"},{"location":"topic/crypto-lab3/#bsgs-algorithm","title":"BSGS algorithm","text":"<p>Baby-Step Giant-Step \u662f\u6bcf\u4e2aOIer\u90fd\u8033\u719f\u80fd\u8be6\u7684\u7b97\u6cd5\uff0c\u5bf9\u4e8e\u9636\u4e3a n \u7684\u7fa4\uff0c\u5b83\u53ef\u786e\u5b9a\u5730\u5728 \\(O(\\sqrt{n})\\) \u7684\u65f6\u95f4\u5185\u6c42\u51fa\u4efb\u4e00\u79bb\u6563\u5bf9\u6570\u95ee\u9898\uff0c\u540c\u65f6\u6d88\u8017 \\(O(\\sqrt{n})\\) \u7684\u7a7a\u95f4\u3002\uff08\u4e0e\u4e4b\u76f8\u6bd4\uff0c\u66b4\u529b\u679a\u4e3e\u5bf9\u6570 k \u8017\u65f6 O(n)\uff09</p> <p>\u4e0b\u9762\u8bb0 \\(d=\\lfloor \\sqrt{n}\\rfloor\\)\u3002</p> <p>\u9996\u5148\uff0c\\(\\forall x\\in[0,d]\\) \u8ba1\u7b97 xA \u5e76\u5b58\u5165\u54c8\u5e0c\u8868 T \u4e2d\u3002\uff08Baby-Step\uff09</p> <p>\u679a\u4e3e \\(i\\in [0,\\lfloor\\frac{n}{d}\\rfloor]\\)\uff0c\u8ba1\u7b97 \\(kA-idA\\) \u5e76\u5728 T \u4e2d\u67e5\u627e\uff0c\u5982\u627e\u5230\u79bb\u6563\u5bf9\u6570 x\uff0c\u5219 \\(k=id+x\\)\u3002\uff08Giant-Step\uff09</p>"},{"location":"topic/crypto-lab3/#pohlig-hellman-algorithm","title":"Pohlig-hellman algorithm\uff08\u5149\u6ed1\u66f2\u7ebf\u4e0a\u7684\u653b\u51fb\uff09","text":"<p>\u6211\u4eec\u4e00\u76f4\u5728\u5f3a\u8c03\uff0c\u7fa4\u7684\u9636\u5fc5\u987b\u8981\u6709\u5927\u7d20\u6570\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u4f1a\u53d1\u751f\u4ec0\u4e48\uff08\u8fd9\u6837\u7684\u66f2\u7ebf\u88ab\u79f0\u4f5c\u5149\u6ed1\u66f2\u7ebf\uff09\uff1f</p> <p>\u4ee4\u66f2\u7ebf\u7684\u9636\u7684\u552f\u4e00\u8d28\u56e0\u6570\u5206\u89e3\u5982\u4e0b \\(n=\\prod p_i^{e_i}\\)\u3002</p> <p>\u90a3\u4e48\uff0c\u5982\u679c\u6211\u4eec\u53ef\u4ee5\u6c42\u5f97 \\(\\{x_i\\}\\) \u4f7f\u5f97 \\(x_i\\equiv n\\pmod {p_i^{e_i}}\\) \u90a3\u4e48\uff0c\u6211\u4eec\u603b\u662f\u53ef\u4ee5\u901a\u8fc7\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u6062\u590d n\u3002</p> <p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5148\u6765\u8003\u8651\u6c42\u5f97 \\(x\\equiv n\\pmod {p_i}\\)\uff1a</p> <p>\u4ee4 \\(A'=\\frac{n}{p_i}A,(kA)'={\\frac{n}{p_i}(kA)}\\)\uff0c\u663e\u7136\u6709 \\(k A'=(kA)'\\)\uff0c\u4f46\u662f\uff0c\u7531 \\(A'\\) \u751f\u6210\u7684\u5b50\u7fa4\u7684\u5927\u5c0f\u81f3\u591a\u53ea\u6709 \\(p_i\\)\uff08\u5982\u679c A \u751f\u6210\u5b50\u7fa4\u7684\u5927\u5c0f\u4e3a n\uff0c\u5373 \\(nA=\\infin\\)\uff0c\u90a3\u4e48 \\(p_iA'=\\infin\\) \uff09\u3002</p> <p>\u90a3\u4e48\u5957\u7528\u524d\u9762\u7684\u7b97\u6cd5\uff0c\u6211\u4eec\u53ea\u9700\u8981 \\(O(\\sqrt{p_i})\\) \u7684\u65f6\u95f4\u6c42\u89e3\u79bb\u6563\u5bf9\u6570\u3002</p> <p>\u8fdb\u4e00\u6b65\u5730\uff0c\u4ee4 \\(x'\\equiv n\\pmod{p_i^2}\\)\uff0c\u90a3\u4e48 \\(x'=k\u2019p_i+x\\)\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6c42\u5f97 \\(k'\\in[0,p_i)\\) \u5373\u53ef\u3002</p> <p>\u7c7b\u4f3c\u7684\uff0c\u6211\u4eec\u6c42 \\({\\frac{n}{p_i^2}(kA-xA)}\\) \u76f8\u5bf9 \\(A'\\)  \u7684\u79bb\u6563\u5bf9\u6570\u5373\u53ef\uff0c\u4e5f\u53ea\u9700\u8981 \\(O(\\sqrt{p_i})\\) \u7684\u65f6\u95f4\u3002</p> <p>\u540c\u7406\uff0c\u6211\u4eec\u53ef\u4ee5\u6c42\u51fa \\(x_i\\equiv n\\pmod{p_i^{e_i}}\\)\u3002</p> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u53ea\u82b1\u8d39\u4e86 \\(O(\\sum e_i\\sqrt{p_i})\\) \u7684\u65f6\u95f4\u6c42\u51fa\u4e86\u79bb\u6563\u5bf9\u6570\uff0c\u5f53 n \u4e2d\u6ca1\u6709\u5927\u8d28\u56e0\u5b50\u65f6\uff0c\u8fd9\u5c06\u662f\u81f4\u547d\u7684\u3002</p>"},{"location":"topic/crypto-lab3/#pollards-rho-algorithm","title":"Pollard\u2019s \\(\\rho\\) algorithm","text":"<p>Pollard\u2019s \\(\\rho\\) algorithm \u7b97\u6cd5\u80fd\u5728 \\(O(\\sqrt{n})\\) \u5185\u6d88\u8017 O(1) \u7684\u7a7a\u95f4\u7b97\u51fa\u79bb\u6563\u5bf9\u6570 k\u3002</p> <p>\u5176\u5927\u6982\u539f\u7406\u4e3a\u751f\u6210\u4f2a\u968f\u673a\u5e8f\u5217 \\(a_iA+b_ikA\\)\uff0c\u5f53\u5b58\u5728\u4e24\u4e2a\u5143\u7d20\u76f8\u7b49\u65f6\uff08\u6839\u636e\u751f\u65e5\u653b\u51fb\uff0c\u6b64\u65f6\u5143\u7d20\u4e2a\u6570\u7ea6\u4e3a \\(\\sqrt{n}\\)\uff09\uff0c\u6709\uff1a</p> \\[ a_iA+b_ikA=a_jA+b_jkA\\\\ a_i+b_ik=a_j+b_jk\\\\ k=\\frac{a_i-a_j}{b_j-b_i} \\] <p>\u540c\u65f6\uff0c\u8fd9\u4e5f\u610f\u5473\u7740\u4f2a\u968f\u673a\u5e8f\u5217\u5b58\u5728\u7740\u5927\u5c0f\u4e3a j-i \u7684\u5faa\u73af\u8282\u3002</p> <p>\u5982\u679c\u4ee4\u4f2a\u968f\u673a\u5e8f\u5217\u7684\u4e0b\u4e2a\u5143\u7d20\u7531\u4e0a\u4e2a\u5143\u7d20\u786e\u5b9a(\u5373 \\(x_{i+1}=f(x_i)\\))\uff0c\u90a3\u4e48\u7531Floyd\u7684\u627e\u5faa\u73af\u8282\u7b97\u6cd5\u53ef\u4ee5\u5728 O(1) \u7684\u7a7a\u95f4\u5185\u627e\u5230\u5faa\u73af\u8282\uff1a</p> <p>\u7ef4\u62a4\u4e24\u4e2a\u503c c,d\uff0c\u6bcf\u4e00\u6b65\u4ee4 \\(c\\leftarrow f(c),d\\leftarrow f(f(d))\\)\uff0c\u5219\u7b2c i \u6b65\u65f6 \\(c=x_i,d=x_{2i}\\)\uff0c\u5f53 c=d \u65f6\uff0c\u6709\u5faa\u73af\u8282\u5927\u5c0f\u4e3a i\u3002</p>"},{"location":"topic/crypto-lab3/#pollards-kangaroolambda-algorithm","title":"Pollard\u2019s Kangaroo(Lambda) algorithm","text":"<p>\u63a8\u5e7f\u4e0a\u9762\u7684\u7b97\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230 Pollard\u2019s Kangaroo(lambda) \u7b97\u6cd5\uff0c\u5b83\u80fd\u5728 \\(O(\\sqrt{r-l})\\) \u5185\u6d88\u8017 O(1) \u7684\u7a7a\u95f4\u7b97\u51fa\u5df2\u77e5 \\(k\\in [l,r)\\) \u7684\u79bb\u6563\u5bf9\u6570 k\u3002</p> <p>\u76f4\u63a5\u5728Sage\u8c03\u7528 <code>discrete_log_lambda(kA, A, (lbound, rbound),operation='+')</code> \u5373\u53ef\u6c42\u89e3\uff08\u7531\u4e8e\u692d\u5706\u66f2\u7ebf\u7fa4\u5728Sage\u4e2d\u662f\u52a0\u6cd5\u7fa4\uff0c\u56e0\u6b64\u9700\u8981\u6700\u540e\u4e00\u4e2a\u53c2\u6570\uff0c\u5426\u5219\u9ed8\u8ba4\u5c1d\u8bd5\u4e58\u6cd5\u7fa4\uff09</p> <p>\u5177\u4f53\u539f\u7406\u53c2\u8003\uff1ahttps://en.wikipedia.org/wiki/Pollard%27s_kangaroo_algorithm</p>"},{"location":"topic/crypto-lab3/#_17","title":"\u692d\u5706\u66f2\u7ebf\u4e0a\u79bb\u6563\u5bf9\u6570\u6c42\u89e3\u7b80\u4ecb","text":""},{"location":"topic/crypto-lab3/#_18","title":"\u5947\u5f02\u66f2\u7ebf\u53ca\u5176\u653b\u51fb","text":"<p>\u6211\u4eec\u5728\u672c\u7ae0\u5f00\u5934\u5f3a\u8c03\uff0c\\(x^3+ax^2+bx+c=0\\) \u9700\u6709 3 \u4e2a\u4e0d\u540c\u89e3\uff0c\u4f46\u5982\u679c\u5b83\u6709\u89e3\u76f8\u540c\uff0c\u4f1a\u53d1\u751f\u4ec0\u4e48\uff1f</p> <p>\u66f2\u7ebf \\(y^2 = (x-\\alpha)^3\\)  \u88ab\u79f0\u4f5c cusp\uff0c\u800c\u66f2\u7ebf \\(y^2 = (x-\\alpha)^2(x-\\beta)\\) \u88ab\u79f0\u4f5c node\uff0c\u4ed6\u4eec\u7684\u70b9 \\((\\alpha, 0)\\) \u88ab\u79f0\u4f5c\u5947\u5f02\u70b9\u3002\uff08\u4e24\u79cd\u66f2\u7ebf\u5747\u4e3a\u5947\u5f02\u66f2\u7ebf\uff09</p> <p>\u5bf9\u4e8e node\uff0c\u5b58\u5728\u5982\u4e0b\u540c\u6784\u6620\u5c04\uff0c\u5c06\u4e00\u4e2a\u692d\u5706\u66f2\u7ebf\u4e0a\u7684\u70b9\u6620\u5c04\u5230 GF(p) \u7684\u4e58\u6cd5\u7fa4\u4e2d\u3002</p> \\[ \\begin{array}{rrcl} \\varphi : &amp; E(GF(p))     &amp; \\longrightarrow &amp; GF(p)^{\\times}, \\\\           &amp; (x,y) &amp; \\longmapsto     &amp; \\frac{y + \\sqrt{\\alpha-\\beta}(x-\\alpha)}{y - \\sqrt{\\alpha-\\beta}(x-\\alpha)}. \\end{array} \\] <p>\u63a5\u4e0b\u6765\uff0c\u95ee\u9898\u7b49\u4ef7\u4e8e\u5728 GF(p) \u7684\u4e58\u6cd5\u7fa4\u4e0a\u7684\u79bb\u6563\u5bf9\u6570\u3002</p> <p>\u5bf9\u4e8e cusp\uff0c\u6709\u5c06\u4e00\u4e2a\u692d\u5706\u66f2\u7ebf\u4e0a\u7684\u70b9\u6620\u5c04\u5230 GF(p) \u7684\u52a0\u6cd5\u7fa4\u4e2d\u7684\u540c\u6784\u6620\u5c04\uff1a</p> \\[ \\begin{array}{rrcl} \\varphi : &amp; E(GF(p))     &amp; \\longrightarrow &amp; GF(p)^{+}, \\\\           &amp; (x,y) &amp; \\longmapsto     &amp; \\frac{y}{x-\\alpha}. \\end{array} \\] <p>\u8fd9\u663e\u7136\u6ca1\u6709\u4efb\u4f55\u5b89\u5168\u6027\u53ef\u8a00\u3002</p>"},{"location":"topic/crypto-lab3/#smart-attack","title":"\u5f02\u5e38\u66f2\u7ebf\u653b\u51fb\uff08SMART attack\uff09","text":"<p>\u5f53 n=p \u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u5982\u4e0b\u7684\u540c\u6784\u6620\u5c04\uff0c\u4f7f\u5f97\u66f2\u7ebf\u52a0\u6cd5\u88ab\u6620\u5c04\u5230 GF(p) \u4e0a\u7684\u52a0\u6cd5\uff1a</p> <p>\u9996\u5148\u6211\u4eec\u6269\u5c55\u70b9\u7684\u52a0\u6cd5\uff0c\u70b9\u548c GF(p) \u4e0a\u7684\u6570\u5b57 \\(\\alpha\\) \u5173\u8054\u8d77\u6765\uff0c\u8bb0\u4f5c \\([P,\\alpha]\\)\uff0c\u6b64\u65f6\u70b9\u7684\u52a0\u6cd5\u5b9a\u4e49\u4e3a</p> \\[ [P, \\alpha] \\oplus [Q, \\beta] = [ P + Q, \\alpha + \\beta + slope(P,Q)] \\] <p>\\(slope(P,Q)\\) \u8fd4\u56de\u4e24\u70b9\u6240\u5728\u76f4\u7ebf\u7684\u659c\u7387\uff08P=Q \u65f6\u662f\u70b9\u5728\u692d\u5706\u66f2\u7ebf\u4e0a\u5207\u7ebf\u7684\u659c\u7387\uff09\u3002</p> <p>\u63a5\u4e0b\u6765\u8ba1\u7b97 \\(n[P,0]=[\\infin,\\beta]\\)\uff0c\u4ee4 \\(\\varphi(P) = \\beta\\) \u4f5c\u4e3a\u8fd9\u4e2a\u540c\u6784\u6620\u5c04\u3002</p>"},{"location":"topic/crypto-lab3/#_19","title":"\u65e0\u6548\u66f2\u7ebf\u653b\u51fb","text":"<p>\u5f53\u66f2\u7ebf\u4e0a\u7684\u70b9\u7531\u5176\u4ed6\u4eba\u63d0\u4f9b\u65f6\uff0c\u6211\u4eec\u5fc5\u987b\u8981\u5224\u65ad\u70b9\u662f\u5426\u5728\u66f2\u7ebf\u4e0a\uff0c\u800c\u5982\u679c\u70b9\u5e76\u4e0d\u5728\u66f2\u7ebf\u4e0a\uff0c\u5f53\u6211\u4eec\u5c31\u5f53\u65e0\u4e8b\u53d1\u751f\u5730\u8fdb\u884c\u70b9\u7684\u6570\u4e58\u8fd0\u7b97\uff0c\u6211\u4eec\u5b9e\u9645\u4e0a\u5728\u7b97\u4ec0\u4e48\u4e1c\u897f\uff1f</p> <p>\u4e8b\u5b9e\u4e0a\uff0cWeierstrass\u5f62\u5f0f\u66f2\u7ebf\u7684\u52a0\u6cd5\uff0c\u5e76\u6ca1\u6709\u4efb\u4f55\u8fd0\u7b97\u6709 \\(c\\) \u7684\u53c2\u4e0e\u3002\u5c06\u4f60\u7684\u70b9 \\((x',y')\\) \u5e26\u5165\u66f2\u7ebf\u65b9\u7a0b\u89e3\u51fa \\(c'\\)\uff0c\u4f60\u5b9e\u9645\u4e0a\u5c31\u5728\u4ee5 \\((a,b,c')\\)\u4e3a\u53c2\u6570\u7684\u66f2\u7ebf\u4e0a\u8fd0\u7b97\uff0c\u800c\u8fd9\u6837\u7684\u66f2\u7ebf\u4e0d\u662f\u88ab\u7cbe\u5fc3\u8bbe\u8ba1\u7684\uff0c\u56e0\u6b64\u5f88\u5bb9\u6613\u662f\u5149\u6ed1\u66f2\u7ebf\u3002</p>"},{"location":"topic/crypto-lab3/#_20","title":"\u964d\u7ea7\u66f2\u7ebf\u653b\u51fb","text":"<p>\u800c\u5bf9\u4e8e\u53e6\u4e00\u79cd\u5b9e\u73b0\u4e2d\u5e38\u89c1\u7684\u66f2\u7ebf\u5f62\u5f0f\u2014\u2014Edwards\u66f2\u7ebf\uff0c\u5982\u679c\u4e0d\u6821\u9a8c\u70b9\uff0c\u90a3\u4e48\u5176\u4ed6\u4eba\u53ef\u4ee5\u8f93\u5165 \\((0,y)\\)\uff0c\u6b64\u65f6\u70b9\u7684\u4e58\u6cd5\u6ee1\u8db3\uff1a</p> <p>\\(n(0,y)=(0,y^n)\\)\uff0c\u6362\u8a00\u4e4b\uff0c\u79bb\u6563\u5bf9\u6570\u95ee\u9898\u6765\u5230\u4e86 GF(p) \u4e0a\u3002</p>"},{"location":"topic/crypto-lab3/#_21","title":"\u5b9e\u6570\u57df\u66f2\u7ebf\u79bb\u6563\u5bf9\u6570\u7684\u8ba1\u7b97","text":"<p>\u6211\u4eec\u901a\u5e38\u5728GF(p)\u4e0a\u5b9e\u73b0\u692d\u5706\u66f2\u7ebf\uff0c\u4f46\u662f\uff0c\u5728\u5b9e\u6570\u57df\u4e0a\u5b9e\u73b0\u692d\u5706\u66f2\u7ebf\u7684\u95ee\u9898\u662f\u4ec0\u4e48\uff1f</p> <p>\u5bf9\u4e8e\u5b9e\u6570\u57df\u4e58\u6cd5\u7fa4\u7684\u201c\u79bb\u6563\u201c\u5bf9\u6570\uff0c\u5927\u5bb6\u90fd\u77e5\u9053\u53ef\u4ee5\u901a\u8fc7\u653e\u7f29\u548c\u6cf0\u52d2\u5c55\u5f00\u6765\u8ba1\u7b97\uff0c\u4f46\u5b9e\u6570\u57df\u4e0a\u7684\u692d\u5706\u66f2\u7ebf\u7684\u95ee\u9898\u5219\u6ca1\u6709\u8fd9\u4e48\u5e7f\u4e3a\u4eba\u77e5\uff0c\u751a\u81f3\u5728\u7f51\u4e0a\u80fd\u591f\u627e\u5230\u58f0\u79f0\u901a\u8fc7\u628a\u692d\u5706\u66f2\u7ebf\u7684\u8fd0\u7b97\u6269\u5c55\u5230\u5b9e\u6570\u57df\u7684\u4e09\u6d41\u8bba\u6587\u3002\u800c\u4e8b\u5b9e\u4e0a\u5bf9\u4e8e\u66f2\u7ebf \\(y^2=x^3+ax+b\\)\uff0c\u6211\u4eec\u6709\uff1a</p> \\[ \\begin{array}{rrcl} \\varphi : &amp; E(R)     &amp; \\longrightarrow &amp; R/Z^{+}, \\\\           &amp; (x,y) &amp; \\longmapsto     &amp; \\left\\{ \\begin{array}{rrcl}\\frac{\\int_{x}^{+\\infin}\\frac{dx}{\\sqrt{x^3+ax+b}}}{2\\int_{\\gamma}^{+\\infin}\\frac{dx}{\\sqrt{x^3+ax+b}}} \\pmod 1, &amp;y&gt;0\\\\  1-\\frac{\\int_{x}^{+\\infin}\\frac{dx}{\\sqrt{x^3+ax+b}}}{2\\int_{\\gamma}^{+\\infin}\\frac{dx}{\\sqrt{x^3+ax+b}}} \\pmod 1, &amp;y&lt;0 \\end{array} \\right. \\end{array} \\] <p>\u8fd9\u91cc \\(\\gamma\\) \u4e3a\u65b9\u7a0b \\(x^3+ax+b=0\\) \u7684\u6700\u5927\u5b9e\u6570\u89e3\uff1b\\(R/Z\\)(\u5706\u7fa4) \u4e0a\u7684\u8fd0\u7b97\u53ef\u4ee5\u89c6\u4e3a \\([0,1)\\) \u4e0a\u7684\u6574\u6570\u8fdb\u884c\u52a0\u6cd5\u8fd0\u7b97\uff08\u8fd0\u7b97\u7ed3\u679c\u53ea\u53d6\u5c0f\u6570\u90e8\u5206\uff0c\u5373\\(\\pmod 1\\)\uff09\u3002</p> <p>\u51e0\u4f55\u89e3\u91ca\uff1a</p> <p>\u692d\u5706\u66f2\u7ebf\u7684\u4e24\u7ffc\u8d8b\u5411\u7684\u65e0\u7a77\u8fdc\u70b9\u662f\u540c\u4e00\u4e2a\u70b9\uff0c\u56e0\u6b64\u5c06\u4e24\u7ffc\u8fde\u63a5\u5c31\u8fd1\u4f3c\u4e8e\u4e00\u4e2a\u5706\u3002</p> <p>\u4e00\u79cd\u57fa\u4e8edouble\u7684\u540c\u6001\u6784\u9020\u65b9\u6cd5\u662f\uff1a\uff08\u628a\u5706\u5185\u89d2\u662f0~360\u00b0\u770b\u4f5c0~1\uff0c\u800cy&gt;0\u5219\u5728\u524d0.5\uff0c\u5426\u5219\u5728\u540e0.5\uff0c\u7136\u540edouble\u540e\u770by\u7684\u7b26\u53f7\u5373\u53ef\u786e\u8ba4\u4e0b\u4e00\u4f4d\u662f\u5728\u90a3\u4e2a0.5\u91cc\u7684\u54ea\u4e00\u534a\uff0c\u4ee5\u6b64\u7c7b\u63a8\uff09\u3002</p> <p>\u800c\u79ef\u5206\u65b9\u6cd5\u5728\u51e0\u4f55\u4e0a\u662f\u628a \\(y\\) \u5750\u6807\u53d6\u53cd\u540e\u7edf\u8ba1\u9762\u79ef\u5360\u6bd4\u3002</p> <p>\u5706\u7fa4\u4e0a\u7684\u79bb\u6563\u5bf9\u6570\u53ef\u4ee5\u901a\u8fc7\u683c\u57fa\u89c4\u7ea6\u6c42\u89e3\uff0c\u4f8b\u5982\u5c0f\u6570\u7cbe\u5ea6\u4e3a50\u4f4d\u65f6\uff0c\u95ee\u9898 nA=B \u7684\u79bb\u6563\u5bf9\u6570 n \u5373\u683c\u57fa \\([(10^{50},0),(\\lfloor 10^{50}A\\rfloor,1)]\\) \u4e0e\u5411\u91cf \\((\\lfloor 10^{50}B\\rfloor,0)\\) \u7684CVP\u7684\u7b2c\u4e8c\u4e2a\u503c\u7684\u7edd\u5bf9\u503c\u3002</p>"},{"location":"topic/crypto-lab3/#mov","title":"\u4f4e\u5d4c\u5165\u5ea6\u6570\u7684\u66f2\u7ebf\uff08MOV\u653b\u51fb\uff09","text":"<p>\u4f46\u5d4c\u5165\u5ea6\u6570 k \u8f83\u5c0f\u65f6\uff0c\u4efb\u53d6\u5b9a\u4e49\u5728 \\(GF(p^k)\\) \u4e0a\u7684\u692d\u5706\u66f2\u7ebf\u4e0a\u7684\u4e00\u70b9 Q\uff0c\u8ba1\u7b97 \\(e(A,Q),e(kA,Q)\\)\u3002</p> <p>\u800c \\(e(A,Q)^k=e(kA,Q)\\) \u56e0\u6b64\u95ee\u9898\u8f6c\u79fb\uff08\u540c\u6784\u6620\u5c04\uff09\u5230 \\(GF(p^k)\\) \u4e0a\uff0c\u540e\u8005\u53ef\u4ee5\u91c7\u7528\u6570\u57df\u7b5b\u6cd5\uff08NFS\uff09\u5728\u76f8\u6bd4\u5728\u692d\u5706\u66f2\u7ebf\u4e0a\u66f4\u5bb9\u6613\u5730\u6c42\u51fa\u79bb\u6563\u5bf9\u6570\u3002\uff08\u53ef\u4e0b\u8f7d cado-nfs \u8ba1\u7b97\u79bb\u6563\u5bf9\u6570\uff09</p> <p>\u7531\u6b64\u4e5f\u53ef\u4ee5\u770b\u5230\uff0c\u692d\u5706\u66f2\u7ebf\u4e0a\u7684\u79bb\u6563\u5bf9\u6570\u7684\u56f0\u96be\u6027\u548c\u540c\u6784\u6620\u5c04\u8ba1\u7b97\u7684\u56f0\u96be\u6027\u6709\u7740\u83ab\u5927\u7684\u5173\u7cfb\u3002</p>"},{"location":"topic/crypto-lab3/#_22","title":"\u53cc\u7ebf\u6027\u914d\u5bf9\u5e26\u6765\u7684\u5176\u4ed6\u5a01\u80c1","text":"<p>\u672c\u6587\u5e76\u4e0d\u8be6\u7ec6\u4ecb\u7ecd\u5173\u4e8e\u692d\u5706\u66f2\u7ebf\u56f0\u96be\u6027\u76f8\u5173\u7684\u547d\u9898\uff0c\u9664\u4e86\u692d\u5706\u66f2\u7ebf\u4e0a\u7684\u79bb\u6563\u5bf9\u6570\u95ee\u9898\uff08ECDLP\uff09\u5916\uff0c\u8fd8\u6709 One more discrete logarithm problem\uff08OMDLP\uff09\u7b49\u95ee\u9898\u7684\u56f0\u96be\u6027\u8bba\u8bc1\u8fd9\u4e9b\u5bc6\u7801\u5b66\u7684\u5b89\u5168\u6027\uff0cECDLP\u5982\u679c\u53ef\u89e3\uff0c\u4ed6\u4eec\u4e5f\u4e00\u6837\u53ef\u89e3\uff0c\u4f46\u53cd\u4e4b\u5e76\u4e0d\u4ea6\u7136\u3002</p> <p>\u4f8b\u5982\uff0c\u524d\u8ff0Diffle-Hellman\u5bc6\u94a5\u4ea4\u6362\u76f8\u5173\u5b58\u5728\u4e24\u4e2a\u547d\u9898\uff1a</p> <p>ECCDHP\uff0c\u692d\u5706\u66f2\u7ebf\u4e0a\u7684Diffle-Hellman\u53ef\u8ba1\u7b97\u6027\u95ee\u9898\uff1a\u5373\u7ed9\u5b9a xG,yG \u6c42 xyG\u3002</p> <p>ECDDHP\uff0c\u692d\u5706\u66f2\u7ebf\u4e0a\u7684Diffle-Hellman\u53ef\u5224\u5b9a\u6027\u95ee\u9898\uff1a\u5373\u7ed9\u5b9a xG,yG \u548c A\uff0c\u8bf7\u5224\u65ad A=xyG \u662f\u5426\u6210\u7acb\u3002</p> <p>\u540e\u8005\u5728\u5d4c\u5165\u5ea6\u6570\u4e3a 1 \u7684\u66f2\u7ebf\u4e0a\u663e\u7136\u662f\u6613\u53d7\u5a01\u80c1\u7684\uff0c\u56e0\u4e3a\u6b64\u65f6\u5b58\u5728 GF(p) \u7684\u692d\u5706\u66f2\u7ebf\u4e0a\u4e24\u4e2a\u70b9\u6620\u5c04\u5230 GF(p) \u4e0a\u7684\u53cc\u7ebf\u6027\u6620\u5c04\uff0c\u800c \\(e(xG,yG)=e(G,G)^{xy}=e(xyG,G)\\)\uff0c\u56e0\u6b64\u53ea\u8981\u5224\u65ad e(A,G)=e(xG,yG) \u662f\u5426\u6210\u7acb\u5c31\u8db3\u4ee5\u56de\u7b54\u95ee\u9898\u3002</p> <p>\u6b64\u5916\uff0cWeil\u914d\u5bf9\u6ee1\u8db3 e(X,Y)=1 \u5f53\u4e14\u4ec5\u5f53\u5b58\u5728 \\(aX=bY,a,b\\in \\mathbb{Z}\\)\uff0c\u8fdb\u800c\u53ef\u4ee5\u5224\u65ad\u70b9\u662f\u5426\u5728\u4efb\u4e00\u5faa\u73af\u7fa4\u4e0a\u3002</p>"},{"location":"topic/crypto-lab3/#r","title":"\u6570\u5b57\u7b7e\u540d\u4e2d\u4e0e r \u76f8\u5173\u7684\u653b\u51fb\u7b80\u4ecb","text":"<p>\u672c\u8282\u4e0d\u9650\u4e8e\u692d\u5706\u66f2\u7ebf\u7fa4\u548c Schnorr \u7b7e\u540d\uff0c\u4f8b\u5982 DSA\u3001ECDSA \u7b97\u6cd5\u4e5f\u6613\u53d7\u7c7b\u4f3c\u7684\u653b\u51fb </p>"},{"location":"topic/crypto-lab3/#r_1","title":"r \u91cd\u7528","text":"<p>\u8003\u8651\u7b7e\u540d\u4e2d\u5173\u952e\u7684\u7ebf\u6027\u5f0f\u5b50 \\(s=r+cx\\)\u3002</p> <p>\u4e24\u6b21\u7b7e\u540d\u4e2d\u4f7f\u7528\u4e86\u76f8\u540c\u7684 r\uff0c\u610f\u5473\u7740 \\(s_1=r+c_1x,s_2=r+c_2x\\pmod n\\)  \u800c\u672a\u77e5\u6570\u53ea\u6709 r,x \u56e0\u6b64\u53ef\u4ee5\u8054\u7acb\u65b9\u7a0b\u6c42\u89e3\u3002</p>"},{"location":"topic/crypto-lab3/#r_2","title":"r \u7ebf\u6027\u76f8\u5173","text":"<p>\u8003\u8651\u91c7\u7528\u7ebf\u6027\u540c\u4f59\u968f\u673a\u6570\u751f\u6210\u5668 LCG \uff08\u5047\u8bbe d \u5df2\u77e5\uff09\u6765\u4ea7\u751f\u968f\u673a\u6570 r\uff0c\u90a3\u4e48 l \u6b21\u7b7e\u540d\u7684 r \u6ee1\u8db3</p> <p>\\(r_{i+1}=ar_{i}+b\\pmod d\\)</p> <p>\u540c\u65f6 \\(s_i=r_i+c_ix\\pmod n\\)\u3002</p> <p>\u5bf9\u4e8e l \u6b21\u7b7e\u540d\uff0c\u6211\u4eec\u53ef\u4ee5\u5217 2l-1 \u4e2a\u7b49\u5f0f\uff0c\u542b\u6709 3+l \u4e2a\u672a\u77e5\u91cf\uff0c\u663e\u7136\u5f53 l \u8db3\u591f\u5927\u65f6\uff0c\u6211\u4eec\u5c31\u6709\u673a\u4f1a\u89e3\u51fa\u6240\u6709\u65b9\u7a0b\u3002</p> <p>\u5f53\u7136\uff0c\u9700\u6ce8\u610f\u5230\u8fd9\u4e9b\u6a21\u610f\u4e49\u4e0b\u7684\u7ebf\u6027\u65b9\u7a0b\u7684\u6a21\u6570\u4e0d\u540c\u3002</p> <p>\u8fd9\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u796d\u51fa\u683c\u57fa\u89c4\u7ea6\u5927\u6cd5\uff0c\u5bf9\u4e8e\u7b2c i \u4e2a\u65b9\u7a0b\u4e3a \\(\\sum_{j=1}^{m}a_{i,j}x_j=b_i\\pmod {p_i}\\) \u7684 n \u4e2a\u65b9\u7a0b\u7684\u65b9\u7a0b\u7ec4\uff0c\u6784\u9020\u683c\u57fa\uff1a</p> \\[ \\begin{bmatrix} a_{1,1} &amp; \\cdots &amp; a_{1,m} &amp; p_1 &amp;  &amp;   &amp; b_1 \\\\  \\vdots &amp; \\ddots &amp; \\vdots  &amp;   &amp; \\ddots &amp;   &amp; \\vdots \\\\ a_{n,1} &amp; \\cdots &amp; a_{n,m} &amp;  &amp; &amp; p_n &amp; b_n \\\\ 1 &amp;  &amp;              &amp;  &amp;  &amp;  &amp;   \\\\   &amp; \\ddots &amp;   &amp;   \\\\  &amp;  &amp; 1             &amp;  \\\\ \\end{bmatrix} \\] <p>\u6839\u636e \\(x_i\\) \u53ef\u80fd\u7684\u53d6\u503c\u8303\u56f4\u9002\u5f53\u7f29\u653e\u6b64\u683c\u57fa\u7684\u6bcf\u4e00\u5217\u5411\u91cf\uff0c\u5176CVP\u5373\u4e3a\u524dn\u683c\u5143\u7d20\u4e3a0\uff0c\u540em\u4e2a\u5143\u7d20\u4e3a \\(x_i\\)\uff08\u4e58\u4e0a\u7f29\u653e\u7cfb\u6570\uff09\u7684\u5411\u91cf\u3002</p> <p>\uff08\u5176\u5b9e\u5efa\u8bae\u76f4\u63a5\u8c03\u7528\u6c42\u89e3\u4e0d\u540c\u6a21\u610f\u4e49\u4e0b\u7684\u7ebf\u6027\u65b9\u7a0b\u7ec4\u7684\u677f\u5b50 solvelinmod.py\uff0c\u89c1\u9644\u4ef6\uff0c\u4e3agithub\u516c\u5f00\u5185\u5bb9\uff09</p>"},{"location":"topic/crypto-lab3/#r_3","title":"r \u90e8\u5206\u5df2\u77e5","text":"<p>\u5982\u679c\u6bcf\u6b21\u6211\u90fd\u6cc4\u9732 r \u7684\u4e00\u4e9b\u6bd4\u7279\u5462\uff08\u6bd4\u5982 r \u867d\u7136\u968f\u673a\uff0c\u4f46\u662f\u968f\u673a\u7684\u8303\u56f4\u662f [0,x]\uff0c\u800c \\(x&lt;&lt;n\\) \u5bfc\u81f4\u524d\u51e0\u4f4d\u90fd\u662f 0\uff09\u3002</p> <p>\u90a3\u4e48\uff0c\u6211\u4eec\u7684 \\(r=r_c+r_ss_c\\) \u5176\u4e2d \\(r_c,s_c\\) \u4e3a\u5e38\u6570\uff0c\u800c \\(r_s\\) \u975e\u5e38\u5c0f\u3002</p> <p>\u8003\u8651 \\(s=r+cx\\)\uff0c\u6211\u4eec\u7684\u95ee\u9898\u5c06\u4f1a\u8f6c\u6362\u4e3a\u5982\u4e0b\u7684\u95ee\u9898\uff08Hidden number problem\uff0cHNP\uff09\uff1a</p> <p>\u5373\u6c42\u89e3\u7b2c i \u4e2a\u65b9\u7a0b\u4e3a \\(x_i-t_iy+a_i\\equiv 0\\pmod p\\) \u7684 m \u4e2a\u65b9\u7a0b\u7684\u65b9\u7a0b\u7ec4\uff0c\u5176\u4e2d \\(p,a_i,t_i\\) \u5df2\u77e5\uff0c\u4e14 \\(x_i\\) \u975e\u5e38\u5c0f(\u5c0f\u4e8e B)\u3002</p> <p>\u201d\u975e\u5e38\u5c0f\u201c\u8981\u7d20\u5bdf\u89c9\uff0c\u5feb\u53bb\u897f\u5929\u8bf7\u683c\u57fa\u89c4\u7ea6\uff1a</p> \\[ \\begin{bmatrix} p \\\\ &amp; p \\\\ &amp; &amp; \\ddots \\\\ &amp; &amp; &amp; p \\\\ t_1 &amp; t_2 &amp; \\cdots &amp; t_m &amp; B/p \\\\ a_1 &amp; a_2 &amp; \\cdots &amp; a_m &amp; &amp; B \\end{bmatrix} \\] <p>\u8fd9\u91cc\u6bcf\u884c\u4e3a\u4e00\u5411\u91cf\uff0c\u5176CVP\u4e3a  \\((-x_1,-x_2,..,-x_m,-By/p, B)\\)\u3002</p> <p>\u53ef\u89c1\uff0c\u683c\u57fa\u89c4\u7ea6\u662f\u6c42\u7ebf\u6027\u3001\u89e3\u975e\u5e38\u5c0f\u7684\u65b9\u7a0b\u7ec4\u7684\u5229\u5668\u3002</p>"},{"location":"topic/crypto-lab3/#paillier","title":"Paillier \u540c\u6001\u52a0\u5bc6","text":""},{"location":"topic/crypto-lab3/#_23","title":"\u57fa\u7840","text":""},{"location":"topic/crypto-lab3/#_24","title":"\u52a0\u6cd5\u540c\u6001","text":"<p>\u5bf9\u6570\u7684\u52a0\u6cd5\u5373\u5e42\u6b21\u7ed3\u679c\u7684\u4e58\u6cd5\u3002\u4ee4\u5bf9\u6570\u4e3a\u5bc6\u6587\uff0c\u5219\u6709 \\(g^{m_1}g^{m_2}=g^{m_1+m_2}\\)\u3002\uff08\u539f\u6587 m\uff0c\u5bc6\u6587 \\(g^{m}\\)\uff09</p> <p>\u73b0\u5728\u7684\u95ee\u9898\u662f\uff0c\u89e3\u5bc6\u9700\u8981\u6709\u4eba\u4f1a\u505a\u79bb\u6563\u5bf9\u6570\uff0c\u800c\u4e14\u8981\u6c42\u6070\u597d\u662f\u79c1\u94a5\u62e5\u6709\u8005\u4f1a\u505a\uff0c\u5176\u4ed6\u4eba\u4e0d\u4f1a\u505a\u3002</p> <p>\u6bd4\u5982\u8bf4\uff0c\u5bf9\u4e8e\u5149\u6ed1\u5408\u6570\u9636\u7fa4\u7684\u79bb\u6563\u5bf9\u6570\u95ee\u9898\uff0c\u53ef\u4ee5\u7528Pollard rho\u3001Pollard lambda\u3001BSGS\u3001Pohlig Hellmen\u89e3\u51b3\uff0c\u4f46\u662f\uff0c\u6beb\u65e0\u7591\u95ee\u5730\uff0c\u95ee\u9898\u53d8\u6210\u4e86\u6240\u6709\u4eba\u90fd\u53ef\u4ee5\u89e3\u51b3\u3002</p>"},{"location":"topic/crypto-lab3/#_25","title":"\u89e3\u51b3\u7279\u5b9a\u60c5\u5f62\u7684\u79bb\u6563\u5bf9\u6570\u95ee\u9898","text":"<p>\u4e00\u4e2a\u5c06\u5728\u6a21\u5e73\u65b9\u4e58\u6cd5\u7fa4\u4e0a\u7684\u79bb\u6563\u5bf9\u6570\u8f6c\u4e3a\u4e58\u6cd5\u7684\u795e\u5947\u6280\u5de7\uff08\u4ed4\u7ec6\u8003\u8651\\(\\pmod{p^2}\\) \u610f\u5473\u7740\u4ec0\u4e48\u5373\u53ef\u5f97\u5230\uff09 \uff1a</p> <p>p \u662f\u7d20\u6570\u3002\u6839\u636e\u6b27\u62c9\u5b9a\u7406\uff0c\\(\\phi(p^2)=p(p-1),\\phi(p)=p-1\\)</p> <p>\u5bf9\u4e8e\u4efb\u610f\u6570 g\uff0c\\(g^{p-1}=1\\pmod p\\)\uff0c\u6362\u8a00\u4e4b \\(g^{p-1}=kp+1\\)\u3002</p> <p>\u5bf9\u4e8e\u6240\u6709\u6574\u6570\u6210\u7acb\u7684\u5f0f\u5b50\u5bf9\u4e8e\u6a21\u4efb\u610f\u6570\u4e5f\u6210\u7acb\uff0c\u56e0\u6b64 \\(g^{p-1}\\equiv kp+1\\pmod{p^2}\\)</p> <p>\u800c \\((kp+1)^m\\equiv mkp+1\\pmod{p^2}\\) \u6ce8\u610f\u4e8c\u9879\u5f0f\u5b9a\u7406\uff0c\u4e14\u66f4\u5927\u7684\u9879\u90fd\u88ab\\(p^2\\)\u6a21\u6389\u4e86\u3002</p> <p>\u5b9a\u4e49 \\(L_p(x)=\\frac{x-1}{p}\\)\u3002\u8bf7\u6ce8\u610f\uff0c\\(L_p\\) \u7684\u8f93\u5165\u662f\u5728\\(\\pmod{p^2}\\) \u4e0b\u7684\uff0c\u800c\u8f93\u51fa\u662f\u5728\\(\\pmod p\\) \u4e0b\u7684\u3002</p> <p>\u90a3\u4e48 \\(L_p((kp+1)^m)=L_p(mkp+1)=mk\\pmod p\\)\u3002\u5c06\u5f0f\u5b50\u5de6\u4fa7\u6210 k \u5728\u6a21 p \u4e0b\u7684\u9006\u5143\u5373\u53ef\u6c42\u51fa \\(m\\pmod p\\)\u3002</p>"},{"location":"topic/crypto-lab3/#_26","title":"\u6269\u5c55\u5230\u5408\u6570\u60c5\u666f","text":"<p>\u201c\u4e8c\u201d\u89e3\u51b3\u4e86\u79bb\u6563\u5bf9\u6570\u95ee\u9898\uff0c\u4f46\u662f\u6ca1\u6cd5\u505a\u5230\u201c\u53ea\u6709\u79c1\u94a5\u62e5\u6709\u8005\u4f1a\u505a\u201d\uff0c\u4e3a\u6b64\uff0c\u6211\u4eec\u5c06\u5176\u6269\u5c55\u4e3a\u5408\u6570\u60c5\u666f\uff0c\u4ece\u800c\u5f15\u5165\u79c1\u94a5(\u5927\u6574\u6570\u7684\u5206\u89e3)\u3002</p> <p>\u6839\u636eRSA\uff0c\u6211\u4eec\u77e5\u9053\u77e5\u9053 (p-1)(q-1) \u548c\u77e5\u9053\u7d20\u6570\u5206\u89e3\u7b49\u4ef7\uff0c\u524d\u8005\u53ef\u4ee5\u4f5c\u4e3a\u79d8\u5bc6\u3002</p> <p>n=pq\uff0c\u800c p,q \u662f\u7d20\u6570\u3002</p> <p>\u6839\u636e\u6b27\u62c9\u5b9a\u7406\uff0c\\(\\phi(n^2)=pq(p-1)(q-1),\\phi(n)=(p-1)(q-1)\\)\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u6c42 \\(\\mathbb{Z}_{n^2}\\) \u4e0e \\(\\mathbb{Z}_{n}\\) \u7fa4\u7684\u6700\u5927\u751f\u6210\u5b50\u7fa4\u7684\u9636\uff0c\u6839\u636eCarmichael\u51fd\u6570\uff0c \\(\\lambda(n)=lcm(p-1,q-1),\\lambda(n^2)|pqlcm(p-1,q-1)=n\\lambda(n)\\)\uff08\u4f0f\u7b14\uff09\u3002\uff08\u663e\u7136\uff0c\u77e5\u9053 \\lambda(n) \u6216\u77e5\u9053 \\phi(n) \u53ef\u4ee5\u8f6c\u6362\uff0c\u524d\u8005\u53ef\u4ee5\u4f5c\u4e3a\u79d8\u5bc6\uff09</p> <p>\u5bf9\u4e8e\u4efb\u610f\u6570 g\uff0c\\(g^{\\lambda(n)}=1\\pmod n\\)\uff0c\u6362\u8a00\u4e4b \\(g^{\\lambda(n)}=kn+1\\)\u3002</p> <p>\u540c\u4e0a\u9762\u7684\u7406 \\(g^{\\lambda(n)}\\equiv kn+1\\pmod{n^2}\\)</p> <p>\u800c\u540c\u6837\u6839\u636e\u4e8c\u9879\u5f0f\u5b9a\u7406\uff0c\u6709 \\((kn+1)^m\\equiv mkn+1\\pmod{n^2}\\) \u3002</p> <p>\\(L_n((kn+1)^m)=L_n(mkn+1)=mk\\pmod n\\)\u3002\u5c06\u5f0f\u5b50\u5de6\u4fa7\u4e58 k \u5728\u6a21 n \u4e0b\u7684\u9006\u5143 \\(\\mu\\) \u5373\u53ef\u6c42\u51fa \\(m\\pmod n\\)\u3002</p>"},{"location":"topic/crypto-lab3/#_27","title":"\u4ea4\u6362\u8fd0\u7b97\u6b21\u5e8f","text":"<p>\u4e0a\u9762\u7684\u8fc7\u7a0b\u662f\u9996\u5148\u6709 g\uff0c\u7b2c\u4e00\u6b65\u5f97\u5230 \\(g^{\\lambda(n)}\\)\uff0c\u7b2c\u4e8c\u6b65\u5f97\u5230 \\(g^{\\lambda(n)m}\\) \uff0c\u7b2c\u4e09\u6b65\u53cd\u89e3\u5f97\u5230 m\u3002</p> <p>\u6beb\u65e0\u7591\u95ee\uff0c\u52a0\u5bc6\u64cd\u4f5c\u662f\u5f15\u5165 m \u7684\u65f6\u5019\u53d1\u751f\u7684\uff0c\u4f46\u95ee\u9898\u662f\u7b2c\u4e09\u6b65\u4e0d\u9700\u8981\u7528\u5230\u79d8\u5bc6\uff0c\u800c\u7b2c\u4e00\u6b65\u5374\u7528\u5230\u4e86\u79d8\u5bc6\u3002</p> <p>\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u6839\u636e\u5e42\u8fd0\u7b97\u7684\u6027\u8d28\u6765\u4ea4\u6362\u8fd0\u7b97\u6b21\u5e8f\uff1a</p> <p>\u9996\u5148\u6709 g\uff0c\u7b2c\u4e00\u6b65\u5f97\u5230 \\(g^{m}\\)\uff0c\u7b2c\u4e8c\u6b65\u5f97\u5230 \\(g^{\\lambda(n)m}\\) \uff0c\u7b2c\u4e09\u6b65\u53cd\u89e3\u5f97\u5230 m\u3002</p> <p>\u8fd9\u6837\u5c31\u591f\u6210\u4e86\u5bc6\u7801\u534f\u8bae\uff08\u534f\u8bae\u4e2d\u7684\u8ba1\u7b97 \\(d=f(a,b,c)=\\ldots=g(a,b,c)\\) \uff0c\u8868\u793a\u7b97\u6cd5\u4e2d\u7684\u6b65\u9aa4\u4e3a \\(d\\coloneqq f(a,b,c)\\)\uff0c\u800c \\(\\ldots\\) \u662f\u5bf9 f(a,b,c) \u7684\u6570\u5b66\u63a8\u5bfc\uff0c\u5176\u7ed3\u679c\u7b49\u4e8e g(a,b,c)\uff09\uff1a</p>"},{"location":"topic/crypto-lab3/#_28","title":"\u5bc6\u94a5\u751f\u6210","text":"<p>Miller-Rabin \u5f97\u5230\u5927\u7d20\u6570 p,q\uff0c\u8ba1\u7b97 \\(n=pq,\\lambda(n)=lcm(p-1,q-1)\\)\u3002</p> <p>\u968f\u673a\u751f\u6210 g\uff0c\u7b97\u51fa \\(k=L_n(g^{\\lambda(n)})=L_n(kn+1)\\)\uff0c\u6c42 k \u5728\u6a21 n \u4e0b\u7684\u9006\u5143 \\(\\mu\\)\uff0c\u5982\u679c\u9006\u5143\u4e0d\u5b58\u5728\uff0c\u91cd\u65b0\u751f\u6210 g\u3002\uff08\u53ef\u89c1\uff0c\u4e0d\u5b58\u5728\u7684\u6982\u7387\u6781\u5c0f\uff09</p> <p>\u516c\u94a5 g,n \uff08\u52a0\u5bc6\u6240\u9700\uff09\u3002\u79c1\u94a5 \\(\\lambda(n),\\mu\\) \uff08\u89e3\u5bc6\u6240\u9700\uff0c\u5176\u4e2d \\(\\lambda(n)\\) \u662f\u96be\u4ee5\u6c42\u51fa\u7684\u79d8\u5bc6\u672c\u8eab\uff09</p>"},{"location":"topic/crypto-lab3/#_29","title":"\u52a0\u5bc6","text":"<p>\u6d88\u606f\u4e3a \\(m\\pmod n\\)\uff0c\u5bc6\u6587 \\(c\\equiv g^m\\pmod{n^2}\\)\u3002</p>"},{"location":"topic/crypto-lab3/#_30","title":"\u89e3\u5bc6","text":"<p>\u9996\u5148\uff0c\u8ba1\u7b97 \\(h=L_n(c^{\\lambda(n)})=L_n({(g^{\\lambda(n)})^{m}})=L_n((kn+1)^m)=L_n(mkn+1)=mk\\)\u3002</p> <p>\u89e3\u5bc6\u5f97\u5230 \\(m=h\\mu=hk^{-1}\\pmod n\\)\u3002</p> <p>\u7b80\u8a00\u4e4b\uff0c\\(m=L_n(c^{\\lambda(n)}\\pmod{n^2})\\mu\\pmod n\\)\u3002</p>"},{"location":"topic/crypto-lab3/#_31","title":"\u540c\u6001\u52a0\u6cd5","text":"<p>\u6d88\u606f\u7684\u52a0\u6cd5 \\(m_1+m_2 =&gt; c_1c_2=g^{m_1+m_2}\\pmod{n^2}\\)\u3002</p>"},{"location":"topic/crypto-lab3/#_32","title":"\u968f\u673a\u6270\u52a8","text":"<p>\u73b0\u5728\u7684\u95ee\u9898\u662f\uff0c\u6709\u610f\u4e49\u7684\u503c\u5f88\u53ef\u80fd\u5f88\u5c0f\uff0c\u6bd4\u5982 1,2,3\u3002\u653b\u51fb\u8005\u53ea\u8981\u4f9d\u6b21\u52a0\u5bc6\u4ed6\u4eec\u5e76\u628a\u7ed3\u679c\u4e0e\u67d0\u4e2a\u6709\u610f\u4e49\u7684\u503c\u7684\u5bc6\u6587\u6bd4\u8f83\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u8fd9\u4e2a\u503c\u662f\u591a\u5c11\u3002\u6362\u8a00\u4e4b\uff0c\u79bb\u6563\u5bf9\u6570\u6781\u5c0f\u65f6\uff0c\u79bb\u6563\u5bf9\u6570\u95ee\u9898\u7684\u56f0\u96be\u6027\u4e0d\u5b58\u5728\u3002</p> <p>\u4e00\u4e2a\u60f3\u6cd5\u662f\uff0c\u5bc6\u6587\u5f15\u5165\u201c\u5b8c\u7f8e\u7684\u201d\u968f\u673a\u6270\u52a8 t\uff0c\u4f7f\u5f97 \\(c'\\equiv g^mt\\pmod{n^2}\\)\u3002</p> <p>\u968f\u673a\u6270\u52a8\u8db3\u591f\u7684\u591a\uff0c\u5bfc\u81f4\u6ca1\u6cd5\u7206\u7834\u3002</p> <p>\u4f46\u662f\u540c\u65f6\u53c8\u4e0d\u5f71\u54cd\u89e3\u5bc6\uff0c\u5373 \\(m=L_n({c'}^{\\lambda(n)}\\pmod{n^2})\\mu\\pmod n\\) \u4ecd\u7136\u6210\u7acb\u3002</p> <p>\u5373\uff0c\u8981\u4f7f\u5f97 \\(c^{\\lambda(n)}=g^{m\\lambda(n)}\\pmod{n^2}\\) \u4e0e \\({c\u2019}^{\\lambda(n)}=g^{m\\lambda(n)}t^{\\lambda(n)}\\pmod{n^2}\\) \u76f8\u7b49\u3002</p> <p>\u5373\uff0c\u8981\u4f7f\u5f97 \\(t^{\\lambda(n)}=1\\pmod{n^2}\\)\u3002</p> <p>\u800c\u6211\u4eec\u6709\uff0c\u5bf9\u4e8e\u4efb\u610f\u7fa4\u5143\u7d20 x\uff0c\\(x^{\\lambda(n^2)}\\equiv 1\\pmod{n^2}\\)\u3002</p> <p>\u4f0f\u7b14\u56de\u6536\uff0c\\(x^{n\\lambda(n)}\\equiv 1\\pmod{n^2}\\)\u3002\u4e5f\u5c31\u662f\u8bf4 \\({(x^n)}^{\\lambda(n)}\\equiv 1\\pmod{n^2}\\)\u3002</p> <p>\u6362\u8a00\u4e4b\u53d6\u968f\u673a\u6570 r\uff0c\\(r^n\\) \u5c31\u662f\u4e00\u4e2a\u201c\u5b8c\u7f8e\u7684\u201d\u968f\u673a\u6270\u52a8\uff0c\u800c\u4e14\u5f97\u5230\u8fd9\u6837\u7684\u4e00\u4e2a\u6270\u52a8\u4e0d\u9700\u8981\u79c1\u94a5\u4fe1\u606f\u3002</p> <p>\u56de\u987e\u4e00\u904d\u6574\u4e2a\u534f\u8bae\uff1a</p>"},{"location":"topic/crypto-lab3/#_33","title":"\u5bc6\u94a5\u751f\u6210\uff08\u4e0d\u53d8\uff09","text":"<p>Miller-Rabin \u5f97\u5230\u5927\u7d20\u6570 p,q\uff0c\u8ba1\u7b97 \\(n=pq,\\lambda(n)=lcm(p-1,q-1)\\)\u3002</p> <p>\u968f\u673a\u751f\u6210 g\uff0c\u7b97\u51fa \\(k=L_n(g^{\\lambda(n)})=L_n(kn+1)\\)\uff0c\u6c42 k \u5728\u6a21 n \u4e0b\u7684\u9006\u5143 \\(\\mu\\)\uff0c\u5982\u679c\u9006\u5143\u4e0d\u5b58\u5728\uff0c\u91cd\u65b0\u751f\u6210 g\u3002\uff08\u53ef\u89c1\uff0c\u4e0d\u5b58\u5728\u7684\u6982\u7387\u6781\u5c0f\uff09</p> <p>\u516c\u94a5 g,n \uff08\u52a0\u5bc6\u6240\u9700\uff09\u3002\u79c1\u94a5 \\(\\lambda(n),\\mu\\) \uff08\u89e3\u5bc6\u6240\u9700\uff0c\u5176\u4e2d \\(\\lambda(n)\\) \u662f\u96be\u4ee5\u6c42\u51fa\u7684\u79d8\u5bc6\u672c\u8eab\uff09</p>"},{"location":"topic/crypto-lab3/#_34","title":"\u52a0\u5bc6","text":"<p>\u6d88\u606f\u4e3a \\(m\\pmod n\\)\uff0c\u968f\u673a\u9009\u53d6 \\(r\\in[2,n-1]\\)\uff0c\u8ba1\u7b97\u5f97\u5230\u5bc6\u6587 \\(c\\equiv g^mr^n\\pmod{n^2}\\)\u3002</p>"},{"location":"topic/crypto-lab3/#_35","title":"\u89e3\u5bc6\uff08\u4e0d\u53d8\uff09","text":"<p>\u9996\u5148\uff0c\u8ba1\u7b97 \\(h=L_n(c^{\\lambda(n)})=L_n({(g^{\\lambda(n)})^{m}})=L_n((kn+1)^m)=L_n(mkn+1)=mk\\)\u3002</p> <p>\u89e3\u5bc6\u5f97\u5230 \\(m=h\\mu=hk^{-1}\\pmod n\\)\u3002</p> <p>\u7b80\u8a00\u4e4b\uff0c\\(m=L_n(c^{\\lambda(n)}\\pmod{n^2})\\mu\\pmod n\\)\u3002</p>"},{"location":"topic/crypto-lab3/#_36","title":"\u540c\u6001\u52a0\u6cd5","text":"<p>\u6d88\u606f\u7684\u52a0\u6cd5 \\(m_1+m_2 =&gt; c_1c_2=g^{m_1+m_2}(r_1r_2)^n\\pmod{n^2}\\)\u3002</p>"},{"location":"topic/misc-lab2/","title":"Misc Lab 2\uff1a\u56fe\u7247\u3001\u97f3\u9891\u9690\u5199","text":"<p>\u672c\u8282 Lab \u7531\u4ee5\u4e0b\u4e24\u90e8\u5206\u7ec4\u6210\uff1a</p> <ul> <li>\u57fa\u7840\u90e8\u5206\uff0c\u5fc5\u505a\uff08\u6bcf\u9898 20 \u5206\uff0c\u5171 60 \u5206\uff09<ul> <li>Challenge 1: songmingti</li> <li>Challenge 2: miaomiaomiao</li> <li>Challenge 3: easy LSB</li> </ul> </li> <li>\u9009\u505a\u90e8\u5206\uff0c\u5206\u6570\u89c1\u4e0b\uff0c\u6574\u4f53\u591a\u51fa 100 \u5206\u7684\u4e3a bonus<ul> <li>Challenge 4: Palette Stego\uff0820 \u5206\uff09</li> <li>Challenge 5: Spectrogram\uff0830 \u5206\uff09</li> <li>Challenge 6: Huffman Stego\uff0850 \u5206\uff09</li> </ul> </li> </ul> <p>\uff08\u6700\u7ec8\u7684\u5206\u6570\u5206\u914d\u53ef\u80fd\u4f1a\u6839\u636e\u5927\u5bb6\u7684\u63d0\u4ea4\u60c5\u51b5\u6709\u6240\u8c03\u6574\uff09</p> <p>\u5177\u4f53\u5b9e\u9a8c\u62a5\u544a\u9700\u8981\u5199\u7684\u5185\u5bb9\u4f1a\u5728\u4e0b\u9762\u5177\u4f53\u9898\u76ee\u91cc\u9762\u63cf\u8ff0\u3002\u5bf9\u4e8e\u9898\u76ee\u6709\u4efb\u4f55\u95ee\u9898\u90fd\u53ef\u4ee5\u5728\u7fa4\u91cc/\u79c1\u6233 TonyCrane \u63d0\u95ee\u3002</p> <p>\u672c\u6b21 lab \u7684 ddl \u5728\u53d1\u5e03\u4e24\u5468\u4ee5\u540e\u5373 7 \u6708 26 \u65e5\u665a 23:59\uff0c\u8bf7\u6ce8\u610f\u5b89\u6392\u65f6\u95f4\u3002</p> <p>\u672c\u6b21 lab \u7684\u5b89\u6392\u662f 60 \u5206\u7b80\u5355\u3001\u57fa\u7840\u7684\u56fe\u7247\u9690\u5199\u9898\u76ee\u3002\u9009\u505a\u90e8\u5206\u662f\u4e00\u4e9b\u5728\u771f\u5b9e CTF \u6bd4\u8d5b\u4e2d\u5b8c\u5168\u53ef\u80fd\u51fa\u73b0\u7684\u96be\u5ea6\u7684\u9898\u76ee\uff0c\u4f46\u5728\u7ed9\u4e86 hint \u4e4b\u540e\u96be\u5ea6\u5e94\u8be5\u5df2\u7ecf\u5927\u5927\u51cf\u5c0f\u3002\u9274\u4e8e\u672c\u6b21\u5b9e\u9a8c\u53ef\u80fd\u96be\u5ea6\u8fc7\u9ad8\uff0c\u4e0b\u4e00\u8282\u5173\u4e8e\u53d6\u8bc1\u7684 lab \u96be\u5ea6\u5219\u90fd\u4f1a\u6bd4\u8f83\u7b80\u5355\u3002\u4ee5\u53ca\u5728\u505a\u9898\u8fc7\u7a0b\u4e2d\u9047\u5230\u4efb\u4f55\u95ee\u9898\uff0c\u90fd\u8bf7\u53ca\u65f6\u8054\u7cfb\u6211\uff0c\u5bf9\u4e8e\u5171\u6027\u95ee\u9898\u6211\u4f1a\u8003\u8651\u7ee7\u7eed\u653e\u51fa hint\u3002</p>"},{"location":"topic/misc-lab2/#background","title":"Background","text":"<p>\u6211\u4eec\u4e0a\u8bfe\u8bb2\u4e86\u5f88\u591a\u79cd\u56fe\u7247\u9690\u5199\u7684\u65b9\u5f0f\uff0c\u603b\u7ed3\u8d77\u6765\uff0c\u9047\u5230\u7b80\u5355\u56fe\u7247\u9690\u5199\u7684\u9898\u76ee\uff0c\u4e3b\u8981\u6709\u4ee5\u4e0b\u5c1d\u8bd5\u6b65\u9aa4\u4e00\u628a\u68ad\uff1a</p> <ul> <li>\u4f7f\u7528 exiftool \u68c0\u67e5\u56fe\u7247\u5143\u4fe1\u606f\uff0c\u770b\u770b\u6709\u6ca1\u6709\u770b\u8d77\u6765\u4f1a\u6709\u7528\u7684\u4fe1\u606f</li> <li>\u4f7f\u7528\u5341\u516d\u8fdb\u5236\u7f16\u8f91\u5668\u6253\u5f00\uff0c\u89c2\u5bdf\u6587\u4ef6\u4e2d\u6709\u65e0\u9644\u5e26\u4fe1\u606f\u3001\u56fe\u7247\u57fa\u672c\u683c\u5f0f\u662f\u5426\u6b63\u786e</li> <li>\u4f7f\u7528 binwalk \u68c0\u67e5\u6587\u4ef6\u672b\u5c3e\u662f\u5426\u53e0\u52a0\u4e86\u591a\u4f59\u7684\u6587\u4ef6</li> <li>\u4f7f\u7528 stegsolve \u6253\u5f00\u56fe\u7247/\u6216\u8005\u4f7f\u7528 CyberChef<ul> <li>\u89c2\u5bdf\u5404\u4e2a\u901a\u9053\u7684 bit plane</li> <li>\u4f7f\u7528 Extract LSB \u5c1d\u8bd5\u63d0\u53d6\u6570\u636e\u683c\u5f0f\u7684 LSB\uff08\u6216\u8005\u4f7f\u7528 zsteg \u731c\u6d4b\uff09</li> </ul> </li> <li>\u8003\u8651\u80fd\u5426\u67e5\u627e\u539f\u56fe\uff0c\u5982\u679c\u627e\u5230\u4e86\u5c1d\u8bd5\u8fdb\u884c\u6bd4\u8f83</li> <li>\u8003\u8651\u662f\u5426\u662f\u4f7f\u7528\u5de5\u5177\u8fdb\u884c\u7684\u56fe\u7247\u9690\u5199\uff0c\u591a\u5c1d\u8bd5\u4e00\u4e9b\u5e38\u89c1\u7684\u5de5\u5177</li> <li>...</li> </ul> <p>\u76f8\u4fe1\u6709\u4e86\u8fd9\u4e9b\u6b65\u9aa4\uff0c\u57fa\u7840\u90e8\u5206\u7684\u4e09\u9053\u9898\u90fd\u662f\u780d\u74dc\u5207\u83dc\u4e86\u3002</p>"},{"location":"topic/misc-lab2/#challenge-1","title":"Challenge 1","text":"<p>\u7b2c\u4e00\u9053\u9898\u76ee\u662f\u6821\u5df4\u4e0a\u7684 songmingti\uff0c\u94fe\u63a5\uff1azjusec.com/challenges/28\u3002</p> <p>\u8bf7\u5b8c\u6210\u9898\u76ee\uff0c\u63d0\u4ea4 flag \u6210\u529f\uff0c\u5e76\u5728\u5b9e\u9a8c\u62a5\u544a\u4e2d\u5199\u51fa\u4f60\u7684\u89e3\u9898\u601d\u8def\u548c\u5177\u4f53\u8fc7\u7a0b\u3002</p>"},{"location":"topic/misc-lab2/#challenge-2","title":"Challenge 2","text":"<p>\u7b2c\u4e8c\u9053\u9898\u76ee\u662f\u6821\u5df4\u4e0a\u7684 miaomiaomiao\uff0c\u94fe\u63a5\uff1azjusec.com/challenges/29\u3002</p> <p>\u8bf7\u5b8c\u6210\u9898\u76ee\uff0c\u63d0\u4ea4 flag \u6210\u529f\uff0c\u5e76\u5728\u5b9e\u9a8c\u62a5\u544a\u4e2d\u5199\u51fa\u4f60\u7684\u89e3\u9898\u601d\u8def\u548c\u5177\u4f53\u8fc7\u7a0b\u3002</p>"},{"location":"topic/misc-lab2/#challenge-3","title":"Challenge 3","text":"<p>\u8fd9\u662f\u4e00\u9053 LSB \u9690\u5199\u7684\u9898\u76ee\uff0c\u4f46\u548c lab 0 \u7684\u65b9\u5f0f\u6709\u90a3\u4e48\u4e00\u70b9\u4e0d\u4e00\u6837\uff0c\u76f8\u4fe1\u4f60\u4e00\u5b9a\u4e5f\u53ef\u4ee5\u8f7b\u677e\u89e3\u51fa flag\u3002</p> <p></p> <ul> <li>\u9898\u76ee\u9644\u4ef6\uff1achal.png</li> </ul> <p>\u8bf7\u5b8c\u6210\u9898\u76ee\uff0c\u62ff\u5230 flag\uff0c\u5e76\u5728\u5b9e\u9a8c\u62a5\u544a\u4e2d\u5199\u51fa\u4f60\u7684\u89e3\u9898\u601d\u8def\u548c\u5177\u4f53\u8fc7\u7a0b\u3002</p>"},{"location":"topic/misc-lab2/#challenge-4-palette-stego","title":"Challenge 4: Palette Stego","text":""},{"location":"topic/misc-lab2/#background_1","title":"Background","text":"<p>\u6211\u4eec\u8bfe\u4e0a\u8bb2\u4e86 PNG \u683c\u5f0f\u6709\u56db\u4e2a\u6807\u51c6 chunk\uff1aIHDR\u3001PLTE\u3001IDAT\u3001IEND\uff0c\u5e76\u4e14\u8be6\u7ec6\u8bb2\u4e86\u5176\u4e2d\u4e09\u4e2a\uff0c\u53ea\u6709 PLTE \u6ca1\u6709\u5177\u4f53\u4ecb\u7ecd\u3002</p> <p>\u5b9e\u9645\u4e0a\u8fd9\u4e2a\u5757\u7684\u7528\u9014\u662f\uff0cPNG \u6709\u4e00\u79cd\u989c\u8272\u6a21\u5f0f\u662f\u8c03\u8272\u677f\u6a21\u5f0f\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4f1a\u4f7f\u7528 PLTE \u5757\u5b58\u50a8\u8c03\u8272\u677f\uff0c\u5177\u4f53\u683c\u5f0f\u8bf7\u5927\u5bb6\u81ea\u884c\u4e86\u89e3\uff0c\u7136\u540e\u5728 IDAT \u4e2d\u5c06\u8bb0\u5f55\u7684\u50cf\u7d20\u503c\u4ece\u539f\u6765\u7684\u6bcf\u4e2a\u50cf\u7d20\u4e09\u4e2a\u5b57\u8282 RGB \u6539\u4e3a\u4e00\u4e2a\u5b57\u8282\u8c03\u8272\u677f\u7d22\u5f15\u3002\u66f4\u8be6\u7ec6\u7684\u5185\u5bb9\u8bf7\u5927\u5bb6\u81ea\u884c\u641c\u7d22\u76f8\u5173\u6587\u7ae0\u3001\u535a\u5ba2\u4e86\u89e3\u3002\uff08\u5982\u679c\u61d2\u5f97\u641c\u7684\u8bdd\u6211\u8fd9\u91cc\u63d0\u4f9b\u4e00\u4e2a\u6807\u51c6\uff1aPortable Network Graphics (PNG) Specification (Third Edition)\uff09</p> <p>\u6211\u4eec\u8bfe\u4e0a\u63d0\u5230\u8fc7\u7684\u4e00\u4e2a\u540d\u5b57\u2014\u2014EZStego \u9690\u5199\u3002\u8fd9\u662f\u4e00\u4e2a\u9488\u5bf9 GIF \u6216\u8005\u4f7f\u7528\u8c03\u8272\u677f\u6a21\u5f0f\u7684 PNG \u7684\u4e00\u79cd\u9690\u5199\u65b9\u5f0f\u3002\u7c7b\u4f3c JPEG\uff0c\u5b83\u5229\u7528\u4eba\u773c\u5bf9\u4e8e\u4eae\u5ea6\u66f4\u654f\u611f\u7684\u7279\u6027\uff0c\u5c06\u8c03\u8272\u677f\u7684\u989c\u8272\u6309\u7167\u4eae\u5ea6\u6392\u5e8f\uff0c\u8fd9\u6837\u76f8\u90bb\u7684\u4e24\u4e2a\u989c\u8272\u5728\u4f7f\u7528\u65f6\u4ea4\u6362\u7d22\u5f15\u89c6\u89c9\u5dee\u522b\u4e5f\u4e0d\u5927\uff0c\u7528\u8fd9\u4e2a\u65b9\u5f0f\u5c31\u53ef\u4ee5\u8fdb\u884c\u9690\u5199\u3002\u4f60\u53ef\u4ee5\u641c\u7d22 \u201cEZStego \u9690\u5199\u201d \u5173\u952e\u8bcd\u4e86\u89e3\u66f4\u8be6\u7ec6\u7684\u9690\u5199\u65b9\u6cd5\uff08\u6ce8\u610f\u4e0d\u662f zsteg\uff0c\u90a3\u662f\u4e00\u4e2a\u547d\u4ee4\u884c\u5de5\u5177\uff09\u3002</p>"},{"location":"topic/misc-lab2/#challenge","title":"Challenge","text":"<p>\u4e0b\u56fe\u5c31\u662f\u9898\u76ee\uff0c\u5b83\u4f7f\u7528 EZStego \u9690\u5199\u9690\u85cf\u4e86 flag\uff1a</p> <p></p> <ul> <li>\u9898\u76ee\u9644\u4ef6\uff1achal.png</li> </ul> <p>\u8bf7\u5b66\u4e60 PLTE chunk \u7684\u683c\u5f0f\u3001EZStego \u9690\u5199\u7684\u539f\u7406\u548c\u5177\u4f53\u6b65\u9aa4\uff0c\u5b8c\u6210\u9898\u76ee\uff0c\u62ff\u5230 flag\uff0c\u5e76\u5728\u5b9e\u9a8c\u62a5\u544a\u4e2d\u5199\u51fa\u4f60\u7684\u89e3\u9898\u601d\u8def\u548c\u5177\u4f53\u8fc7\u7a0b\uff08\u5305\u62ec\u89e3\u9898\u4ee3\u7801\uff09\u3002</p> <p>\u5982\u679c\u65e0\u6cd5\u89e3\u51fa\u9898\u76ee\uff0c\u4e5f\u8bf7\u5c06\u4f60\u7684\u5c1d\u8bd5\u5199\u5728\u62a5\u544a\u4e2d\uff08\u4f60\u5df2\u7ecf\u5b66\u5230\u7684\u76f8\u5173\u77e5\u8bc6\u4e5f\u53ef\u4ee5\u5199\u8fdb\u53bb\uff09\uff0c\u6211\u4eec\u4f1a\u6839\u636e\u4f60\u7684\u8fdb\u5ea6\u7ed9\u90e8\u5206\u5206\u3002</p>"},{"location":"topic/misc-lab2/#hint","title":"Hint","text":"<p>\u4ee5\u4e0b\u662f\u4e00\u4e9b\u9488\u5bf9\u4f7f\u7528 python \u5904\u7406\u8fd9\u9053\u9898\u65f6\u53ef\u80fd\u4f1a\u6709\u7528\u7684 hint\uff1a</p> <ul> <li>\u9898\u76ee\u56fe\u7247\u7684 mode \u5df2\u7ecf\u4e0d\u662f \"RGB\" \u4e86\uff0c\u800c\u662f \"P\"</li> <li>\u4f60\u53ef\u4ee5\u901a\u8fc7 <code>img = Image.open(...)</code> \u6b63\u5e38\u6253\u5f00\u9898\u76ee\u56fe\u7247</li> <li>\u8c03\u8272\u677f\u5185\u5bb9\u53ef\u4ee5\u901a\u8fc7 <code>img.palette</code> \u8bbf\u95ee\uff08\u5177\u4f53\u7ed3\u6784\u8bf7\u81ea\u884c\u63a2\u7d22\uff09</li> <li>\u6211\u9488\u5bf9\u50cf\u7d20\u7684\u5904\u7406\u662f\u4e00\u884c\u4e00\u884c\u8fdb\u884c\u7684<ul> <li>\u9700\u8981\u6ce8\u610f PIL \u4e2d\u56fe\u7247\u7ed3\u6784\u662f\u5148\u5217\u540e\u884c\uff0c\u5373 (x, y) \u8868\u793a\u7b2c x \u5217\u7b2c y \u884c</li> <li>\u5904\u7406\u65f6\u6ce8\u610f\u5faa\u73af\u987a\u5e8f</li> </ul> </li> </ul>"},{"location":"topic/misc-lab2/#challenge-5-spectrogram","title":"Challenge 5: Spectrogram","text":""},{"location":"topic/misc-lab2/#challenge_1","title":"Challenge","text":"<p>\u8fd9\u9053\u9898\u76ee\u662f\u4e00\u4e2a\u97f3\u9891\u9690\u5199\u7684\u9898\u76ee\uff0c\u6211\u901a\u8fc7\u4e00\u4e2a python \u7a0b\u5e8f\u5c06\u4e00\u5c0f\u6bb5\u6b4c\u66f2\u8f6c\u6362\u4e3a\u4e86\u9891\u8c31\u52a8\u56fe\uff0c\u76f8\u4fe1\u4f60\u4e00\u5b9a\u53ef\u4ee5\u4ece\u8fd9\u5f20\u52a8\u56fe\u4e2d\u5c31\u590d\u539f\u51fa\u539f\u66f2\u7684\u5927\u81f4\u6837\u5b50\u3002</p> <p></p> <ul> <li>\u9898\u76ee\u9644\u4ef6\uff1aflag.gif\u3001generate.py</li> </ul> <p>\u8bf7\u53c2\u8003\u751f\u6210\u9891\u8c31\u56fe\u7684\u4ee3\u7801\uff0c\u5c1d\u8bd5\u6062\u590d\u539f\u97f3\u9891\u3002\u4f60\u9700\u8981\u56de\u7b54\u51fa\u8fd9\u9996\u6b4c\u66f2\u662f\u4ec0\u4e48\uff0c\u5e76\u5c06\u4f60\u7684\u89e3\u9898\u601d\u8def\u548c\u5177\u4f53\u8fc7\u7a0b\u5199\u5728\u5b9e\u9a8c\u62a5\u544a\u4e2d\uff0c\u5c06\u4f60\u6062\u590d\u51fa\u7684\u97f3\u9891\u548c\u4f7f\u7528\u7684\u811a\u672c\u901a\u8fc7\u538b\u7f29\u5305\u7684\u5f62\u5f0f\u540c\u65f6\u4e0a\u4f20\u3002</p> <p>\u5982\u679c\u65e0\u6cd5\u5b8c\u6574\u5b8c\u6210\u590d\u539f\uff0c\u4e5f\u8bf7\u5c06\u4f60\u7684\u5c1d\u8bd5\u5199\u5728\u62a5\u544a\u4e2d\uff0c\u6211\u4eec\u4f1a\u6839\u636e\u5b8c\u6210\u60c5\u51b5\u7ed9\u90e8\u5206\u5206\u3002</p>"},{"location":"topic/misc-lab2/#hint_1","title":"Hint","text":"<p>\u8fd9\u9053\u9898\u76ee\u5176\u5b9e\u8003\u70b9\u66f4\u504f\u5411\u4e8e python \u7684\u4f7f\u7528\uff08\u7b11\uff09\uff0c\u4f60\u53ef\u80fd\u9700\u8981\uff1a</p> <ul> <li>\u638c\u63e1 numpy \u77e9\u9635\u6570\u636e\u7684\u5904\u7406\u65b9\u5f0f<ul> <li>\u4e0d\u719f\u6089\u7684\u8bdd\u5efa\u8bae\u914d\u5408\u6587\u6863/\u6559\u7a0b\u901a\u8fc7\u5b9e\u8df5\u6765\u5b66\u4e60</li> </ul> </li> <li>\u641c\u7d22\u5e76\u7b80\u5355\u9605\u8bfb librosa \u8fd9\u4e2a\u5e93\u7684\u6587\u6863</li> <li>\u5982\u679c\u4f60\u88ab\u811a\u672c\u4e2d\u5d4c\u5957\u7684\u77e9\u9635\u5904\u7406\u641e\u7cca\u6d82\u4e86\uff0c\u4e0d\u59a8\u81ea\u5df1\u7528\u53e6\u4e00\u4e2a\u97f3\u9891\u6587\u4ef6\u8dd1\u4e00\u4e0b generate.py\uff0c\u4f60\u53ef\u4ee5\u5728\u4e2d\u9014\u8f93\u51fa\u4efb\u4f55\u4f60\u60f3\u8981\u4e86\u89e3\u7684\u4e2d\u95f4\u7ed3\u679c</li> </ul>"},{"location":"topic/misc-lab2/#challenge-6-huffman-stego","title":"Challenge 6: Huffman Stego","text":""},{"location":"topic/misc-lab2/#background_2","title":"Background","text":"<p>\u6211\u4eec\u8bfe\u4e0a\u8bb2\u5230\u4e86 JPEG \u6587\u4ef6\u4f1a\u4f7f\u7528 Huffman \u7f16\u7801\uff0c\u4ee5\u53ca\u662f\u4e00\u79cd\u79f0\u4e3a\u201c\u8303\u5f0f Huffman \u7f16\u7801\u201d\u7684\u53d8\u5f62\u7248\u3002\u5173\u4e8e Huffman \u7f16\u7801\u6709\u5173\u7684\u6570\u636e\u5b58\u50a8\u5728\u4e86 DHT \u5757\u4e2d\uff0c\u5176\u5177\u4f53\u683c\u5f0f\u9700\u8981\u4f60\u6765\u81ea\u884c\u67e5\u9605\u8d44\u6599\u4e86\u89e3\u3002</p> <ul> <li>JPEG \u4e2d\u7684\u8303\u5f0f\u54c8\u592b\u66fc\u7f16\u7801</li> <li>JPEG\u7b97\u6cd5\u89e3\u5bc6\uff08\u56db\uff09</li> </ul> <p>\u5728 JPEG \u7f16\u89e3\u7801\u7684\u8fc7\u7a0b\u4e2d\u4f1a\u4f7f\u7528\u5230\u8ba1\u7b97\u51fa\u6765\u7684 Huffman \u7f16\u7801\uff0c\u8fd9\u4e9b\u7f16\u7801\u4e0e DHT \u5757\u6709\u5173\u3002\u800c\u5728\u5b9e\u9645\u89e3\u7801\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5373\u4f7f\u6709\u7f16\u7801\u6ca1\u6709\u88ab\u4f7f\u7528\u5230\uff0c\u4e5f\u4e0d\u4f1a\u8ba4\u4e3a\u51fa\u9519\u4e86\u3002\u6240\u4ee5\u51fa\u9898\u4eba\u53ef\u4ee5\u5728 Huffman \u7f16\u7801\u6811\u4e0a\u63d2\u5165\u5b9e\u9645\u6ca1\u6709\u7528\u7684\u7f16\u7801\uff0c\u4ece\u800c\u9690\u85cf\u4fe1\u606f\u3002</p> <p>\u4e3a\u4e86\u89e3\u51b3\u8fd9\u6837\u7684\u9898\u76ee\uff0c\u663e\u7136\u4f60\u9700\u8981\u4e00\u4e2a\u4f60\u53ef\u4ee5\u65b9\u4fbf\u64cd\u63a7\u7684 JPEG \u89e3\u7801\u5668\uff0c\u5e76\u7b80\u5355\u7406\u89e3\u5176\u89e3\u7801\u903b\u8f91\uff0c\u8fd9\u91cc\u63a8\u8350\u4e00\u4e9b\u6587\u7ae0/\u4ee3\u7801\u4f9b\u5927\u5bb6\u53c2\u8003\uff1a</p> <ul> <li>Understanding and Decoding a JPEG Image using Python<ul> <li>\u5bf9\u5e94\u4ee3\u7801\uff1ayasoob/Baseline-JPEG-Decoder</li> </ul> </li> <li>https://github.com/yohhoy/picojdec</li> </ul>"},{"location":"topic/misc-lab2/#challenge_2","title":"Challenge","text":"<p>\u8fd9\u91cc\u6709 48 \u5f20 512x512 \u7684\u7070\u5ea6\u56fe\uff0c\u91cc\u9762\u85cf\u4e86 flag\uff0c\u8bf7\u627e\u51fa\u6765\uff1a</p> <p></p> <ul> <li>\u9898\u76ee\u9644\u4ef6\uff1achal.zip</li> </ul> <p>\u4ee5\u4e0a\u662f\u5728\u771f\u5b9e\u7684 CTF \u6bd4\u8d5b\u4e2d\u4f60\u53ef\u80fd\u4f1a\u770b\u5230\u7684\u5168\u90e8\u9898\u76ee\u63cf\u8ff0\uff0c\u8fd9\u4e5f\u662f\u4e00\u9053\u76f8\u5f53\u4e0d\u7b80\u5355\u7684\u9898\u76ee\u3002\u4f46\u8fd9\u91cc\u6211\u7ee7\u7eed\u5c06\u5927\u90e8\u5206\u505a\u6cd5\u7b80\u8981\u5730\u544a\u8bc9\u4f60\u6765\u964d\u4f4e\u4e00\u4e9b\u96be\u5ea6\uff1a</p> <ul> <li>\u9488\u5bf9\u6bcf\u5f20\u56fe\u7247\uff1a<ul> <li>\u81ea\u5df1\u5199\u4e00\u4e2a/\u4fee\u6539\u524d\u9762\u7684 JPEG \u89e3\u7801\u5668\uff0c\u8bb0\u5f55 DHT \u5757\u4e2d\u5305\u542b\u7684\u7f16\u7801\uff0c\u4ee5\u53ca\u5728 scan \u7684\u8fc7\u7a0b\u4e2d\u5b9e\u9645\u4f7f\u7528\u5230\u7684\u7f16\u7801</li> <li>\u5bf9\u6bd4\u4e24\u8005\u7684\u5dee\u5f02\uff0c\u4f60\u4f1a\u53d1\u73b0 DHT \u5757\u4e2d\u6ca1\u6709\u88ab\u4f7f\u7528\u5230\u7684\u7f16\u7801</li> <li>\u6bcf\u4e2a\u56fe\u7247\u90fd\u6709\u4e00\u4e2a\u5b57\u8282\u7684\u7f16\u7801\u6ca1\u6709\u88ab\u4f7f\u7528\u5230\uff0c\u5c06\u5176\u63d0\u53d6\u51fa\u6765</li> </ul> </li> <li>\u5bfb\u627e\u90a3\u4e2a\u5b57\u8282\u672c\u8eab\u6216\u8005\u5176\u5bf9\u5e94\u7684\u8303\u5f0f Huffman \u7f16\u7801\u7684\u89c4\u5f8b\uff0c\u914d\u5408 flag \u5f00\u5934\u4e3a <code>AAA{</code>\uff0c\u731c\u6d4b\u5f97\u5230\u5197\u4f59\u7f16\u7801\u7684\u4f7f\u7528\u65b9\u5f0f\uff0c\u4ece\u800c\u5f97\u5230 flag</li> </ul> <p>\u8bf7\u6839\u636e\u4e0a\u8ff0\u601d\u8def\u5b8c\u6210\u89e3\u9898\uff0c\u62ff\u5230 flag\uff0c\u5e76\u5728\u5b9e\u9a8c\u62a5\u544a\u4e2d\u5199\u51fa\u4f60\u7684\u89e3\u9898\u601d\u8def\u548c\u5177\u4f53\u8fc7\u7a0b\uff08\u5305\u62ec\u89e3\u9898\u4ee3\u7801\uff09\u3002</p> <p>\u5982\u679c\u65e0\u6cd5\u89e3\u51fa\u9898\u76ee\uff0c\u4e5f\u8bf7\u5c06\u4f60\u7684\u5c1d\u8bd5\u5199\u5728\u62a5\u544a\u4e2d\uff08\u4f60\u5df2\u7ecf\u5b66\u5230\u7684\u76f8\u5173\u77e5\u8bc6\u4e5f\u53ef\u4ee5\u5199\u8fdb\u53bb\uff09\uff0c\u6211\u4eec\u4f1a\u6839\u636e\u4f60\u7684\u8fdb\u5ea6\u7ed9\u90e8\u5206\u5206\u3002</p>"},{"location":"topic/misc-lab3/","title":"Misc Lab 3\uff1a\u6d41\u91cf\u3001\u5185\u5b58\u53d6\u8bc1\u53ca\u66f4\u591a\u63a2\u7d22","text":"<p>\u672c\u8282 Lab \u7531\u4ee5\u4e0b\u4e24\u90e8\u5206\u7ec4\u6210\uff1a</p> <ul> <li>\u57fa\u7840\u90e8\u5206\uff0c\u5fc5\u505a\uff08\u6bcf\u9898 20 \u5206\uff0c\u5171 80 \u5206\uff09<ul> <li>Challenge 1: SQL Inject Analysis</li> <li>Challenge 2: dnscap</li> <li>Challenge 3: crack_zju_wlan</li> <li>Challenge 4: volatility \u5b89\u88c5\u4e0e\u4f7f\u7528</li> </ul> </li> <li>\u9009\u505a\u90e8\u5206\uff0c\u6bcf\u4e2a 20 \u5206\uff0c\u6574\u4f53\u591a\u51fa 100 \u5206\u7684\u4e3a bonus<ul> <li>Challenge 5: pysandbox</li> <li>Bonus Task: misc \u8bfe\u7a0b\u603b\u7ed3</li> </ul> </li> </ul> <p>\u5177\u4f53\u5b9e\u9a8c\u62a5\u544a\u9700\u8981\u5199\u7684\u5185\u5bb9\u4f1a\u5728\u4e0b\u9762\u5177\u4f53\u9898\u76ee\u91cc\u9762\u63cf\u8ff0\u3002\u5bf9\u4e8e\u9898\u76ee\u6709\u4efb\u4f55\u95ee\u9898\u90fd\u53ef\u4ee5\u5728\u7fa4\u91cc/\u79c1\u6233 TonyCrane \u63d0\u95ee\u3002</p> <p>\u672c\u6b21 lab \u7684 ddl \u5728\u53d1\u5e03\u4e24\u5468\u4ee5\u540e\u5373 7 \u6708 28 \u65e5\u665a 23:59\uff0c\u8bf7\u6ce8\u610f\u5b89\u6392\u65f6\u95f4\u3002</p>"},{"location":"topic/misc-lab3/#challenge-1","title":"Challenge 1","text":"<p>\u5b8c\u6210\u8bfe\u4e0a\u8bb2\u7684 HTTP \u6d41\u91cf\u5206\u6790\u4f8b\u9898\uff0c\u5373 SQL \u6ce8\u5165\u6d41\u91cf\u7684\u89e3\u6790\u3002</p> <ul> <li>\u9898\u76ee\u9644\u4ef6\uff1asqltest.pcapng</li> </ul> <p>\u8bf7\u5b8c\u6210\u9898\u76ee\uff0c\u62ff\u5230 flag\uff0c\u5e76\u5728\u5b9e\u9a8c\u62a5\u544a\u4e2d\u5199\u51fa\u4f60\u7684\u89e3\u9898\u601d\u8def\u548c\u5177\u4f53\u8fc7\u7a0b\u3002</p>"},{"location":"topic/misc-lab3/#challenge-2","title":"Challenge 2","text":"<p>\u5b8c\u6210\u8bfe\u4e0a\u8bb2\u7684 UDP (DNS) \u6d41\u91cf\u5206\u6790\u4f8b\u9898\uff0c\u5373 dnscat \u534f\u8bae\u7684\u624b\u52a8\u89e3\u6790\u3002</p> <ul> <li>\u9898\u76ee\u9644\u4ef6\uff1adnscap.pcap</li> <li>\u53c2\u8003 dnscat \u534f\u8bae\u6587\u6863\uff1aGitHub:iagox86/dnscat2</li> </ul> <p>\u8bf7\u5b8c\u6210\u9898\u76ee\uff0c\u62ff\u5230 flag\uff0c\u5e76\u5728\u5b9e\u9a8c\u62a5\u544a\u4e2d\u5199\u51fa\u4f60\u7684\u89e3\u9898\u601d\u8def\u548c\u5177\u4f53\u8fc7\u7a0b\u3002</p>"},{"location":"topic/misc-lab3/#challenge-3","title":"Challenge 3","text":"<p>\u5b8c\u6210\u6821\u5df4\u4e0a\u7684\u9898\u76ee crac_zju_wlan\uff0c\u94fe\u63a5\uff1azjusec.com/challenges/105\u3002</p> <p>\u867d\u7136\u6211\u4eec\u8bfe\u4e0a\u5e76\u6ca1\u6709\u8be6\u7ec6\u8bb2\u89e3 WIFI \u534f\u8bae\u5bc6\u7801\u7684\u7834\u89e3\uff0c\u4f46\u5176\u5b9e\u53ea\u8981\u4e00\u4e2a\u6211\u4eec\u8bfe\u4e0a\u63d0\u5230\u7684\u5de5\u5177\u5c31\u53ef\u4ee5\u641e\u5b9a\uff0c\u8bf7\u5c1d\u8bd5\u5b8c\u6210\u8fd9\u9053\u9898\u76ee\u3002</p> <p>\u8bf7\u5b8c\u6210\u9898\u76ee\uff0c\u63d0\u4ea4 flag \u6210\u529f\uff0c\u5e76\u5728\u5b9e\u9a8c\u62a5\u544a\u4e2d\u5199\u51fa\u4f60\u7684\u89e3\u9898\u601d\u8def\u548c\u5177\u4f53\u8fc7\u7a0b\u3002</p>"},{"location":"topic/misc-lab3/#challenge-4","title":"Challenge 4","text":"<p>\u4f5c\u4e3a misc \u624b\uff0c\u914d\u73af\u5883\u4e5f\u662f\u9700\u8981\u638c\u63e1\u7684\u4e00\u4e2a\u6280\u80fd\u4e4b\u4e00\uff0c\u800c volatility \u8fd9\u4e2a\u5185\u5b58\u53d6\u8bc1\u5de5\u5177\u7684\u73af\u5883\u4e5f\u662f\u201c\u51fa\u4e86\u540d\u7684\u201d\u6298\u78e8\uff0c\u6240\u4ee5\u8bf7\u4f60\u6765\u914d\u7f6e\u597d\u76f8\u5173 python \u73af\u5883\uff0c\u6210\u529f\u8fd0\u884c volatility 2.6 \u7248\u672c\uff0c\u5e76\u590d\u73b0\u6211\u4eec\u4e0a\u8bfe\u8bb2\u7684\u4f8b\u9898\u3002\u5177\u4f53\u8981\u6c42\uff1a</p> <ul> <li>\u4ece\u5b98\u65b9 GitHub \u4e0b\u8f7d volatility2 \u7684\u6e90\u7801\uff08\u4e0d\u8981 volatility3\uff09</li> <li>\u76f4\u63a5\u5728\u672c\u673a/\u865a\u62df\u673a/ wsl \u4e0a\u914d\u7f6e\u73af\u5883\uff0c\u6210\u529f\u8fd0\u884c</li> <li>\u590d\u73b0\u8bfe\u4e0a\u4e24\u9053\u4f8b\u9898\u4e4b\u4e00\uff08\u591a\u505a\u4e0d\u52a0\u5206\uff09<ul> <li>N1CTF 2022: just find flag\uff0c\u9644\u4ef6\u4e0b\u8f7d\uff08\u6d59\u5927\u7f51\u76d8\uff09</li> <li>BMZCTF: Administrator's secret\uff0c\u9644\u4ef6\u4e0b\u8f7d\uff08\u6d59\u5927\u7f51\u76d8\uff09</li> </ul> </li> <li>\u6ce8\u610f/\u63d0\u793a\uff1a<ul> <li>\u4e0d\u8981\u4f7f\u7528\u4e0b\u8f7d\u5373\u7528\u3001\u6253\u5305\u597d\u7684\u7248\u672c\uff0c\u8bf7\u81ea\u5df1\u914d\u7f6e\u73af\u5883\u4ece python \u8fd0\u884c</li> <li>\u4e0d\u8981\u4f7f\u7528 volatility 3.x \u7248\u672c</li> <li>python \u7684\u73af\u5883\u7ba1\u7406\u63a8\u8350\u4f7f\u7528 conda\uff08miniconda \u6216 anaconda \u90fd\u53ef\u4ee5\uff09</li> <li>\u53ef\u4ee5\u53c2\u8003\u7f51\u4e0a\u7684\u5b89\u88c5\u6559\u7a0b\u7b49\u7b49</li> </ul> </li> </ul> <p>\u8bf7\u5728\u62a5\u544a\u4e2d\u5199\u51fa\u4f60\u914d\u7f6e volatility \u7684\u8fc7\u7a0b\uff08\u5305\u62ec\u547d\u4ee4\u3001\u5fc5\u8981\u7684\u622a\u56fe\u7b49\uff09\uff0c\u4ee5\u53ca\u5728\u914d\u7f6e\u73af\u5883\u65f6\u9047\u5230\u7684\u95ee\u9898\u4ee5\u53ca\u89e3\u51b3\u65b9\u6cd5\uff08\u5982\u679c\u6709\u7684\u8bdd\uff09\u3002\u540c\u65f6\u5728\u62a5\u544a\u4e2d\u4e5f\u8bf7\u7ed9\u51fa\u4f60\u590d\u73b0\u9898\u76ee\u7684\u5177\u4f53\u6b65\u9aa4\uff0c\u5305\u62ec\u547d\u4ee4\u3001\u5fc5\u8981\u7684\u622a\u56fe\u7b49\u3002</p>"},{"location":"topic/misc-lab3/#challenge-5","title":"Challenge 5","text":"<p>\u5c1d\u8bd5\u5b8c\u6210\u6821\u5df4\u4e0a\u7684 pysandbox \u7cfb\u5217\u9898\u76ee\uff08\u4e00\u5171\u6709\u56db\u9053\uff0c\u4f46\u5b9e\u9645\u4e0a\u4e00\u5171 16 \u4e2a\u7248\u672c\uff09\uff1a</p> <ul> <li>pysandbox6: zjusec.com/challenges/69\uff0810 \u5206\uff09</li> <li>pysandbox10: zjusec.com/challenges/70\uff0810 \u5206\uff09</li> <li>pysandbox13: zjusec.com/challenges/71\uff08\u4e0d\u52a0\u5206\uff0c\u4f46\u9f13\u52b1\u5c1d\u8bd5\uff09</li> <li>pysandbox16: zjusec.com/challenges/72\uff08\u4e0d\u52a0\u5206\uff0c\u4f46\u9f13\u52b1\u5c1d\u8bd5\uff09</li> </ul> <p>\u53ef\u4ee5\u53c2\u8003\u8bfe\u4e0a\u7ed9\u7684 python \u6c99\u7bb1\u9003\u9038\u7b14\u8bb0\u5b66\u4e60\uff1anote.tonycrane.cc/ctf/misc/escapes/pysandbox\u3002</p> <p>\u8bf7\u5b8c\u6210\u5bf9\u5e94\u9898\u76ee\uff0c\u63d0\u4ea4 flag \u6210\u529f\uff0c\u5e76\u5728\u5b9e\u9a8c\u62a5\u544a\u4e2d\u5199\u51fa\u4f60\u7684\u89e3\u9898\u601d\u8def\u548c\u5177\u4f53\u8fc7\u7a0b\u3002</p>"},{"location":"topic/misc-lab3/#bonus-task","title":"Bonus Task","text":"<p>misc \u7cfb\u5217\u4e09\u8282\u8bfe\u5df2\u7ecf\u7ed3\u675f\u4e86\uff0c\u5e0c\u671b\u4f60\u5df2\u7ecf\u5bf9 misc \u7c7b\u9898\u76ee\u6709\u4e86\u57fa\u672c\u7684\u4e86\u89e3\uff0c\u5e76\u4e14\u5b66\u4f1a\u4e86\u4e00\u4e9b\u57fa\u7840 misc \u9898\u76ee\u7684\u505a\u6cd5\uff0c\u517b\u6210\u4e86\u4e00\u70b9\u505a misc \u7684\u57fa\u672c\u601d\u7ef4\u3002</p> <p>\u8fd9 20 \u5206\u6211\u5e0c\u671b\u4f60\u80fd\u591f\u81ea\u5df1\u56de\u987e\u4e00\u4e0b\u6211\u4eec\u7684\u8fd9\u4e09\u8282\u8bfe\uff0c\u56de\u987e\u4e00\u4e0b\uff1a</p> <ol> <li>\u81ea\u5df1\u90fd\u5b66\u5230\u4e86\u4e9b\u4ec0\u4e48\uff0c\u5b66\u4f1a\u4e86\u4ec0\u4e48\uff0c\u6216\u8005\u6ca1\u5b66\u4f1a\u4ec0\u4e48</li> <li>\u6709\u4ec0\u4e48\u5fc3\u5f97\u4f53\u4f1a\uff0c\u6709\u4ec0\u4e48\u611f\u609f\uff0c\u5bf9\u4e8e misc \u9898\u6709\u4ec0\u4e48\u8ba4\u8bc6</li> <li>\u5bf9\u4e8e misc \u8fd9\u4e09\u8282\u8bfe\u600e\u4e48\u8bc4\u4ef7\uff0c\u6709\u6ca1\u6709\u4ec0\u4e48\u60f3\u8bf4\u7684\uff0c\u6216\u8005\u60f3\u5410\u69fd\u7684</li> <li>\u6709\u6ca1\u6709\u4ec0\u4e48\u4f60\u60f3\u5b66\u4f46\u6ca1\u5b66\u5230\u7684\u4e1c\u897f\uff0c\u6216\u8005\u5e0c\u671b\u6211\u4eec\u6539\u8fdb\u7684\u5730\u65b9</li> <li>\u4ee5\u540e\u8fd8\u60f3\u4e0d\u60f3\u7ee7\u7eed\u5b66\u4e60 CTF\uff0c\u7ee7\u7eed\u5b66\u4e60 misc \u4e4b\u7c7b\u7684</li> <li>\u4efb\u4f55\u4efb\u4f55\u4f60\u60f3\u8981\u8bf4\u7684\u8bdd\u2026\u2026</li> </ol> <p>\u8bf7\u601d\u8003\u4e00\u4e0b\u8fd9\u4e9b\u95ee\u9898\uff0c\u5728\u62a5\u544a\u91cc\u7559\u4e0b\u4f60\u60f3\u8bf4\u7684\u8bdd\u3002\u6211\u4eec\u4e0d\u4f1a\u6839\u636e\u4f60\u603b\u7ed3\u7684\u7acb\u573a\u6216\u8005\u5b57\u6570\u6765\u8fdb\u884c\u6253\u5206\uff0c\u6211\u4eec\u6253\u5206\u7684\u6807\u51c6\u662f\u4f60\u603b\u7ed3\u7684\u6001\u5ea6\uff0c\u6362\u53e5\u8bdd\u8bf4\uff0c\u53ea\u8981\u4f60\u8ba4\u771f\u601d\u8003\u4e86\u8fd9\u4e9b\u95ee\u9898\uff08\u4e0d\u9700\u8981\u5168\u90e8\uff09\uff0c\u8868\u8fbe\u51fa\u4e86\u4f60\u7684\u60f3\u6cd5\uff0c\u6211\u4eec\u5c31\u4f1a\u7ed9\u4f60\u8fd9 20 \u5206\u3002</p> <p>misc \u90e8\u5206\u7684 lab \u5230\u8fd9\u91cc\u4e5f\u5c31\u7ed3\u675f\u4e86\uff0c\u5e0c\u671b\u8fd9\u4e09\u6b21\u8bfe\u3001\u4e09\u4e2a lab \u7ed9\u4f60\u5e26\u6765\u4e86\u826f\u597d\u7684\u4f53\u9a8c\uff0c\u4e5f\u5e0c\u671b\u4f60\u80fd\u591f\u771f\u6b63\u7684\u6709\u6240\u6536\u83b7\u3002\u559c\u6b22\u7684\u8bdd\u4e5f\u5e0c\u671b\u4f60\u80fd\u5728\u8fd9\u6761\u8def\u4e0a\u575a\u6301\u4e0b\u53bb\u3002\u4ee5\u540e\u5728\u5b66\u4e60 CTF\u3001\u5b66\u4e60 misc \u65f6\u6709\u4ec0\u4e48\u95ee\u9898\u4e5f\u53ef\u4ee5\u6765\u627e\u6211\uff08TonyCrane\uff09\u4e00\u8d77\u63a2\u8ba8\uff0c\u671f\u5f85\u6211\u4eec\u80fd play misc together\uff01</p>"},{"location":"topic/pwn-lab2/","title":"Pwn Lab 2\uff1aBOF and ROP","text":"<p>\u672c\u8282 Lab \u7531\u4ee5\u4e0b\u5185\u5bb9\u7ec4\u6210\uff1a</p> <ol> <li>\u7406\u89e3\u6808\u7ed3\u6784\u5e76\u7f16\u5199\u4e00\u4e2a stack parser (10 points)</li> <li>\u63a2\u7a76\u6808\u6ea2\u51fa + shellcode \u7ed3\u5408\u7684\u9898\u76ee (30 points)</li> <li>\u8bfe\u4e0a\u6f14\u793a\u8fc7\u7684 ROP \u57fa\u7840\u9898  (30 points)</li> <li>\u6821\u5df4\u4e0a\u7684 ROP \u7684\u57fa\u7840\u9898  (30 points)</li> <li>bonus: \u6f0f\u6d1e\u4e0d\u8fa3\u4e48\u660e\u663e\u7684\u4e00\u4e2a BOF \u9898 (20 points)</li> </ol> <p>\u76f8\u4fe1\u5b8c\u6210\u8fd9\u4e9b\u9898\u76ee\u540e\u4f1a\u52a0\u6df1\u4f60\u5bf9\u6808\u3001\u6808\u6ea2\u51fa\u4ee5\u53ca ROP \u7406\u89e3</p>"},{"location":"topic/pwn-lab2/#challenge-1","title":"Challenge 1","text":"<p>\u5982\u8bfe\u5802\u4e0a\u6240\u8ff0\uff0c\u8fd9\u91cc\u8981\u6c42\u5927\u5bb6\u7f16\u5199\u4e00\u4e2a stack parser \u5bf9\u7ed9\u5b9a\u7684\u6808\u6570\u636e\u8fdb\u884c\u89e3\u6790\uff0c\u6253\u5370\u51fa\u6570\u636e\u4e2d\u7684\u6808\u5e27\uff0c\u8981\u6c42</p> <ul> <li>\u9898\u76ee\u9644\u4ef6</li> <li>\u7f16\u7a0b\u8bed\u8a00\u4efb\u9009\uff0c\u9009\u81ea\u5df1\u719f\u6089\u7684\u5373\u53ef</li> <li>\u6253\u5370\u7ed3\u679c\u6807\u6ce8\u6808\u5e27\u7f16\u53f7\uff0c\u5982\u4e0b\u56fe\u6709\u8f93\u51fa\u989d\u5916\u7684 <code>frame #XXX</code> \u4fe1\u606f</li> <li>\u6253\u5370\u7ed3\u679c\u6807\u6ce8\u6808\u5e27\u4e2d\u7684\u5185\u5bb9\uff0c\u5982\u4e0b\u56fe\u4e2d\u989d\u5916\u8f93\u51fa\u7684 <code>(LOCAL)</code> \u8868\u793a\u4e34\u65f6\u53d8\u91cf\u3001<code>(FRAME POINTER)</code> \u8868\u793a\u5b58\u50a8\u7684\u5e27\u6307\u9488\u3001<code>(RET ADDR)</code> \u8868\u793a\u5b58\u50a8\u7684\u8fd4\u56de\u5730\u5740</li> </ul> <p></p> <p>\u5176\u4e2d\u7ed9\u5b9a\u7684\u6808\u6570\u636e\u547d\u540d\u7ec6\u8282\u662f <code>X_Y.bin</code>\uff0c\u5176\u4e2d <code>X</code> \u662f\u5f53\u524d\u5e27\u5b8c\u6210\u5e03\u7f6e\u540e\u7684 <code>rsp</code> \u503c\uff0c<code>Y</code> \u662f\u5f53\u524d\u5e27\u5b8c\u6210\u5e03\u7f6e\u540e\u7684 <code>rbp</code> \u7684\u503c\uff0c\u6570\u636e\u6587\u4ef6\u5373\u662f\u4ece <code>X</code> \u5904\u5bf9\u5e94\u7684\u5730\u5740\u5f00\u59cb\u8f6c\u50a8\u7684</p> <p>\u4ea4\u4e0a\u6765\u540e\u6211\u4eec\u4f1a\u7528\u989d\u5916\u7684\u6d4b\u8bd5\u7528\u4f8b\u8dd1\u4e00\u4e0b\u7684\uff0c\u6240\u4ee5\u4e0d\u8981\u53ea\u505a\u7b80\u5355\u7684 print\uff0c\u8981\u771f\u6b63\u7684\u505a parse \u54e6</p> <p>\u53ef\u4ee5\u901a\u8fc7\u6808\u4e0a\u7684\u503c\u731c\u6d4b\u8fd9\u662f\u4e2a\u4ec0\u4e48\u51fd\u6570\u4e48\uff1f</p>"},{"location":"topic/pwn-lab2/#challenge-2","title":"Challenge 2","text":"<p>\u8fd9\u91cc\u6709\u4e00\u9053\u6bd4\u8bfe\u5802\u4e0a\u8bb2\u89e3\u7684 <code>ret2sc</code> \u7a0d\u5fae\u590d\u6742\u4e00\u70b9\u7684 <code>ret2sc_revenge</code>\uff0c\u8bf7\u5b8c\u6210\u5bf9\u5176\u7684\u6f0f\u6d1e\u5206\u6790\u4ee5\u53ca\u5229\u7528</p> <ul> <li>\u9898\u76ee\u9644\u4ef6</li> <li>\u9898\u76ee\u90e8\u7f72\u5728\u6821\u7f51 IP: <code>10.214.160.13</code>, Port: <code>11020</code></li> </ul> <p>\u8bf7\u5728\u62a5\u544a\u4e2d\u9644\u4e0a\u6f0f\u6d1e\u5206\u6790\u4ee5\u53ca\u505a\u6cd5\uff0c\u7ed9\u51fa\u6210\u529f\u62ff\u5230 flag \u7684\u622a\u56fe\uff0c\u5e76\u5c06\u653b\u51fb\u4ee3\u7801\u4ee5\u9644\u4ef6\u5f62\u5f0f\u4e0a\u4f20</p>"},{"location":"topic/pwn-lab2/#challenge-3","title":"Challenge 3","text":"<p>\u8bfe\u4e0a\u6f14\u793a\u8fc7\u4e00\u904d <code>ropbaby</code> \u7684\u505a\u6cd5\u548c\u601d\u8def\uff0c\u8bf7\u590d\u73b0\u5e76\u5b9e\u73b0\u6253\u8fdc\u7a0b\uff0c\u62ff flag</p> <ul> <li>\u9898\u76ee\u9644\u4ef6</li> <li>\u9898\u76ee\u90e8\u7f72\u5728\u6821\u7f51 IP: <code>10.214.160.13</code>, Port: <code>11021</code></li> </ul> <p>\u8981\u6c42 ROP \u901a\u8fc7 system \u6216\u8005 execve \u8fd9\u4e24\u4e4b\u4e00\u7684 libc \u51fd\u6570\u5b8c\u6210\u5f39 shell</p> <p>\u8bf7\u5728\u62a5\u544a\u4e2d\u9644\u4e0a\u6f0f\u6d1e\u5206\u6790\u4ee5\u53ca\u505a\u6cd5\uff0c\u7ed9\u51fa\u6210\u529f\u62ff\u5230 flag \u7684\u622a\u56fe\uff0c\u5e76\u5c06\u653b\u51fb\u4ee3\u7801\u4ee5\u9644\u4ef6\u5f62\u5f0f\u4e0a\u4f20</p>"},{"location":"topic/pwn-lab2/#challenge-4","title":"Challenge 4","text":"<p>\u6821\u5df4\u4e0a\u6709\u4e00\u9053 32 \u4f4d\u7b80\u5355\u7684\u6808\u6ea2\u51fa + ROP \u54e6\uff0c\u8fd8\u4e0d\u5feb\u52a0\u6cb9\u79d2\u6389</p> <ul> <li>\u9898\u76ee\u4fe1\u606f</li> </ul> <p>\u8bf7\u5728\u62a5\u544a\u4e2d\u9644\u4e0a\u6f0f\u6d1e\u5206\u6790\u4ee5\u53ca\u505a\u6cd5\uff0c\u7ed9\u51fa\u6210\u529f\u62ff\u5230 flag \u7684\u622a\u56fe\uff0c\u5e76\u5c06\u653b\u51fb\u4ee3\u7801\u4ee5\u9644\u4ef6\u5f62\u5f0f\u4e0a\u4f20</p>"},{"location":"topic/pwn-lab2/#bonus","title":"Bonus","text":"<p>\u6765\u6311\u6218\u96f7\u795e\u5728\u4e4b\u524d\u7684 Hackergame \u70ed\u8eab\u65f6\u5019\u51fa\u7684\u8d5b\u9898\u5427 \\\u96f7\u795e/\\\u96f7\u795e/</p> <ul> <li>\u9898\u76ee\u4fe1\u606f</li> </ul>"},{"location":"topic/pwn-lab3/","title":"Pwn Lab 3\uff1aMore ROP plz","text":"<p>\u672c\u8282 Lab \u7531\u4ee5\u4e0b\u5185\u5bb9\u7ec4\u6210\uff1a</p> <ol> <li>\u6309\u7167\u8bfe\u4e0a\u7684\u6f14\u793a\uff0c\u7206\u7834 32 \u7a0b\u5e8f\u7684\u6808\u968f\u673a\u5316\u5e76\u901a\u8fc7 shellcode \u8fdb\u884c\u653b\u51fb (20 points)</li> <li>\u6309\u7167\u8bfe\u4e0a\u7684\u6f14\u793a\uff0c\u9009\u7528 one_gadget \u6216\u8005 ret2csu \u7684\u65b9\u6cd5\u518d\u6b21\u5b8c\u6210 lab2 \u4e2d\u7684 ropbaby (20 points)</li> <li>\u5b8c\u6210 ropbasic \u9898\u76ee (25 points)</li> <li>\u5b8c\u6210 ropbasic-harden \u9898\u76ee (35 points)</li> <li>Bonus: \u5b8c\u6210\u6821\u5df4\u7684\u65b0\u9898\u76ee off-by-null (30 points)</li> </ol> <p>\u76f8\u4fe1\u5b8c\u6210\u8fd9\u4e9b\u9898\u76ee\u540e\uff0c\u76f8\u4fe1\u4f60\u5df2\u7ecf\u53ef\u4ee5\u81ea\u4fe1\u5730 claim \u81ea\u5df1\u662f master of ROP \u4e86</p>"},{"location":"topic/pwn-lab3/#challenge-1","title":"Challenge 1","text":"<p>\u76f8\u6bd4\u4e8e\u8bfe\u5802\u4e0b\u53d1\u7684 <code>bruteforce_example</code>\uff0c\u8fd9\u91cc\u7684 <code>bruteforce_homework</code> \u7a0d\u5fae\u4fee\u6539\u4e86\u4e00\u4e0b\u6808\u7f13\u51b2\u533a\u7684\u5927\u5c0f\uff0c\u8be6\u89c1\u9644\u4ef6</p> <p>\u8bf7\u901a\u8fc7\u7f16\u5199\u6b63\u786e\u7684 exploit \u751f\u6210\u5e26\u6709 shellcode \u7684 <code>badfile</code>\uff0c\u7c7b\u4f3c\u8bfe\u5802\u4e0a\u7684\u6f14\u793a\u53bb\u672c\u5730\u5faa\u73af\u7684\u7206\u7834 32 \u4f4d\u4e0b\u7684\u6808\u968f\u673a\uff0c\u8bf7\u5728\u62a5\u544a\u4e2d\u7ed9\u51fa\u6700\u540e\u7206\u7834\u6210\u529f\u62ff\u5230 shell \u7684\u622a\u56fe</p>"},{"location":"topic/pwn-lab3/#challenge-2","title":"Challenge 2","text":"<p>\u4e0a\u6b21 lab2 \u4e2d\u7684 ropbaby \u6211\u4eec\u8981\u6c42\u901a\u8fc7 ROP \u53bb\u6267\u884c <code>system</code> \u6216\u8005 <code>execve</code>\uff0c\u8fd9\u8282\u8bfe\u7ed3\u675f\u540e\uff0c\u8bf7\u901a\u8fc7 <code>one_gadget</code> \u7684\u65b9\u5f0f\u6216\u8005 <code>ret2csu</code> \u7684\u65b9\u5f0f\u8fdb\u884c ROP \u653b\u51fb\uff0c\u8bf7\u5728\u62a5\u544a\u4e2d\u7ed9\u51fa\u6210\u529f\u5229\u7528\u7684\u622a\u56fe\u4ee5\u53ca\u5c06\u76f8\u5173\u4ee3\u7801\u7684\u6253\u5305\u4e0a\u4f20</p>"},{"location":"topic/pwn-lab3/#challenge-3","title":"Challenge 3","text":"<p>\u5728 <code>ropbaby</code> \u7684\u57fa\u7840\u4e0a\uff0c\u589e\u52a0\u4e86\u6808\u4fdd\u62a4 stack canary\uff0c\u5c31\u6210\u4e86 <code>ropbasic</code>\u3002\u8bf7\u5b8c\u6210\u5bf9\u5176\u7684\u6f0f\u6d1e\u5206\u6790\u4ee5\u53ca\u5229\u7528</p> <ul> <li>\u9898\u76ee\u9644\u4ef6</li> <li>\u9898\u76ee\u90e8\u7f72\u5728\u6821\u7f51 IP: <code>10.214.160.13</code>, Port: <code>11022</code></li> </ul> <p>\u8bf7\u5728\u62a5\u544a\u4e2d\u9644\u4e0a\u6f0f\u6d1e\u5206\u6790\u4ee5\u53ca\u505a\u6cd5\uff0c\u7ed9\u51fa\u6210\u529f\u62ff\u5230 flag \u7684\u622a\u56fe\uff0c\u5e76\u5c06\u653b\u51fb\u4ee3\u7801\u4ee5\u9644\u4ef6\u5f62\u5f0f\u4e0a\u4f20</p>"},{"location":"topic/pwn-lab3/#challenge-4","title":"Challenge 4","text":"<p>\u5728 <code>ropbasic</code> \u7684\u57fa\u7840\u4e0a\uff0c\u589e\u52a0\u4e86 SECCOMP \u4fdd\u62a4\uff0c\u5c31\u6210\u4e86 <code>ropbasic-harden</code>\u3002\u8bf7\u5b8c\u6210\u5bf9\u5176\u7684\u6f0f\u6d1e\u5206\u6790\u4ee5\u53ca\u5229\u7528</p> <ul> <li>\u9898\u76ee\u9644\u4ef6</li> <li>\u9898\u76ee\u90e8\u7f72\u5728\u6821\u7f51 IP: <code>10.214.160.22</code>, Port: <code>50003</code></li> </ul> <p>hint: \u6ce8\u610f\u505a orw \u7684\u65f6\u5019\uff0c\u4e0d\u662f\u53bb\u8c03\u7528 libc \u51fd\u6570\u91cc\u7684 open/read/write \u54e6\uff0c\u800c\u662f\u8981\u60f3\u529e\u6cd5 ROP \u505a\u5177\u4f53\u7cfb\u7edf\u8c03\u7528\u54e6</p>"},{"location":"topic/pwn-lab3/#bonus","title":"Bonus","text":"<p>\u8bb0\u5f97\u8bfe\u4e0a\u63d0\u5230\u7684\u4e00\u53e5\uff0c\u5bf9\u4e8e\u6808\u8fc1\u79fb\uff0c\u5373\u4f7f\u662f 1 \u4e2a\u5b57\u8282\uff0c\u751a\u81f3\u662f\u7a7a\u5b57\u8282\uff0c\u4e5f\u8db3\u591f\u5f3a\u5927\u4e48\uff1f\u90a3\u4e48\uff0c\u5c31\u8ba9\u6821\u5df4\u7684\u4e00\u9053\u65b0\u9898\u76ee\u6765\u5b9e\u8bc1\u8fd9\u4e00\u70b9\u5427</p> <ul> <li>\u9898\u76ee\u4fe1\u606f</li> </ul> <p>\u6ce8\u610f\uff1a 1. \u8bf7\u672c\u5730\u6210\u529f\u6d4b\u8bd5\u540e\u518d\u653b\u51fb\u8fdc\u7a0b 2. \u8bf7\u5728\u62a5\u544a\u4e2d\u8be6\u7ec6\u7ed9\u51fa\u653b\u51fb\u7684\u601d\u8def\uff0c\u4ee5\u53ca\u653b\u51fb\u4ee3\u7801\u7684\u5206\u6790\uff0c\u9644\u4e0a\u6700\u540e\u7684\u6210\u529f\u7684\u622a\u56fe</p>"},{"location":"topic/rev-lab2/","title":"Rev Lab 2: CrackMe &amp; Malware","text":"<p>\u672c\u8282 Lab \u7531\u4ee5\u4e0b\u4e24\u90e8\u5206\u7ec4\u6210\uff0c\u6574\u4f53\u8d85\u51fa100\u5206\u7684\u90e8\u5206\u5c06\u4f5c\u4e3a bonus\uff1a</p> <ul> <li>Task 1: \u8bfe\u5802\u4f8b\u9898++\uff08110\u5206\uff09<ul> <li>CrackMe \u90e8\u5206 (60\u5206)</li> <li>Malware \u90e8\u5206 (50\u5206)</li> </ul> </li> <li>Task 2: \u7b80\u5355\u7684\u52d2\u7d22\u8f6f\u4ef6\uff0840\u5206\uff09</li> </ul>"},{"location":"topic/rev-lab2/#task-1","title":"Task 1","text":""},{"location":"topic/rev-lab2/#part-1-60-points","title":"Part 1 (60 points)","text":"<p>\u8bfe\u4e0a\u6211\u4eec\u8bb2\u89e3\u4e86\u5982\u4f55\u628a 010 Editor \u53d8\u4e3a Freeware\uff0c\u5e76\u548c\u5927\u5bb6\u4e00\u8d77\u5206\u6790\u4e86\u6821\u9a8c\u5e8f\u5217\u53f7\u7684\u6838\u5fc3\u51fd\u6570 <code>sub_14036E740</code> \u4e2d 0x9C \u8fd9\u4e2a\u5206\u652f\u7684\u60c5\u51b5, \u9644\u4ef6 <code>keygen.py</code>\uff08\u4e0b\u8f7d\u94fe\u63a5\uff09\u4e3a\u5bf9\u5e94\u7684 python \u6ce8\u518c\u673a\u4ee3\u7801\u3002\u8bf7\u56de\u987e\u8bfe\u4e0a\u8bb2\u89e3\u7684\u5185\u5bb9\uff0c\u53c2\u8003\u7ed9\u51fa\u7684\u6ce8\u518c\u673a\u4ee3\u7801\uff0c\u5c1d\u8bd5\u7f16\u5199 0xAC \u5206\u652f\u7684\u6ce8\u518c\u673a\uff08\u4e0d\u9650\u7f16\u7a0b\u8bed\u8a00\uff09\uff0c\u5e76\u63d0\u4ea4 Writeup\uff0c\u8981\u6c42\u5305\u542b\uff1a</p> <ol> <li>\u5206\u6790 010 Editor \u7684\u6d41\u7a0b\u53ca patch \u7684\u8fc7\u7a0b\u548c\u539f\u7406 \uff0810 points\uff09</li> <li>\u5982\u4f55\u5b9a\u4f4d\u5230\u6821\u9a8c\u5e8f\u5217\u53f7\u7684\u6838\u5fc3\u51fd\u6570\u4ee5\u53ca\u6211\u4eec\u671f\u671b\u8fd9\u4e2a\u51fd\u6570\u8fd4\u56de\u4ec0\u4e48 \uff0810 points\uff09</li> <li>\u5206\u6790\u6821\u9a8c\u5e8f\u5217\u53f7\u7b97\u6cd5\u7684\u6d41\u7a0b\uff0c\u9610\u8ff0\u8f93\u5165\u7684 Name \u4e0e Password \u662f\u5982\u4f55\u88ab\u6821\u9a8c\u7684 \uff0820 points\uff09</li> <li>\u4f60\u6700\u7ec8\u7f16\u5199\u7684 0xAC \u5206\u652f\u6ce8\u518c\u673a\u4ee3\u7801\u4ee5\u53ca\u5728 010 Editor \u4e2d\u6210\u529f\u6ce8\u518c\u7684\u622a\u56fe \uff0820 points\uff09</li> </ol> <p>Tips\uff1a</p> <ol> <li>\u7f16\u5199\u6ce8\u518c\u673a\u7684\u601d\u8def\u5e76\u4e0d\u540c\u4e8e\u89e3 CTF \u9898\u76ee\uff0c\u7b54\u6848\u5e76\u4e0d\u662f\u552f\u4e00\u7684\uff0c\u4f60\u53ea\u9700\u8981\u627e\u5230\u6ee1\u8db3\u6761\u4ef6\u7684\u4e00\u79cd\u8f93\u5165\u5373\u53ef</li> <li>0x9C \u5206\u652f\u7684\u60c5\u51b5\u6ce8\u518c\u6210\u529f\u540e 010 Editor \u8fd0\u884c\u622a\u56fe\u5982\u4e0b\uff1a</li> </ol> <p></p>"},{"location":"topic/rev-lab2/#part-2-50-points","title":"Part 2 (50 points)","text":"<p>\u9898\u76ee\u4e0b\u8f7d\u94fe\u63a5</p> <p>\u8bfe\u4e0a\u6211\u4eec\u5206\u6790\u4e86\u4f7f\u7528 Go \u8bed\u8a00\u7f16\u5199\u7684\u4f4e\u914d\u7248\u201c\u718a\u732b\u70e7\u9999\u201d\uff0c\u8bf7\u56de\u987e\u8bfe\u4e0a\u8bb2\u89e3\u7684\u5185\u5bb9\uff0c\u56de\u7b54\u4ee5\u4e0b\u95ee\u9898\uff1a</p> <ol> <li>\u5728\u7a0b\u5e8f\u542f\u52a8\u540e\uff0c\u5b83\u4f7f\u7528\u4e86\u4ec0\u4e48\u65b9\u6cd5\u6765\u9690\u85cf\u81ea\u5df1\uff1f (10 points)</li> <li>\u8be5\u8f6f\u4ef6\u662f\u5982\u4f55\u5b9e\u73b0\u6301\u4e45\u5316\u7684\uff1f\uff0810 points\uff09</li> <li>\u7a0b\u5e8f\u5bf9\u54ea\u4e9b\u76ee\u6807\u6587\u4ef6\u6709\u6076\u610f\u884c\u4e3a\uff0c\u5206\u522b\u505a\u4e86\u4ec0\u4e48\u64cd\u4f5c\uff1f\uff0815 points\uff09</li> <li>\u5982\u679c\u6211\u7684\u7cfb\u7edf\u4e0d\u5e78\u88ab\u8be5\u8f6f\u4ef6\u611f\u67d3\uff0c\u5e94\u8be5\u5982\u4f55\u6062\u590d\uff1f\u8bf7\u7f16\u5199\u4e00\u4e2a\u6062\u590d\u7a0b\u5e8f\uff0c\u5bf9\u7f16\u7a0b\u8bed\u8a00\u4e0d\u505a\u8981\u6c42 \uff0815 points\uff09</li> </ol> <p>Tips:</p> <ol> <li>\u4e3a\u4e86\u51cf\u5c11\u5927\u5bb6\u5728\u9006\u5411\u8fc7\u7a0b\u4e2d\u7684\u5de5\u4f5c\u91cf\uff0c\u8fd9\u91cc\u7ed9\u51fa\u90e8\u5206\u7a0b\u5e8f\u6e90\u7801\uff1a</li> </ol> <pre><code>func walkDisk(root string) error {\nhomeDir, err := os.UserHomeDir()\ncheckError(err)\nskipPath := homeDir + `\\AppData\\Local\\Microsoft\\Windows`\n// Try to be nice XD\nif root == `C:` {\nroot = homeDir\n}\nstack := []string{root}\nfor len(stack) &gt; 0 {\ndir := stack[len(stack) - 1]\nstack = stack[:len(stack) - 1]\nentries, err := os.ReadDir(dir)\nif err != nil {\ncontinue\n}\nfor _, entry := range entries {\nif entry.IsDir() {\nsubDir := dir + `\\` + entry.Name()\nif strings.HasPrefix(subDir, skipPath) {\ncontinue\n}\nstack = append(stack, subDir)\n} else {\npath := dir + `\\` + entry.Name()\nif err := infectSignleFile(path); err != nil {\ncontinue\n}\n}\n}\n}\nreturn nil\n}\n</code></pre> <ol> <li>\u6211\u4eec\u5728\u8bfe\u4e0a\u8bb2\u89e3\u4e86 Go \u8bed\u8a00\u5728 1.17 \u7248\u672c\u540e\u66f4\u65b0\u4e86\u8c03\u7528\u7ea6\u5b9a\uff08Calling Convention\uff09\uff0c\u901a\u8fc7\u7f16\u5199\u7b80\u5355\u7684\u793a\u4f8b\u7a0b\u5e8f\u5e76\u4f7f\u7528\u7f16\u8bd1\u9009\u9879 <code>-gcflags \"-N -l\"</code> \u5173\u95ed\u4f18\u5316\u5373\u53ef\u5728 IDA \u4e2d\u89c2\u5bdf\u51fd\u6570\u7684\u53c2\u6570\u53ca\u8fd4\u56de\u503c\u662f\u901a\u8fc7\u54ea\u4e9b\u5bc4\u5b58\u5668\u4f20\u9012\u7684\u3002\u5728\u5206\u6790\u65f6\uff0c\u4e5f\u4e0d\u8981\u5fd8\u8bb0\u7ed3\u5408\u52a8\u6001\u8c03\u8bd5\uff0c\u540c\u65f6\u786e\u4fdd\u8c03\u8bd5\u73af\u5883\u5728\u865a\u62df\u673a\u4e2d\u3002</li> </ol>"},{"location":"topic/rev-lab2/#task-2","title":"Task 2","text":"<p>\u9898\u76ee\u4e0b\u8f7d\u94fe\u63a5</p> <p>\u975e\u5e38\u53cb\u597d\u7684\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u751a\u81f3\u611f\u89c9\u4e0d\u5230\u4e1d\u6beb\u5a01\u80c1\uff0c\u5b8c\u6210\u8be5\u9898\u76ee\u5e76\u63d0\u4ea4\uff1a</p> <ol> <li>flag \u5185\u5bb9\u53ca Writeup (40 points)</li> </ol>"},{"location":"topic/rev-lab2/#hint","title":"Hint","text":"<ol> <li>\u8be5\u9898\u76ee\u7684\u5e74\u4ee3\u8f83\u4e3a\u4e45\u8fdc\uff0c\u5982\u679c\u65e0\u6cd5\u8fd0\u884c\uff08\u5982\u63d0\u793a\u7f3a\u5c11 dll\uff09\u4e5f\u65e0\u9700\u62c5\u5fc3\uff0c\u9759\u6001\u5206\u6790\u5c31\u8db3\u4ee5\u89e3\u51fa\u8fd9\u9053\u9898\u76ee</li> <li>\u4f60\u53ef\u80fd\u9700\u8981\u4e86\u89e3\u4e00\u4e0b\u4ec0\u4e48\u662f\u58f3\uff0c\u8fd9\u4e2a\u7a0b\u5e8f\u7528\u5230\u4e86\u4ec0\u4e48\u58f3\u8fdb\u884c\u4fdd\u62a4\uff0c\u4ee5\u53ca\u662f\u5426\u6709\u5bf9\u5e94\u7684\u8131\u58f3\u5de5\u5177</li> <li>\u4e5f\u8bb8\u9700\u8981\u4e00\u70b9\u5de7\u601d\uff0c\u4e86\u89e3\u4e00\u4e0b Windows \u53ef\u6267\u884c\u7a0b\u5e8f\u6587\u4ef6\u683c\u5f0f\uff08PE \u683c\u5f0f\uff09\u4e2d\u6709\u6ca1\u6709\u7279\u6b8a\u7684\u90e8\u5206</li> </ol>"},{"location":"topic/rev-lab3/","title":"Rev Lab 3: \u8ff7\u5bab\u95ee\u9898","text":"<p>\u9006\u5411\u5206\u6790\u7684\u8fc7\u7a0b\u867d\u7136\u662f\u8f83\u4e3a\u67af\u71e5\u751a\u81f3\u662f\u8ba9\u4eba\u5934\u5927\u7684\uff0c\u4f46\u4ece\u4e00\u56e2\u4e71\u9ebb\u6beb\u65e0\u5934\u7eea\u5230\u201c\u590d\u884c\u6570\u5341\u6b65\uff0c\u8c41\u7136\u5f00\u6717\u201d\u8fd9\u4e00\u8fc7\u7a0b\u53c8\u4f55\u5c1d\u4e0d\u8ba9\u4eba\u795e\u5f80\u3002\u5e0c\u671b\u5927\u5bb6\u5728\u672c\u8bfe\u7a0b\u7684\u9006\u5411\u90e8\u5206\u90fd\u80fd\u6709\u6240\u6536\u83b7\uff0c\u4f53\u4f1a\u5230\u62c6\u89e3\u7a0b\u5e8f\u7684\u4e50\u8da3\u3002</p> <p>\u672c\u8282 Lab \u662f\u9006\u5411\u4e13\u9898\u7684\u6700\u540e\u4e00\u6b21\u4f5c\u4e1a\uff0c\u5185\u5bb9\u8f83\u4e3a\u8f7b\u677e\uff0c\u5e0c\u671b\u5927\u5bb6\u73a9\u5f97\u6109\u5feb\u3002</p>"},{"location":"topic/rev-lab3/#100-points","title":"\u306f\u3061\u307f (100 points)","text":"<p>\u9898\u76ee\u4e0b\u8f7d\u94fe\u63a5</p> <p>\u306f\u3061\u307f\u3092\u8210\u3081\u308b\u3068\uff5e \u8702\u5de2\u91cc\u6709\u597d\u591a\u8702\u871c\uff0c\u5b8c\u6210\u9898\u76ee\u5e76\u63d0\u4ea4\uff1a</p> <ol> <li>flag \u5185\u5bb9\u53ca Writeup (100 points)</li> </ol>"},{"location":"topic/rev-lab3/#reference","title":"Reference","text":"<p>\u8bfe\u4e0a\u7ed9\u5927\u5bb6\u6f14\u793a\u4e86\u5982\u4f55\u7528 gdb script \u4e0e frida \u89e3\u8ff7\u5bab\u7c7b\u9898\u76ee\uff0c\u8fd9\u91cc\u9644\u4e0a\u4ee3\u7801\uff1a</p>"},{"location":"topic/rev-lab3/#gdb-script","title":"gdb script","text":"<p>gdb_script.py</p> <pre><code>#!/usr/bin/env python3\nimport re\nGRID_SIZE = 4\nHEIGHT = 9\nWIDTH = 9\nMAZE_SIZE = HEIGHT * WIDTH\n# initialize\ngdb.execute(\"file level2\")\ngdb.execute(\"set confirm off\")\ngdb.execute(\"set pagination off\") # set height unlimited (--batch)\ngdb.execute(\"starti\")\ngdb.execute(\"pie b 0x156B\") # first function malloc\ngdb.execute(\"pie b 0x1BED\") # first function memset\ncommands = \"continue\\n\"\ncommands += \"ni\\n\"\ncommands += \"p $rax\\n\"\ncommands += \"continue\\n\"\ncommands += \"x/%dbx $1\" % (MAZE_SIZE * GRID_SIZE)\ndata = []\nfor cmd in commands.split('\\n'):\nif cmd.startswith(\"x/\"):\nr = gdb.execute(cmd, to_string=True)\nfor item in re.findall(r\"(0x[0-9a-f]{2})[\\t\\n]\", r):\ndata.append(int(item, 16))\nelse:\ngdb.execute(cmd)\nascii_maze = [['+' for _ in range(WIDTH * 4 + 1)] for _ in range(HEIGHT * 2 + 1)]\nfor i in range(HEIGHT):\nfor j in range(WIDTH):\nidx = (i * WIDTH + j) * GRID_SIZE\ngrid = data[idx: idx + 4]\nascii_maze[i * 2 + 1][j * 4 + 1:(j + 1) * 4] = [' '] * 3\n# up wall\nif grid[0] == 0:\nascii_maze[i * 2][j * 4 + 1:(j + 1) * 4] = ['-'] * 3\nelse:\nascii_maze[i * 2][j * 4 + 1:(j + 1) * 4] = [' '] * 3\n# down wall\nif grid[1] == 0:\nascii_maze[(i + 1) * 2][j * 4 + 1:(j + 1) * 4] = ['-'] * 3\nelse:\nascii_maze[(i + 1) * 2][j * 4 + 1:(j + 1) * 4] = [' '] * 3\n# left wall\nif grid[2] == 0:\nascii_maze[i * 2 + 1][j * 4] = '|'\nelse:\nascii_maze[i * 2 + 1][j * 4] = ' '\n# right wall\nif grid[3] == 0:\nascii_maze[i * 2 + 1][(j + 1) * 4] = '|'\nelse:\nascii_maze[i * 2 + 1][(j + 1) * 4] = ' '\nprint(' Map '.center(WIDTH * 4 + 1, '='), end='\\n\\n')\nfor line in ascii_maze:\nprint(''.join(line))\n# depth first search\npath = []\nstack = [(0, 0)]\nsteps = ['w', 's', 'a', 'd']\ndires = [(-1, 0), (1, 0), (0, -1), (0, 1)]\nrecord = [[0 for _ in range(WIDTH)] for _ in range(HEIGHT)]\nwhile(len(stack) &gt; 0):\ncur = stack.pop()\nif cur == (HEIGHT - 1, WIDTH - 1):\nbreak\nrecord[cur[0]][cur[1]] = 1 # visited\nall_visited = True\nfor i in range(4):\nidx = (cur[0] * WIDTH + cur[1]) * GRID_SIZE\nnx = cur[0] + dires[i][0]\nny = cur[1] + dires[i][1]\nif data[idx + i] == 1 and record[nx][ny] == 0:\nall_visited = False\npath.append(steps[i])\nstack.append(cur)\nstack.append((nx, ny))\nbreak\nif all_visited:\npath.pop()\nprint(\"\\nPath:\", ''.join(path))\n</code></pre>"},{"location":"topic/rev-lab3/#frida","title":"frida","text":"<p>\u4f7f\u7528\u547d\u4ee4 <code>pip install frida-tools</code> \u5b89\u88c5\u4f9d\u8d56\uff0c\u6267\u884c <code>sudo sysctl kernel.yama.ptrace_scope=0</code> \u5141\u8bb8\u5bf9 non-child \u8fdb\u7a0b ptrace\uff1a</p> <p>frida_script.py</p> <pre><code>#!/usr/bin/env python\nimport frida\nimport sys\n# Spawn and attach to process\npid = frida.spawn('./level2')\nsession = frida.attach(pid)\n# Create and load the instrumentation script\nscript = session.create_script(open('./frida_hook_script.js', 'r').read())\ndef solve_maze(data):\nGRID_SIZE = 4\nHEIGHT = 9\nWIDTH = 9\nascii_maze = [['+' for _ in range(WIDTH * 4 + 1)] for _ in range(HEIGHT * 2 + 1)]\nfor i in range(HEIGHT):\nfor j in range(WIDTH):\nidx = (i * WIDTH + j) * GRID_SIZE\ngrid = data[idx: idx + 4]\nascii_maze[i * 2 + 1][j * 4 + 1:(j + 1) * 4] = [' '] * 3\n# up wall\nif grid[0] == 0:\nascii_maze[i * 2][j * 4 + 1:(j + 1) * 4] = ['-'] * 3\nelse:\nascii_maze[i * 2][j * 4 + 1:(j + 1) * 4] = [' '] * 3\n# down wall\nif grid[1] == 0:\nascii_maze[(i + 1) * 2][j * 4 + 1:(j + 1) * 4] = ['-'] * 3\nelse:\nascii_maze[(i + 1) * 2][j * 4 + 1:(j + 1) * 4] = [' '] * 3\n# left wall\nif grid[2] == 0:\nascii_maze[i * 2 + 1][j * 4] = '|'\nelse:\nascii_maze[i * 2 + 1][j * 4] = ' '\n# right wall\nif grid[3] == 0:\nascii_maze[i * 2 + 1][(j + 1) * 4] = '|'\nelse:\nascii_maze[i * 2 + 1][(j + 1) * 4] = ' '\nprint(' Map '.center(WIDTH * 4 + 1, '='), end='\\n\\n')\nfor line in ascii_maze:\nprint(''.join(line))\n# depth first search\npath = []\nstack = [(0, 0)]\nsteps = ['w', 's', 'a', 'd']\ndires = [(-1, 0), (1, 0), (0, -1), (0, 1)]\nrecord = [[0 for _ in range(WIDTH)] for _ in range(HEIGHT)]\nwhile(len(stack) &gt; 0):\ncur = stack.pop()\nif cur == (HEIGHT - 1, WIDTH - 1):\nbreak\nrecord[cur[0]][cur[1]] = 1 # visited\nall_visited = True\nfor i in range(4):\nidx = (cur[0] * WIDTH + cur[1]) * GRID_SIZE\nnx = cur[0] + dires[i][0]\nny = cur[1] + dires[i][1]\nif data[idx + i] == 1 and record[nx][ny] == 0:\nall_visited = False\npath.append(steps[i])\nstack.append(cur)\nstack.append((nx, ny))\nbreak\nif all_visited:\npath.pop()\nprint(\"\\nPath:\", ''.join(path))\ndef on_message(message, data):\nif data != None:\ndata = bytearray(data)\nsolve_maze(data)\nif __name__ == '__main__':\ntry:\nscript.on('message', on_message)\nscript.load()\nfrida.resume(pid)\nsys.stdin.read()\nexcept KeyboardInterrupt:\nprint('[+] Frida script exit by user')\nfrida.kill(pid)\nsys.exit(0)\nexcept Exception as e:\nprint('[-] Error', e)\nfrida.kill(pid)\nsys.exit(1)\n</code></pre> <p>frida_hook_script.js</p> <pre><code>console.log('Frida script has been loaded successfully.');\nconst MAZE_SIZE = 9 * 9;\nconst GRID_SIZE = 4;\nvar malloc_cnt = 0;\nvar puts_cnt = 0;\nvar map_address;\nInterceptor.attach(Module.findExportByName(null, 'malloc'), {\n// When entering malloc, print its argument as an integer to the console.\nonEnter: function (args) {\n// console.log(\"malloc(\" + args[0].toInt32() + \")\");\n},\n// When returning from malloc, print the return value (pointer) as a hexadecimal string.\nonLeave: function (retval) {\nif (malloc_cnt == 0) {\nmap_address = '0x' + retval.toString(16);\nconsole.log(\"\\nMap address -&gt; \" + map_address);\n}\nmalloc_cnt += 1;\n}\n});\nInterceptor.attach(Module.findExportByName(null, 'puts'), {\n// When entering malloc, print its argument as an integer to the console.\nonEnter: function (args) {\nif (puts_cnt == 0) {\n// console.log(ptr(map_address).toString(16));\nsend(map_address, ptr(map_address).readByteArray(MAZE_SIZE * GRID_SIZE));\n}\nputs_cnt += 1;\n}\n});\n</code></pre>"},{"location":"topic/web-lab2/","title":"Web Lab 2: PHP/SQL Basics &amp; SQLi Techs","text":""},{"location":"topic/web-lab2/#_1","title":"\u5b9e\u9a8c\u4efb\u52a1","text":""},{"location":"topic/web-lab2/#task-1","title":"Task 1","text":"<p>\uff0820%\uff09\u5b8c\u6210 BUUCTF SQL\u6ce8\u5165-2</p> <ul> <li>\u4efb\u52a1\u76ee\u7684\uff1a\u521d\u6b65\u4e86\u89e3sqlmap\u7684\u5de5\u4f5c\u539f\u7406\u4e0e\u4f7f\u7528\u65b9\u6cd5\u3001\u5e38\u89c1\u547d\u4ee4\u884c\u53c2\u6570\u9009\u9879</li> <li>\u8981\u6c42\u4f7f\u7528sqlmap\u5b8c\u6210</li> <li>\u7ed9\u51fa\u8fd0\u884c\u622a\u56fe/\u65e5\u5fd7\u6587\u672c\uff0c\u4ee5\u53ca\u6700\u7ec8\u7684flag</li> <li>\u4e86\u89e3sqlmap\u4e2d <code>tamper</code> \u7684\u529f\u80fd\uff0c\u5e76\u63d0\u4f9b\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684tamper\u811a\u672c <code>less_comma</code> \u5b9e\u73b0\u4e0b\u8ff0\u529f\u80fd\u53ef\u83b7\u5f97bonus20\u5206<ul> <li>\u5c06substr\u51fd\u6570\u4e2d\u7528\u9017\u53f7\u9694\u5f00\u7684\u53c2\u6570\u6539\u5199\u6210from...for...\u5f62\u5f0f\uff08\u53c2\u89c1\u8bfe\u4ef6\uff09</li> <li>\u5c06\u542b\u6709\u9017\u53f7\u7684LIMIT\u5b50\u53e5\u6539\u5199\u6210LIMIT ... OFFSET ...\u5f62\u5f0f\uff08\u53c2\u89c1\u8bfe\u4ef6\uff09</li> <li>\u3010\u53ef\u9009\u3011\u4fdd\u6301\u539f\u5173\u952e\u5b57\u5f62\u5f0f\u4e0d\u53d8<ul> <li>\u4f8b\u5982\u5e94\u7528\u8be5\u811a\u672c\u540e <code>liMiT 2,1</code> \u53d8\u4e3a <code>liMiT 1 offset 2</code> \u800c\u975e <code>LIMIT 1 offset 2</code></li> </ul> </li> </ul> </li> </ul>"},{"location":"topic/web-lab2/#task-2","title":"Task 2\uff08\u5df2\u66f4\u65b0\uff09","text":"<p>\uff0820%\uff09\u5b8c\u6210\u6821\u5df4\u9898\u76ee\uff1adelete injection</p> <ul> <li>\u8003\u70b9/\u63d0\u793a\uff1a\u5185\u8054\u6ce8\u91caWAF\u7ed5\u8fc7\u3001\u62a5\u9519\u6ce8\u5165  </li> <li>\u5176\u5b9e\u6709\u4e86\u8003\u70b9\u5e94\u8be5\u662f\u76f8\u5bf9\u597d\u505a\u7684\uff1f  </li> </ul>"},{"location":"topic/web-lab2/#task-3","title":"Task 3","text":"<p>\uff0830%\uff09\u5b8c\u6210\u6821\u5df4\u65b0\u9898\uff1aQuineIt</p> <ul> <li>\u8003\u70b9\uff1a\u7ed5\u8fc7\u3001Quine</li> <li>\u6ca1\u6709\u505a\u5b8c\u53ef\u4ee5\u89c6\u60c5\u51b5\u9610\u8ff0\u601d\u8def\uff0c\u914c\u60c5\u7ed9\u5206</li> <li>\u4f7f\u7528\u4ed6\u4eba\u672a\u4f7f\u7528\u8fc7\u7684\u975e\u9884\u671f\u89e3\u6cd5\u505a\u51fa\u5e76\u53ca\u65f6\u8054\u7cfb\u51fa\u9898\u4eba\u53ef\u4ee5\u5f97\u5230bonus30\u5206</li> </ul>"},{"location":"topic/web-lab2/#task-4","title":"Task 4","text":"<p>\uff0820%\uff09\u4e2a\u4eba\u603b\u7ed3</p> <ul> <li>\u6311\u9009\u4e00\u4e2a\u4f60\u5728\u8bfe\u5802\u5370\u8c61\u6700\u6df1\u7684\u77e5\u8bc6\u70b9\uff0c\u5e76\u5206\u4eab\u5fc3\u5f97\u4f53\u4f1a\uff0c\u4e0d\u5f97\u8d85\u8fc7300\u5b57</li> <li>\u56fe\u7247\u4e0d\u5f97\u8d85\u8fc73\u5f20</li> <li>\u6311\u9009\u4e00\u9053\u6709\u5173\u8be5\u77e5\u8bc6\u70b9\u7684\u9898\u5e76\u505a\u51fa\u53ef\u4ee5\u83b7\u5f97bonus10\u5206</li> <li>\u53ef\u4ee5\u901a\u8fc7\u641c\u7d22\u5f15\u64ce\u5728BUUCTF\u4e0a\u5bfb\u627e\u9898\u76ee</li> </ul> <p>* \u6ea2\u51fa100\u5206\u7684\u4ee5100\u5206\u8ba1\uff1b\u4fdd\u7559\u6839\u636e\u73ed\u7ea7\u5f97\u5206\u60c5\u51b5\u8c03\u6574\u5206\u6570\u6784\u6210\u7684\u6743\u5229\uff1b</p> <p>* \u6709\u7591\u95ee\u53ef\u4ee5\u8be2\u95ee\u51fa\u9898\u4eba\uff0c\u51fa\u4e8e\u516c\u5e73\u6027\u8003\u8651\u4e0d\u4fdd\u8bc1\u89e3\u7b54\uff1b\u4f46\u5bf9\u4e8e\u591a\u4eba\u8be2\u95ee\u7684\u5171\u6027\u95ee\u9898\u53ef\u80fd\u505a\u51fa\u7edf\u4e00\u7b54\u590d\u3002</p>"},{"location":"topic/web-lab2/#_2","title":"\u63d0\u4ea4\u6750\u6599","text":"<ul> <li>\u5b9e\u9a8c\u62a5\u544a\uff08\u5b66\u53f7-\u59d3\u540d-web\u4e13\u9898\u4e00.pdf\uff09<ul> <li>\u5f97\u5230\u7684\u5bc6\u7801\u6216 flag</li> <li>\u8be6\u7ec6\u6b65\u9aa4\uff08\u8db3\u591f\u4f7f\u5f97\u8001\u5e08\u786e\u4fe1\u4f60\u662f\u72ec\u7acb\u5b8c\u6210\u7684\u5373\u53ef\uff0c\u53ef\u4ee5\u542b\u6709\u5c11\u91cf\u56fe\u7247/\u622a\u56fe\u52a0\u4ee5\u4f50\u8bc1\uff09</li> <li>\u3010\u53ef\u9009\u4f46\u5f3a\u70c8\u63a8\u8350\u3011\u6821\u5df4\u9898\u76ee\u5b8c\u6210\u7684\u622a\u56fe\uff08\u542b\u53f3\u4e0a\u89d2\u5df2\u767b\u5f55\u7684\u7528\u6237\u540d\uff09</li> </ul> </li> <li>\u5fc5\u8981\u7684\u4ee3\u7801\u3001\u9644\u4ef6\uff08\u5b66\u53f7-\u59d3\u540d-web\u4e13\u9898\u4e00.zip\uff09</li> </ul> <p>\u653e\u5fc3\uff0c\u4e0d\u4f1a\u62a0\u4f60\u683c\u5f0f\u540d\u5b57\u4e4b\u7c7b\u7ec6\u8282\u7684\uff0c\u505a\u51fa\u6765\u6700\u8981\u7d27\u3002</p>"},{"location":"topic/web-lab2/#_3","title":"\u63d0\u793a","text":"<p>\u4e00\u4e2a\u5408\u683c\u7684web\u624b\u5e94\u5f53\u5c3d\u529b\u5728\u7f51\u7edc\u4e0a\u641c\u5bfb\u4fe1\u606f\uff0c\u7edd\u4e0d\u91cd\u590d\u9020\u8f6e\u5b50\u3002</p> <p>\u4f60\u53ef\u4ee5\u901a\u8fc7\u811a\u672c\u81ea\u52a8\u5316\u67d0\u4e9b\u6784\u9020\u6b65\u9aa4\u3002</p>"},{"location":"topic/web-lab3/","title":"Web Lab 3: PHP unserialization","text":""},{"location":"topic/web-lab3/#task-1-30-pts","title":"Task 1 (30 pts)","text":"<p>Finish the challenge Baby Hash in SchoolBus (https://zjusec.com/challenges/88)</p>"},{"location":"topic/web-lab3/#task-2-20-pts","title":"Task 2 (20 pts)","text":"<p>Finish the challenge Child Hash in SchoolBus (https://zjusec.com/challenges/89)</p>"},{"location":"topic/web-lab3/#task-3-10-pts","title":"Task 3 (10 pts)","text":"<p>Finish the challenge Grownup Hash in SchoolBus (https://zjusec.com/challenges/90)</p>"},{"location":"topic/web-lab3/#task-4-40-pts","title":"Task 4 (40 pts)","text":"<p>reproduce CVE-2018-18753, analysis trace, exploitable payload.</p>"},{"location":"topic/web-lab3/#what-to-submit","title":"What to submit","text":"<p>For task 1-3, your writeup.</p> <p>For task 4, your analysis trace, payload, etc.</p>"}]}